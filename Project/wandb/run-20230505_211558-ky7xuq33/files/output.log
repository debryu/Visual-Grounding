
1
  0%|                                         | 0/2600 [00:00<?, ?it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 39.5481,   5.4389,  39.5481,  49.6907],
        [ 34.6437,   0.0000,  34.6437,  11.8139],
        [ 43.0275,   5.2429,  43.0275,  20.4322],
        [ 24.4734,   0.8327,  24.4734,  31.6187],
        [ 53.7475,   0.0000,  53.7475,  38.6783],
        [ 51.2413,   0.0000,  51.2413,  34.8429],
        [117.4555,   0.0000, 117.4555, 140.4190],
        [ 46.8151,   0.0000,  46.8151,  40.9068]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[2.7958e+02, 1.5648e+02, 4.7202e+02, 2.3586e+02],
        [0.0000e+00, 2.2674e+02, 1.0119e+02, 3.7567e+02],
        [2.7200e-01, 2.2877e+02, 2.4166e+02, 5.1200e+02],
        [8.6400e-01, 3.7550e+02, 1.3624e+02, 5.0320e+02],
        [2.8413e+02, 4.0178e+01, 4.0101e+02, 4.1213e+02],
        [1.7306e+00, 3.2631e+00, 1.3721e+02, 1.1372e+02],
        [1.4584e+01, 1.1506e+02, 5.0204e+02, 5.0624e+02],
        [2.7120e+01, 8.6440e+01, 1.4372e+02, 4.7476e+02]], device='cuda:0')
loss1: tensor([1.8467, 1.6036, 1.4411, 1.7458, 1.6962, 1.0287, 1.2273, 1.1821],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.7714, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 44.9945,  28.3141,  44.9945,  61.4098],
        [ 68.2293,   0.0000,  68.2293,  59.3701],
        [ 46.8621,  72.1277,  46.8621, 124.6568],
        [135.1571,   0.0000, 135.1571,  97.4463],
        [ 18.6763,   3.5349,  18.6763,  31.0420],
        [ 37.4765,  53.4824,  37.4765,  88.5995],
        [ 74.0027,   0.0000,  74.0027,  54.0459],
        [ 48.0317,   0.0000,  48.0317,  18.4212]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  2.1360,  24.6700, 129.0640, 255.3300],
        [ 32.9033, 181.6166, 353.2185, 505.6614],
        [314.1520,   4.0404, 511.8000, 337.3000],
        [ 15.3520,   3.4533, 493.5920, 506.2445],
        [117.6000,  54.8800, 279.4773, 462.6480],
        [368.4640,   2.3040, 512.0000, 179.4880],
        [214.9360,  70.9845, 432.5600, 372.4290],
        [  0.0000, 155.4080, 512.0000, 505.9760]], device='cuda:0')
loss1: tensor([1.0000, 1.3592, 1.5749, 1.0068, 1.4487, 1.6975, 1.5087, 1.3071],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.9030, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 79.0373,  10.0916,  79.0373,  29.1941],
        [121.1799,   0.0000, 121.1799,  97.9354],
        [ 72.4316,   0.0000,  72.4316,  63.0620],
        [ 48.1670,   0.0000,  48.1670,  31.7819],
        [ 62.5456,   0.0000,  62.5456,  32.4134],
        [ 63.2510,  48.8284,  63.2510,  83.2184],
        [ 43.4778,   3.7943,  43.4778,  12.8006],
        [ 71.0693, 131.8296,  71.0693, 190.7419]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[343.9120,  86.9681, 425.3840, 478.5581],
        [ 86.2880,  41.4208, 409.8880, 488.9907],
        [ 57.3600, 190.6391, 285.2400, 396.4822],
        [ 21.1680, 194.4400, 275.2160, 422.2600],
        [228.1044,  57.5120, 357.9793, 447.7200],
        [354.7120, 273.4774, 487.8240, 405.7959],
        [ 79.4640, 103.5541, 512.0000, 417.6545],
        [ 35.3440, 302.7978, 190.7120, 504.2961]], device='cuda:0')
loss1: tensor([1.8034, 1.0847, 1.4808, 1.4605, 1.6169, 1.8838, 1.2993, 1.4590],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.0884, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 60.4138,  92.7883,  60.4138,  97.2579],
        [ 45.6882,  98.4357,  45.6882, 154.9066],
        [ 57.2179,   0.0000,  57.2179,  50.2994],
        [112.7087,   0.0000, 112.7087,  54.8113],
        [169.3344,   0.0000, 169.3344,  74.7894],
        [ 43.0272,  19.6818,  43.0272,  62.0536],
        [ 90.4030,   0.0000,  90.4030,  43.4105],
        [ 63.2064,  82.3876,  63.2064, 135.7037]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[187.7840, 369.3261, 399.4512, 506.2451],
        [ 45.1440,  62.6539, 254.2560, 183.7311],
        [  0.0000,   0.0000, 303.2160, 361.6853],
        [350.8240, 176.1745, 415.2480, 390.8806],
        [260.6880,   0.0000, 511.5360, 381.9902],
        [362.3120, 247.5185, 421.2960, 506.3895],
        [ 21.5200,  81.6853, 148.8800, 509.3653],
        [310.0513,  79.3702, 504.7032, 165.9187]], device='cuda:0')
loss1: tensor([1.7933, 1.0000, 1.0000, 1.8830, 1.2670, 1.9171, 1.1604, 1.5591],
       device='cuda:0', grad_fn=<RsubBackward1>)


  1%|▏                               | 18/2600 [00:07<06:32,  6.58it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 45.6996,   0.0000,  45.6996,  30.4513],
        [ 36.4411,   0.0000,  36.4411,   9.1057],
        [146.3478,   0.0000, 146.3478,  83.2348],
        [ 87.9110,  59.8646,  87.9110,  98.5370],
        [ 42.0603,  11.1558,  42.0603,  20.4744],
        [ 84.9044,   0.0000,  84.9044,  42.2218],
        [114.6327,   0.0000, 114.6327,  79.6320],
        [ 88.1556, 129.6471,  88.1556, 196.5557]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 51.5520,  64.0837, 333.1680, 449.5193],
        [195.2973, 161.9968, 281.3747, 356.9937],
        [310.3243, 128.5034, 429.5217, 428.5986],
        [225.7840,   0.0000, 502.3840, 285.1046],
        [200.3520,  97.7956, 512.0000, 505.0934],
        [326.1542, 175.5409, 454.1952, 512.0000],
        [160.2480,  91.1706, 366.7600, 490.1848],
        [ 12.2720,  66.7288, 360.7280, 501.6475]], device='cuda:0')
loss1: tensor([1.1600, 1.8080, 1.7053, 1.3326, 1.4532, 1.7722, 1.3333, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.5646, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[135.3753,   0.0000, 135.3753,  87.6898],
        [114.2015, 203.9925, 114.2015, 267.3160],
        [191.5464,   0.0000, 191.5464, 101.3954],
        [125.5724,   0.0000, 125.5724,  38.7973],
        [107.0652, 132.3268, 107.0652, 132.3268],
        [ 44.6880,   0.0000,  44.6880,  33.8534],
        [ 49.4452,  17.3748,  49.4452,  32.1068],
        [ 52.9266,  14.9744,  52.9266,  43.7361]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 36.2400, 156.4800, 393.4960, 332.5120],
        [296.2800, 229.4039, 502.9360, 482.7368],
        [ 36.6400, 127.0407, 218.4160, 455.5721],
        [126.1774,  69.7680, 496.0405, 499.8880],
        [360.1840, 345.6898, 452.5360, 503.8260],
        [ 78.0640, 198.3680, 183.0080, 344.3413],
        [260.7104, 191.5268, 496.5478, 270.3044],
        [  0.0000,   0.0000, 479.7840, 482.0907]], device='cuda:0')
loss1: tensor([1.4706, 1.5169, 1.2789, 1.1410, 1.8862, 1.6784, 1.8357, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.8076, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 69.8545,  81.6498,  69.8545, 116.9762],
        [ 82.2852,  62.9214,  82.2852, 104.9652],
        [ 48.1895,   0.0000,  48.1895,  20.1193],
        [100.4822,   0.0000, 100.4822,  44.6841],
        [252.4360,   0.0000, 252.4360, 124.1133],
        [ 55.8881,   4.1690,  55.8881,  23.5777],
        [160.7602,   0.0000, 160.7602,  63.2911],
        [132.4543, 225.5168, 132.4543, 274.7443]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 62.6400, 366.6022, 182.3200, 508.5485],
        [ 33.4355, 196.0653, 252.9840, 400.8653],
        [177.1360, 153.9824, 249.2320, 376.2350],
        [ 37.9280,  39.1920, 433.6160, 487.9840],
        [ 91.7760,  23.0102, 415.6960, 506.2475],
        [  0.0000,  12.6621, 345.4400, 212.8577],
        [256.8909, 225.1981, 391.1475, 367.9437],
        [335.5680, 190.2720, 389.1920, 480.8640]], device='cuda:0')
loss1: tensor([1.6675, 1.3940, 1.7882, 1.0803, 1.0455, 1.0407, 1.7739, 1.7911],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.5812, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 78.2333,   1.5852,  78.2333,  26.9300],
        [130.2968, 213.3070, 130.2968, 269.8472],
        [116.5950,  42.2182, 116.5950,  53.8057],
        [201.0443,   0.0000, 206.0111, 129.6654],
        [ 45.6887,   0.0000,  45.6887,  11.8822],
        [ 70.3711,   0.0000,  70.3711,  31.6219],
        [146.4733,  12.8690, 146.4733,  68.6363],
        [ 87.3347,  54.1403,  87.3347,  95.8692]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[256.9200,  28.6345, 345.3440, 307.0676],
        [ 12.0080, 246.9429, 130.3680, 398.0055],
        [ 99.5673, 289.0854, 172.3531, 512.0000],
        [  0.0000, 293.7515, 299.9706, 504.5726],
        [ 56.0400,   1.1511, 151.2240, 195.3634],
        [ 53.0944,  54.9298, 183.8285, 419.7044],
        [341.5760, 102.1197, 480.7280, 234.9314],
        [ 34.9040, 296.9720, 145.8000, 426.7791]], device='cuda:0')
loss1: tensor([1.6983, 1.1821, 1.5255, 1.5779, 1.1034, 1.1309, 1.7510, 1.6517],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.6207, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[170.4201,   0.0000, 170.4201,  75.9521],
        [136.6949, 195.2880, 136.6949, 229.0472],
        [138.1410, 229.0301, 138.1410, 291.6416],
        [204.3409,   0.0000, 204.3409,  58.0412],
        [173.9872,   0.0000, 173.9872,  68.5786],
        [ 77.0488,  26.3786,  77.0488,  51.0113],
        [138.6442,   0.0000, 138.6442,  75.6699],
        [101.4100,  95.0107, 101.4100, 123.7911]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[156.1920, 256.5760, 273.5440, 506.2507],
        [407.2960, 232.4160, 510.8480, 383.1360],
        [  1.5360, 278.4320, 188.6933, 505.0960],
        [187.6003, 112.0320, 335.1716, 214.9760],
        [131.5120, 210.8235, 320.3920, 411.7710],
        [324.2160, 199.7759, 486.5120, 370.5585],
        [121.0240,  50.6311, 218.7520, 377.3867],
        [201.2880, 102.4000, 391.5520, 223.5174]], device='cuda:0')
loss1: tensor([1.5068, 1.7779, 1.1789, 1.5211, 1.5120, 1.8033, 1.1342, 1.3819],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.8163, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 81.7752,   0.0000,  81.7752,  29.0561],
        [155.6895, 137.9245, 155.6895, 189.8127],
        [165.0967,   0.0000, 165.0967,  61.0412],
        [240.4053,   0.0000, 240.4053, 111.5877],
        [168.9811, 233.6865, 168.9811, 275.2301],
        [ 62.6869,  50.8108,  62.6869,  79.4475],
        [108.9912, 121.7617, 108.9912, 153.2071],
        [225.4492,   0.0000, 225.4492,  69.7284]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 28.7360, 147.8805, 159.1360, 304.7419],
        [299.0800,  14.6880, 372.5920, 243.6267],
        [127.3760, 162.1582, 233.2720, 415.6141],
        [ 48.5141, 154.3840, 376.6018, 265.7200],
        [371.7040,  62.2674, 469.1040, 199.1764],
        [122.4192, 193.2928, 430.7661, 506.2528],
        [184.6000, 256.3245, 309.3760, 512.0000],
        [ 94.9520, 138.5997, 417.4000, 512.0000]], device='cuda:0')
loss1: tensor([1.4853, 1.6611, 1.3902, 1.5810, 1.7914, 1.4244, 1.5920, 1.2707],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.1960, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 88.5706,   0.0000,  88.5706,  22.0162],
        [ 96.7499,   0.0000,  96.7499,  56.7006],
        [145.7247, 119.5665, 145.7247, 161.3867],
        [254.4184,   0.0000, 254.4184,  94.7923],
        [ 45.6284,  39.8100,  45.6284,  71.5811],
        [ 56.5746,   7.9966,  56.5746,  29.6445],
        [204.6820, 318.6834, 204.6820, 364.0375],
        [288.1762,   0.0000, 288.1762, 105.5270]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.7280, 222.6660, 226.7600, 412.3339],
        [  0.0000,  67.4995,  89.4960, 470.4453],
        [304.5520,  78.0680, 420.2240, 509.8826],
        [ 55.5200, 348.1173, 158.3840, 512.0000],
        [ 81.4381, 138.0640, 311.8743, 474.0320],
        [159.5413,   0.8000, 398.8587,  76.7360],
        [107.5958, 151.6308, 233.6142, 290.1071],
        [360.1536, 224.5280, 511.7077, 315.2720]], device='cuda:0')
loss1: tensor([1.5400, 1.2077, 1.5786, 1.8345, 1.3303, 1.3008, 1.3481, 1.8049],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.9449, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[116.5863,  62.3078, 116.5863,  96.6649],
        [203.0689,   0.0000, 203.0689,  49.1296],
        [ 68.4383,   0.0000,  68.4383,  23.5735],
        [106.3333,   0.0000, 106.3333,  32.3769],
        [179.5619, 270.8613, 179.5619, 287.0748],
        [202.4644,   0.0000, 202.4644, 103.8271],
        [134.3085,   0.0000, 134.3085,  53.7824],
        [168.5327, 225.1355, 168.5327, 287.9002]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[207.8640,  57.9840, 313.6480, 435.5733],
        [299.9840, 249.4384, 459.7200, 412.1973],
        [ 22.7200,  97.1276, 210.6080, 416.9905],
        [326.4409, 187.6378, 448.9626, 440.8934],
        [  0.0000, 356.4080, 179.8130, 504.0240],
        [142.3120, 266.0362, 196.7040, 512.0000],
        [ 88.2160, 183.6532, 226.2800, 351.5892],
        [ 45.3520,  54.7696, 173.3920, 436.2336]], device='cuda:0')
loss1: tensor([1.4632, 1.7542, 1.2329, 1.7946, 1.3669, 1.5656, 1.5224, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.6998, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[108.8765,  73.5035, 108.8765,  93.0512],
        [218.6914,   0.0000, 218.6914,  94.5535],
        [ 75.5352,   0.0000,  75.5352,  24.1060],
        [ 77.5085,   0.0000,  77.5085,  33.5325],
        [196.2656, 207.9627, 196.2656, 251.4263],
        [235.1747, 371.4514, 235.1747, 405.4876],
        [113.2575,   0.0000, 113.2575,  51.0511],
        [251.5802,   0.0000, 251.5802,  87.9384]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 11.5600, 166.2613, 164.3360, 506.4960],
        [211.3280, 184.4160, 298.9520, 499.4026],
        [ 93.1328, 163.2282, 247.2038, 264.5333],
        [182.6509, 246.4576, 333.7830, 506.3080],
        [143.2480,   3.4545, 510.9040, 506.2477],
        [  0.5920, 275.2533, 125.4960, 398.8053],
        [116.8480,  94.3450, 427.6080, 391.1963],
        [158.1360, 192.1379, 363.0960, 454.4689]], device='cuda:0')
loss1: tensor([1.2142, 1.3693, 1.6563, 1.6973, 1.0000, 1.4949, 1.2498, 1.4228],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.1046, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[229.5828,  15.3874, 229.5828,  57.0532],
        [ 71.5068,  37.2691,  71.5068,  54.9168],
        [188.0559,   0.0000, 188.0559,  77.8542],
        [181.3518, 144.1305, 181.3518, 178.2203],
        [248.1792,   0.0000, 248.1792, 122.0083],
        [111.7627,   0.0000, 111.7627,  43.1481],
        [ 80.2549,  77.5455,  80.2549,  79.3918],
        [235.6008, 345.1633, 235.6008, 367.7933]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[323.1648,  35.1680, 477.9848, 487.2080],
        [  1.5600, 192.0059, 218.4480, 506.8090],
        [  0.7680,  52.7948, 327.8480, 504.0981],
        [ 82.4427,  97.2880, 219.6587, 200.9040],
        [221.0880, 239.9280, 306.2240, 394.6800],
        [292.1779,  28.6080, 439.1833, 486.2848],
        [116.5013, 144.5120, 262.0907, 261.2000],
        [181.2480, 218.1077, 281.8080, 470.8904]], device='cuda:0')
loss1: tensor([1.4029, 1.3295, 1.1047, 1.0000, 1.6079, 1.5774, 1.4913, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.5138, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[215.8334, 307.0251, 215.8334, 307.0251],
        [ 75.5371,   0.0000,  75.5371,  33.1682],
        [ 71.4497,  16.8084,  71.4497,  31.7498],
        [412.7628,   0.0000, 412.7628, 160.3424],
        [ 92.5032,  30.2396,  92.5032,  55.2748],
        [ 72.6059,  21.8300,  72.6059,  46.6013],
        [ 83.1806,   7.0231,  83.1806,  50.4171],
        [189.3634, 197.6411, 189.3634, 197.6411]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[332.0720, 129.1307, 512.0000, 511.7120],
        [ 89.8359,  53.5600, 366.6109, 328.3120],
        [105.2774, 181.4391, 221.7677, 503.5895],
        [328.1707, 101.0080, 459.7546, 505.0320],
        [209.3920,  20.7318, 379.0480, 270.4247],
        [256.8960, 166.2861, 452.3680, 269.4535],
        [ 89.6512, 201.1560, 187.7402, 502.6057],
        [171.6480, 207.7906, 402.3600, 512.0000]], device='cuda:0')
loss1: tensor([1.3925, 1.2042, 1.4871, 1.2000, 1.4079, 1.7856, 1.4294, 1.0323],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.9390, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[383.0038,   0.0000, 383.0038, 170.1346],
        [102.0085,  94.9552, 102.0085, 120.4771],
        [110.6453,   3.4806, 110.6453,  30.7978],
        [231.0628, 282.2414, 231.0628, 282.2414],
        [ 93.0666,  21.9033,  93.0666,  67.2619],
        [182.2377,  78.5320, 182.2377, 110.2182],
        [ 97.6892,  53.0066,  97.6892,  96.3170],
        [117.6177,  61.6558, 117.6177,  82.0206]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 78.6960,  64.4267, 187.7280, 218.6105],
        [229.2907,   0.0000, 362.8231, 151.9520],
        [221.7440,  41.5893, 438.0880, 408.1600],
        [420.0448,   0.6861, 510.8668, 258.6010],
        [ 90.4909, 358.2927, 330.5165, 458.1634],
        [283.8080,  62.1280, 512.0000, 505.0960],
        [ 12.0146,   3.5440, 190.5671, 434.2240],
        [100.1760,  90.0306, 277.1840, 185.5314]], device='cuda:0')
loss1: tensor([1.7473, 1.4880, 1.4015, 1.7027, 1.7711, 1.3080, 1.0000, 1.2291],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.6476, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[162.2589,   0.3264, 162.2589,  57.8940],
        [200.8232,   0.0000, 200.8232,  72.9594],
        [ 80.1106,  26.7723,  80.1106,  48.7195],
        [122.9991,  79.5222, 122.9991,  89.0245],
        [163.7586,   0.0000, 163.7586,  63.0144],
        [235.5585, 238.6800, 235.5585, 259.8010],
        [196.7164,   0.0000, 196.7164,  81.6042],
        [212.5685, 227.7830, 212.5685, 234.4803]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[187.5840,  35.1680, 459.7227, 512.0000],
        [303.9200, 267.2682, 413.5600, 422.0237],
        [286.5520, 227.7333, 496.1200, 473.4507],
        [  0.0000,  57.3992, 114.7984, 319.1383],
        [311.3280, 240.0320, 460.8000, 421.7067],
        [308.9280, 104.9920, 412.4800, 232.7040],
        [157.4400,  21.3410, 377.8560, 461.8456],
        [ 93.7360,  59.5947, 204.0720, 223.2747]], device='cuda:0')
loss1: tensor([1.1474, 1.8110, 1.7229, 1.0667, 1.7832, 1.5171, 1.0462, 1.1310],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.2256, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[126.3692,   0.0000, 126.3692,  44.4516],
        [ 68.8156,  15.0940,  68.8156,  30.6024],
        [362.4323,   0.0000, 362.4323, 159.2346],
        [135.0888,  26.5796, 135.0888,  63.6923],
        [146.8667, 104.9262, 146.8667, 114.4170],
        [172.9305, 185.8540, 172.9305, 207.4660],
        [110.0360,  88.3281, 110.0360, 113.2759],
        [227.2841, 264.4709, 227.2841, 264.4709]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 11.2160, 133.4613, 203.6480, 417.6533],
        [267.1360,  43.7178, 512.0000, 400.3912],
        [ 62.0875, 279.5840, 313.8548, 506.2480],
        [177.3363,   2.2972, 307.5994, 404.9905],
        [355.3440,  70.5493, 512.0000, 511.9786],
        [234.1760, 162.3147, 321.1600, 512.0000],
        [ 69.4000, 234.1440, 175.5040, 444.2880],
        [385.8640, 310.2507, 512.0000, 510.6133]], device='cuda:0')
loss1: tensor([1.3196, 1.4885, 1.6247, 1.2449, 1.5710, 1.4132, 1.4096, 1.6394],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.7108, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 68.9172,  21.4696,  68.9172,  39.8369],
        [283.9024,   0.0000, 283.9024, 127.1546],
        [113.7523,   0.0000, 113.7523,  55.2675],
        [130.5699,  21.7341, 130.5699,  49.9360],
        [211.7408,   1.6631, 211.7408,  62.6706],
        [151.3202, 189.2577, 151.3202, 189.2577],
        [ 88.2014,  12.9230,  88.2014,  32.9076],
        [332.1071, 429.9748, 332.1071, 429.9748]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[269.2301,  36.8230, 423.6902, 505.0914],
        [  0.0000,  10.7280, 466.1707, 512.0000],
        [ 62.9013,   4.6000, 504.7147, 463.6800],
        [228.5760,  49.4720, 408.0640, 421.1040],
        [406.7600, 305.0005, 510.1040, 485.5707],
        [  0.0000,  47.0728, 191.2400, 502.9514],
        [283.1680, 272.3840, 417.9200, 375.0080],
        [316.9760,  39.1221, 457.3440, 223.2034]], device='cuda:0')
loss1: tensor([1.5784, 1.0210, 1.0099, 1.3981, 1.8708, 1.0000, 1.8842, 1.5290],
       device='cuda:0', grad_fn=<RsubBackward1>)

  1%|▍                               | 31/2600 [00:09<06:41,  6.40it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[264.7809, 282.7754, 264.7809, 282.7754],
        [155.9375,  39.1494, 155.9375,  74.4502],
        [373.1828,   0.0000, 373.1828, 129.5083],
        [213.7664,  26.8539, 213.7664,  88.5627],
        [109.2053,  13.1174, 109.2053,  36.8097],
        [210.9830, 250.0053, 210.9830, 250.0053],
        [ 90.3322,  39.3776,  90.3322,  55.0497],
        [114.2102,   0.0000, 114.2102,  52.9535]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  3.0480, 182.2888,  65.5680, 431.9790],
        [ 93.7920,  70.3440, 419.7440, 505.0800],
        [285.6240, 184.0853, 410.7520, 319.8613],
        [159.3946, 232.4160, 427.9597, 497.0400],
        [203.6455, 198.6928, 512.0000, 504.7467],
        [134.7360, 249.0885, 345.5440, 359.2754],
        [  0.9473,  91.5040,  87.7474, 296.2960],
        [312.9520, 140.9379, 382.7360, 451.4353]], device='cuda:0')
loss1: tensor([1.7611, 1.0670, 1.5755, 1.4372, 1.5234, 1.0000, 1.2259, 1.8213],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.4114, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 91.1896,   7.7003,  91.1896,  32.9120],
        [131.4015, 115.5695, 131.4015, 115.5695],
        [248.7400, 323.3501, 248.7400, 323.3501],
        [296.4851,  27.5186, 296.4851,  96.0366],
        [365.5254,  33.0447, 365.5254, 125.8144],
        [102.6460,  57.2882, 102.6460,  69.9837],
        [157.7541, 138.3960, 157.7541, 138.3960],
        [133.6292,   0.0000, 134.7659,  68.6680]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 245.6680, 260.7309, 503.9674],
        [  1.9079, 299.6160, 146.9343, 509.4720],
        [145.3009, 230.8769, 398.0800, 326.5171],
        [363.6320, 185.7914, 482.3760, 366.8336],
        [216.3029, 304.5461, 419.9509, 426.5045],
        [ 56.2755,  72.5200, 201.0045, 422.7200],
        [343.1360, 157.9307, 411.2400, 398.9120],
        [125.5280, 218.8774, 235.7680, 408.4008]], device='cuda:0')
loss1: tensor([1.4795, 1.4672, 1.0000, 1.6592, 1.6900, 1.0417, 1.7515, 1.5342],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.6233, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[186.0481,   0.0000, 186.0481,  69.9654],
        [200.1820,   0.0000, 200.1820,  88.6207],
        [168.0055,   0.0000, 168.0055,  88.8725],
        [179.3521, 111.2753, 179.3521, 119.0575],
        [238.9726,   8.9435, 238.9726,  85.1852],
        [126.8883, 147.5292, 126.8883, 147.5477],
        [304.6714, 272.7986, 304.6714, 272.7986],
        [194.2760, 212.5054, 194.2760, 212.5054]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[232.8000, 256.3360, 401.8240, 461.2880],
        [336.3920, 173.9238, 402.3440, 421.6068],
        [122.7920, 127.5627, 305.4000, 245.4400],
        [219.5804, 187.0080, 405.0113, 394.9680],
        [208.9360,  26.0240, 298.4720, 422.0720],
        [ 56.1760, 104.3583, 222.3680, 505.9008],
        [240.3280, 233.4174, 512.0000, 396.7466],
        [156.8320, 344.2160, 404.3734, 467.6000]], device='cuda:0')
loss1: tensor([1.6520, 1.8083, 1.5197, 1.3976, 1.0413, 1.0000, 1.0000, 1.5163],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.9353, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[146.9632, 169.3266, 146.9632, 186.0785],
        [ 92.8895,   6.4404,  92.8895,  31.5542],
        [217.4735, 193.6966, 217.4735, 193.6966],
        [298.3905,   0.0000, 298.3905, 115.7715],
        [241.0648,  26.0854, 241.0648,  93.4341],
        [ 91.7732,  71.7701,  91.7732,  71.7701],
        [290.3401, 297.9714, 290.3401, 297.9714],
        [316.6591,  16.6465, 316.6591, 130.1479]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 62.6880, 257.3461, 190.8880, 512.0000],
        [ 84.5600, 236.2549, 351.4480, 440.5248],
        [130.6880,   0.0000, 347.9893,  71.3120],
        [277.1440, 133.5507, 370.0400, 453.8378],
        [ 30.6400,  19.5208, 232.8400, 505.1174],
        [113.3120, 198.4450, 212.8720, 417.1541],
        [145.6230,   1.3244, 398.9606, 264.6425],
        [183.8000, 368.9813, 310.6480, 504.7466]], device='cuda:0')
loss1: tensor([1.2569, 1.5294, 1.6318, 1.2943, 1.0391, 1.4794, 1.1124, 1.7344],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.0777, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[100.4998,  31.2302, 100.4998,  59.3436],
        [184.5649,  74.0068, 184.5649, 107.3980],
        [276.2241,   0.0000, 278.2901, 126.7203],
        [152.9561,  13.9574, 152.9561,  67.5126],
        [153.6486, 159.5772, 153.6486, 184.9782],
        [214.9248, 178.5950, 214.9248, 178.5950],
        [131.8442,   0.0000, 131.8442,  47.4725],
        [338.5565, 342.5428, 338.5565, 342.5428]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[402.2886,  49.6299, 510.1465, 171.3766],
        [ 52.4712,  76.8960, 512.0000, 369.1360],
        [ 34.2000, 225.4877, 201.5680, 387.1160],
        [ 49.2160, 198.1932, 156.4720, 383.1727],
        [ 30.4026, 351.7995, 353.0240, 482.1436],
        [  0.7680,   0.0000, 218.5200, 394.6375],
        [264.7520,  13.3203, 483.8400, 170.5834],
        [303.0720, 261.2519, 386.9120, 474.4933]], device='cuda:0')
loss1: tensor([1.7713, 1.0098, 1.7109, 1.4990, 1.5959, 1.0000, 1.4262, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.0131, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[182.7939,  73.3236, 182.7939, 111.5827],
        [ 74.0159,  30.1832,  74.0159,  63.0499],
        [210.8777,  54.6179, 210.8777,  77.8946],
        [178.5806,  96.6356, 178.5806, 105.3178],
        [141.2003,  95.6537, 141.2003,  96.9102],
        [288.1544, 242.1678, 288.1544, 242.1678],
        [379.6460,   3.5905, 379.6460, 162.5674],
        [138.8533, 145.7581, 138.8533, 150.8376]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.8640,  47.2533, 186.3920, 360.2027],
        [121.6720, 113.9093, 257.1520, 512.0000],
        [308.9280, 220.5547, 503.9440, 492.0853],
        [216.8880, 174.2131, 476.1297, 473.1699],
        [143.7360, 243.8067, 304.4160, 476.0120],
        [448.5440,  86.4884, 512.0000, 430.1280],
        [129.6640, 252.6720, 259.3280, 468.1173],
        [  1.1360,  10.6418, 157.1440, 501.3582]], device='cuda:0')
loss1: tensor([1.0000, 1.3888, 1.5870, 1.3082, 1.3990, 1.7165, 1.7594, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.1589, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[234.7810, 273.9355, 234.7810, 273.9355],
        [ 86.3822,  26.1948,  86.3822,  37.0815],
        [221.1219, 166.4264, 221.1219, 166.4264],
        [142.0239, 104.7908, 142.0239, 131.1857],
        [198.6728, 104.7284, 198.6728, 116.3171],
        [153.4607, 137.0660, 153.4607, 160.6706],
        [278.4209,  10.6145, 278.4209, 128.3493],
        [357.3913,  34.0152, 357.3913, 161.6501]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[129.2493, 356.9659, 229.4579, 506.5403],
        [  0.7840, 242.1654, 124.0480, 416.2927],
        [367.9360,  28.5756, 512.0000, 511.6988],
        [195.4000, 256.6652, 295.6000, 410.9506],
        [114.7840, 311.6053, 470.7120, 506.4960],
        [117.6000, 325.8320, 383.1573, 512.0000],
        [  0.0000,   0.0000, 512.0000, 512.0000],
        [158.2160, 159.9680, 402.1280, 393.9947]], device='cuda:0')
loss1: tensor([1.3894, 1.5536, 1.5047, 1.6712, 1.5149, 1.5035, 1.0000, 1.3499],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.4872, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[133.5529,  13.5853, 133.5529,  50.1495],
        [367.0663, 350.2603, 367.0663, 350.2603],
        [289.0289,  40.1522, 289.0289, 144.1715],
        [218.9539,  22.1734, 218.9539, 101.5204],
        [217.9806,  97.2591, 217.9806, 150.1144],
        [167.3486, 154.5711, 167.3486, 154.5711],
        [116.8074,   0.0000, 116.8074,  60.9295],
        [196.2890, 225.4849, 196.2890, 225.4849]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 24.5216,  20.9200, 512.0000, 476.7680],
        [361.6640, 192.4080, 437.9733, 451.1520],
        [198.6480,  81.7634, 329.3040, 500.5674],
        [ 24.1600,  26.4640, 216.5920, 353.2267],
        [265.8509, 148.0956, 364.3699, 287.9500],
        [127.1760,  36.4053, 194.8880, 348.0107],
        [ 42.0080, 204.0640, 159.1920, 384.8853],
        [ 15.5680, 172.9173,  90.8720, 451.1253]], device='cuda:0')
loss1: tensor([1.0158, 1.0000, 1.0904, 1.0249, 1.5064, 1.0000, 1.5302, 1.5833],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.7511, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[194.6040,  59.2451, 194.6040, 132.6233],
        [250.7154,  62.3508, 250.7154, 144.0804],
        [366.0398, 381.7183, 366.0398, 381.7183],
        [187.8549, 119.2614, 187.8549, 144.8266],
        [ 83.0987,   1.1312,  83.0987,  44.2657],
        [208.6927, 114.9646, 208.6927, 139.0774],
        [ 95.7955,  31.9932,  95.7955,  48.2204],
        [269.8875, 140.3198, 269.8875, 188.9858]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 31.4400,  93.4129, 254.4480, 354.3643],
        [105.6217, 226.2880, 325.3272, 512.0000],
        [385.1520, 115.7760, 507.4880, 227.0933],
        [149.6640, 126.3147, 302.9760, 237.9947],
        [  1.9120, 260.0747, 159.8320, 479.8293],
        [ 83.5277, 243.9149, 370.1146, 499.3461],
        [109.7760,   0.0000, 512.0000, 502.7912],
        [227.5434, 220.0480, 352.3791, 486.9760]], device='cuda:0')
loss1: tensor([1.1158, 1.3646, 1.6380, 1.0594, 1.5409, 1.3355, 1.0336, 1.2300],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.3177, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[190.8018,  73.0935, 190.8018, 124.5832],
        [100.9704,  27.0128, 108.2204,  71.2612],
        [198.6343, 191.8730, 198.6343, 191.8730],
        [187.0065, 145.5919, 187.0065, 145.5919],
        [286.7393, 216.8833, 286.7393, 216.8833],
        [128.3870,  44.8702, 128.3870,  91.9140],
        [451.8672, 133.5443, 451.8672, 268.2714],
        [153.2135, 161.0682, 153.2135, 161.0682]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[303.1757, 166.2458, 512.0000, 503.5643],
        [ 26.3600, 130.1494, 134.4480, 272.0724],
        [203.6480, 424.5760, 422.5280, 512.0000],
        [  4.0240, 163.3760, 142.0960, 396.9440],
        [383.7747,   0.9391, 512.0000, 285.1248],
        [ 72.4160,  11.5079, 179.1280, 505.0928],
        [234.5200, 181.0880, 446.7120, 381.5360],
        [218.5920, 318.2035, 374.6880, 476.9011]], device='cuda:0')
loss1: tensor([1.4905, 1.4088, 1.7330, 1.2988, 1.4308, 1.0000, 1.2109, 1.6459],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.2187, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[261.8402, 216.9702, 261.8402, 216.9702],
        [174.3071,  64.3705, 174.3071, 124.9796],
        [ 61.7819,  37.1472,  61.7819,  55.3970],
        [330.9815,  96.3230, 330.9815, 248.2593],
        [117.5274,  57.3814, 117.5274,  77.3720],
        [262.2457, 124.0574, 262.2457, 157.0565],
        [ 86.6798,  85.4620,  86.6798,  94.8845],
        [292.6872, 300.6553, 292.6872, 300.6553]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[128.5734,   1.1469, 402.1248, 272.6844],
        [ 41.9760, 147.6480, 512.0000, 344.1067],
        [106.9920,  76.8480, 235.3760, 404.4440],
        [  1.5280, 142.6733, 184.8960, 505.0970],
        [ 13.2160,   6.6080, 186.4533, 116.7120],
        [338.4730, 312.8115, 512.0000, 414.7473],
        [126.9520,  66.7282, 321.3120, 495.8936],
        [ 54.7520, 167.5658, 204.5280, 333.7373]], device='cuda:0')
loss1: tensor([1.0000, 1.2977, 1.3404, 1.5065, 1.0000, 1.7564, 1.1716, 1.3705],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4431, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[209.5610, 223.0990, 209.5610, 248.0264],
        [353.6834, 308.7771, 353.6834, 308.7771],
        [249.1053, 112.2555, 249.1053, 185.6648],
        [224.6997,  98.1501, 224.6997, 159.0622],
        [128.3458, 147.4833, 128.3458, 147.4833],
        [ 75.6593,   8.8071,  75.6593,  37.2720],
        [245.4479, 172.3848, 245.4479, 172.3848],
        [237.9558,  80.3558, 237.9558, 198.8043]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[239.9440, 374.7455, 372.9120, 499.0798],
        [  1.7680, 319.4880, 108.4880, 508.3307],
        [239.2640, 282.0556, 341.6160, 512.0000],
        [234.2720, 189.6320, 350.7360, 305.9840],
        [351.7235,   6.9035, 512.0000, 505.0964],
        [120.4800, 260.0356, 305.3360, 467.6080],
        [105.5120,  16.7253, 311.3520, 121.6533],
        [ 19.1920, 260.0383, 234.8720, 469.9102]], device='cuda:0')
loss1: tensor([1.6333, 1.7130, 1.4248, 1.4827, 1.5822, 1.6359, 1.3259, 1.4688],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.2666, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[264.7376, 316.0226, 264.7376, 316.0226],
        [ 61.4636,  15.9985,  61.4636,  46.9676],
        [188.3306, 146.8693, 188.3306, 163.1142],
        [220.2269,  98.6365, 220.2269, 203.1504],
        [221.3682, 270.5209, 221.3682, 270.5209],
        [291.3802, 137.2155, 291.3802, 261.0631],
        [120.3148, 119.9573, 120.3148, 119.9573],
        [257.2013, 156.9988, 257.2013, 210.1743]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[141.5168, 404.9988, 416.7885, 503.9445],
        [ 21.5760, 176.0320, 151.8720, 291.0933],
        [ 58.2933,  27.6160, 305.2800, 295.6960],
        [143.1790,  91.7402, 261.7664, 382.6790],
        [149.3360, 281.8885, 445.7200, 506.2430],
        [119.7280, 159.2019, 356.8880, 347.5938],
        [141.5200,  24.1600, 256.2880, 494.7413],
        [283.0400,   2.1120, 512.0000, 506.0587]], device='cuda:0')
loss1: tensor([1.4735, 1.5817, 1.0000, 1.0000, 1.0482, 1.1045, 1.1560, 1.1014],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.4653, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[158.9198,  83.3852, 158.9198, 172.8309],
        [315.6628, 344.8538, 315.6628, 344.8538],
        [ 82.3043,  35.1702,  82.3043,  58.5690],
        [142.7729,  80.0131, 142.7729,  95.8950],
        [124.2585, 130.4639, 124.2585, 130.4639],
        [339.9915, 191.5923, 339.9915, 287.6597],
        [234.8851, 278.8828, 234.8851, 278.8828],
        [284.3981, 153.7958, 284.3981, 242.5916]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[199.1475,  79.0528, 302.7047, 473.0197],
        [308.5360, 362.8333, 511.5360, 510.7592],
        [134.6400, 181.6221, 314.6720, 503.3547],
        [236.1120,   0.5760, 363.2400, 386.8800],
        [ 25.5600, 214.3925, 201.4000, 482.5870],
        [191.2320,  25.3102, 356.7280, 506.2467],
        [  0.0000,   2.6560, 455.8160, 505.3547],

  2%|▌                               | 44/2600 [00:11<07:34,  5.63it/s]
loss1: tensor([1.2798, 1.1084, 1.4676, 1.4234, 1.2384, 1.0000, 1.0000, 1.3197],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.8371, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[338.2220, 209.9131, 338.2220, 283.4055],
        [168.6458, 130.0892, 168.6458, 151.3049],
        [ 81.5154,  44.3291,  81.5154,  72.1106],
        [431.1445, 451.0839, 431.1445, 451.0839],
        [120.2895,  76.7637, 120.2895, 144.2141],
        [130.5158, 109.0125, 130.5158, 109.0125],
        [ 94.9281,  78.4867,  94.9281, 107.1255],
        [274.3181, 173.9799, 274.3181, 255.9519]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[275.2720,  81.1307, 445.3040, 319.9253],
        [138.8560,  73.4864, 293.9360, 191.5457],
        [195.0880,  71.3682, 327.7200, 237.7982],
        [188.8414,  22.0000, 327.7976, 180.6640],
        [  0.0000, 113.6094, 248.2176, 366.7012],
        [340.3120, 200.1990, 512.0000, 385.4372],
        [134.6560,   0.0000, 286.7120, 473.1733],
        [233.6240, 181.3973, 420.6720, 466.3573]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.5366, 1.7879, 1.1271, 1.6984, 1.2071, 1.0254],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.3825, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[276.4710, 218.7734, 276.4710, 218.7734],
        [165.2694, 100.6252, 165.2694, 176.3034],
        [186.7318, 216.2477, 186.7318, 216.2477],
        [314.5962, 275.2485, 314.5962, 398.9079],
        [114.5739, 110.7054, 114.5739, 110.7054],
        [288.0394, 245.4957, 288.0394, 245.4957],
        [258.8039, 193.9665, 258.8039, 273.8937],
        [174.0875, 115.7564, 174.0875, 161.3527]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[2.9861e+02, 9.0400e-01, 4.5267e+02, 1.7465e+02],
        [2.3508e+02, 2.2352e+02, 3.6290e+02, 4.5804e+02],
        [1.2962e+02, 7.2405e+01, 2.3543e+02, 2.9481e+02],
        [1.0741e+01, 8.0000e-02, 2.5159e+02, 5.0632e+02],
        [3.5386e+02, 3.8870e+02, 5.0626e+02, 5.0580e+02],
        [4.3837e+02, 2.0394e+02, 5.0740e+02, 4.6282e+02],
        [1.8404e+02, 1.6076e+02, 5.1200e+02, 4.8667e+02],
        [2.9398e+02, 3.1827e+02, 4.2984e+02, 4.2782e+02]], device='cuda:0')
loss1: tensor([1.3027, 1.5756, 1.0000, 1.2073, 1.8847, 1.6853, 1.0000, 1.8135],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.4692, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[187.0142, 133.7100, 187.0142, 137.1246],
        [158.0504, 129.4395, 161.3980, 202.9487],
        [310.9080, 241.9313, 310.9080, 332.5123],
        [374.5940, 420.1153, 374.5940, 420.1153],
        [181.0264, 139.2199, 181.0264, 202.1729],
        [105.5937,  92.8110, 105.5937,  97.8275],
        [200.2912, 180.5907, 200.2912, 270.2776],
        [161.3289, 152.0422, 161.3289, 152.0422]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.5360,   1.9307, 110.0480, 472.3627],
        [ 90.4160, 260.1488, 257.4800, 411.9022],
        [168.9520, 181.5147, 447.3600, 509.7813],
        [  0.0000, 182.5917, 223.4720, 484.0388],
        [259.4640, 105.5056, 342.3680, 406.9501],
        [ 93.8800, 311.6775, 178.1200, 504.3702],
        [111.3540,  31.9280, 431.7145, 506.2960],
        [301.4320, 143.8235, 372.2000, 354.3756]], device='cuda:0')
loss1: tensor([1.4127, 1.4575, 1.0000, 1.4034, 1.4862, 1.5318, 1.0000, 1.6644],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.9561, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[190.5023, 134.3071, 190.5023, 184.1206],
        [ 97.7054,  73.5281,  97.7054,  96.8078],
        [113.8771, 121.9221, 113.8771, 121.9221],
        [221.0965, 229.3927, 221.0965, 350.4931],
        [188.4356, 209.7000, 188.4356, 209.7000],
        [256.0719, 239.8650, 256.0719, 247.8615],
        [385.8928, 318.2330, 385.8928, 408.9939],
        [206.6720, 197.7483, 206.6720, 197.7483]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[157.7200, 360.9284, 385.4560, 451.1078],
        [ 42.7920, 351.2248, 488.2800, 512.0000],
        [287.7920,  88.6827, 395.1840, 225.3120],
        [251.1120,   0.0000, 455.6240, 391.1893],
        [  0.0000, 266.9539, 512.0000, 512.0000],
        [  1.7306,   0.0000, 165.6832, 111.6023],
        [312.4519, 246.7120, 435.4758, 463.8000],
        [404.5229, 202.9520, 509.5150, 445.1200]], device='cuda:0')
loss1: tensor([1.7153, 1.6333, 1.6182, 1.1280, 1.1894, 1.7098, 1.0000, 1.6606],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.6546, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[171.8215, 139.1373, 171.8215, 196.8077],
        [208.3973, 158.1680, 208.3973, 194.6374],
        [211.2104, 201.9731, 211.2104, 305.3870],
        [474.4988, 449.5284, 474.4988, 449.5284],
        [ 90.1624,  41.5210,  90.1624,  56.4983],
        [ 64.2592,  34.0550,  64.2592,  47.8862],
        [144.2894,  87.3551, 144.2894, 123.4955],
        [242.6676, 278.7574, 242.6676, 323.2218]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 17.7280, 273.0203, 143.7600, 512.0000],
        [  0.0000,  84.0784, 512.0000, 505.9346],
        [ 79.6160,  27.8688, 359.8000, 445.8282],
        [410.7840,  73.1429, 508.6560, 508.6302],
        [  1.5520,  85.1455, 499.6160, 295.2813],
        [ 56.2880,  90.9653, 290.0560, 512.0000],
        [ 35.4880,   0.0000, 512.0000, 445.6972],
        [  9.6640,   3.4514, 175.5760, 460.2285]], device='cuda:0')
loss1: tensor([1.4758, 1.0000, 1.0000, 1.0000, 1.1719, 1.1191, 1.0000, 1.2879],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.0547, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[175.4473, 145.6703, 175.4473, 145.6703],
        [155.8924, 178.2956, 155.8924, 206.3873],
        [155.6597, 117.3078, 155.6597, 147.1848],
        [284.8447, 196.7086, 284.8447, 256.3621],
        [253.3305, 204.3308, 253.3305, 280.1454],
        [247.4891, 332.4138, 247.4891, 332.4138],
        [285.6052, 321.9224, 285.6052, 469.1995],
        [115.4772,  97.8326, 115.4772, 110.4493]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 170.6627, 148.3920, 398.5926],
        [225.5200, 168.0547, 313.1440, 385.3479],
        [107.3835,   6.7157, 512.0000, 506.0523],
        [297.9440, 141.8851, 403.6400, 301.4565],
        [391.1360, 262.2408, 504.3600, 383.6943],
        [  5.9231, 243.0243, 154.4115, 397.2852],
        [363.0080,   0.7932, 510.0480, 366.6809],
        [ 86.8080, 139.3791, 404.2960, 483.9179]], device='cuda:0')
loss1: tensor([1.2378, 1.4428, 1.0000, 1.1103, 1.6946, 1.3853, 1.4883, 1.1076],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4666, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[172.7827, 115.4156, 172.7827, 128.4223],
        [309.9649, 288.9825, 309.9649, 378.4913],
        [374.7708, 492.7830, 374.7708, 492.7830],
        [181.7682, 161.6822, 181.7682, 237.7251],
        [116.9861, 110.3666, 123.9516, 165.6559],
        [235.8827, 185.5076, 235.8827, 220.9954],
        [141.2440, 123.8148, 141.2440, 157.2231],
        [190.6895, 198.0278, 190.6895, 198.0278]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[285.4080,  31.7120, 472.2160, 288.8640],
        [127.8240,  91.8376, 267.1120, 407.7558],
        [ 35.0480, 304.2983, 163.6640, 512.0000],
        [390.0800, 299.7547, 488.0080, 476.2240],
        [  0.8640, 270.9227, 222.1360, 506.2614],
        [144.1280, 325.6080, 468.3307, 508.7600],
        [122.8400,  54.0773, 260.8160, 502.7993],
        [ 42.8880, 264.6400, 138.6400, 446.8373]], device='cuda:0')
loss1: tensor([1.3761, 1.2353, 1.6214, 1.8206, 1.4012, 1.4334, 1.0000, 1.5256],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.4136, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[214.0311, 227.8060, 214.0311, 295.3255],
        [152.7890, 101.1117, 152.7890, 116.7870],
        [ 80.3077,  56.9340,  80.3077,  84.6024],
        [177.6506, 247.9214, 177.6506, 247.9214],
        [334.4591, 325.5948, 334.4591, 416.3358],
        [201.3028, 211.1587, 201.3028, 223.0712],
        [182.7834, 170.6485, 182.7834, 228.4216],
        [401.1136, 475.8269, 401.1136, 475.8269]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000,  54.8762, 297.6154, 479.4368],
        [ 70.7840,   0.0000, 221.5760, 469.9129],
        [163.5840,  59.6907, 378.8320, 475.2640],
        [346.9760,   2.0693, 510.5680,  88.1600],
        [ 13.8480,  74.3779, 407.7680, 503.3548],
        [ 85.9859, 314.0685, 382.7702, 443.7585],
        [  1.9840,   2.4348, 146.5360, 505.2522],
        [295.2800,  80.4691, 481.5760, 163.0966]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.2837, 1.8279, 1.0000, 1.4424, 1.2005, 1.7910],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.5456, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[373.8969, 436.4315, 373.8969, 559.9061],
        [106.5864,  97.3518, 106.5864, 139.9501],
        [133.4709, 181.4756, 133.4709, 181.4756],
        [140.3994, 141.1960, 140.3994, 182.5269],
        [226.3873, 185.6014, 226.3873, 240.0340],
        [219.5426, 175.3043, 219.5426, 187.1812],
        [349.9274, 435.4620, 349.9274, 435.4620],
        [180.2626, 242.3727, 180.2626, 242.3727]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[220.3120, 194.4401, 285.5600, 422.2621],
        [ 46.0240,  36.8160, 385.4400, 455.6240],
        [ 12.2800, 232.7467, 511.9360, 485.7493],
        [  0.0000, 255.7360, 116.4710, 423.7280],
        [ 36.1520, 220.2083, 146.1440, 400.1570],
        [  0.8507,  48.3241, 184.7694, 500.4963],
        [303.2480, 178.7307, 430.4720, 512.0000],
        [ 64.1024, 428.0080, 398.5046, 506.2480]], device='cuda:0')
loss1: tensor([1.7352, 1.0000, 1.1685, 1.5067, 1.5151, 1.1590, 1.0000, 1.7035],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7880, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[181.5016, 179.5918, 181.5016, 231.6719],
        [239.4779, 222.0135, 239.4779, 256.5777],
        [197.0724, 204.0421, 197.0724, 272.3812],
        [110.1951, 117.2786, 110.1951, 137.0989],
        [391.4318, 569.8813, 391.4318, 569.8813],
        [234.0232, 198.3889, 234.0232, 198.3889],
        [179.5860, 159.8471, 179.5860, 212.6273],
        [142.9875, 147.7472, 144.4037, 214.4202]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 108.8213, 512.0000, 505.2053],
        [ 15.3600,  62.4947, 494.4603, 189.8496],
        [123.4000, 130.0160, 361.5680, 508.5440],
        [ 19.2929, 238.2560, 225.8436, 350.3440],
        [389.5680, 403.2240, 512.0000, 512.0000],
        [ 18.4626,  54.0160, 335.0472, 330.0250],
        [170.9360, 436.1280, 406.2800, 509.3547],
        [  0.8640,  63.0827, 222.1360, 506.2080]], device='cuda:0')
loss1: tensor([1.0000, 1.3438, 1.0000, 1.5191, 1.3473, 1.0000, 1.7905, 0.9990],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.9997, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[168.6065, 159.7570, 168.6065, 226.5400],
        [188.4102, 219.9718, 188.4102, 276.8835],
        [198.0771, 199.2817, 198.0771, 199.2817],
        [280.7332, 407.5856, 280.7332, 407.5856],
        [198.8056, 228.0642, 198.8056, 302.3651],
        [220.5797, 202.6016, 220.5797, 202.6016],
        [286.1817, 385.7444, 286.1817, 486.9096],
        [224.4692, 197.3765, 224.4692, 197.3765]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 77.7643, 292.6086, 202.4619, 478.0759],
        [248.9360, 230.1087, 357.3840, 387.7419],
        [248.5555,   0.0000, 512.0000,  89.7297],
        [ 97.0880, 373.1440, 510.0693, 505.9360],
        [ 46.0960, 125.4759, 260.1360, 495.7548],
        [  8.6320, 249.6747,  72.4880, 485.5360],
        [347.1680, 153.0216, 471.7680, 353.2264],
        [220.1200,  89.4009, 320.6960, 241.0809]], device='cuda:0')
loss1: tensor([1.4174, 1.3970, 1.6221, 1.0000, 1.0000, 1.7488, 1.5974, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7827, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 78.4617,  62.3943,  78.4617,  81.8110],
        [174.4751, 225.9264, 174.4751, 225.9264],
        [282.2288, 208.6458, 282.2288, 208.6458],
        [290.4625, 412.4117, 290.4625, 523.7823],
        [161.8904, 191.5418, 161.8904, 236.6613],
        [202.3356, 176.9822, 202.3356, 205.6176],
        [232.0835, 327.6474, 232.0835, 327.6474],
        [200.2440, 260.7821, 200.2440, 270.1373]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 56.9520, 169.1307, 441.8160, 325.6107],
        [121.9012, 355.2628, 253.0970, 489.9388],
        [ 13.2720,   0.0000, 512.0000, 512.0000],
        [ 57.4480,  40.3021, 267.3360, 511.0669],
        [ 18.0800,  14.9538, 464.1440, 494.7374],
        [332.5360, 166.2827, 486.2960, 471.6907],
        [  0.0000,  38.5803, 160.2880, 506.1589],
        [231.4080, 257.6547, 379.8000, 463.5578]], device='cuda:0')
loss1: tensor([1.4055, 1.4899, 1.0000, 1.1229, 1.0000, 1.4585, 1.3094, 1.1736],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.9598, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[127.1278, 154.7063, 127.1278, 191.3667],
        [168.6575, 190.9967, 168.6575, 249.0475],
        [176.0619, 105.5038, 176.0619, 114.1796],
        [421.5876, 522.6078, 421.5876, 522.6078],
        [143.3876, 127.0150, 143.3876, 149.2351],
        [176.5831, 223.8429, 176.5831, 223.8429],
        [240.1223, 313.6850, 240.1223, 382.2585],
        [173.7009, 215.4736, 173.7009, 268.9451]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[115.2240,  42.9048, 415.4960, 390.4099],
        [130.3200,  79.4619, 465.7520, 505.9327],
        [284.5280,  79.8986, 414.2720, 334.7487],
        [375.0240,   0.0000, 511.6640, 146.2827],
        [246.7920, 349.7707, 422.8320, 512.0000],
        [ 80.9600, 439.9040, 473.5680, 512.0000],
        [242.3760,  15.9970, 472.2720, 507.0363],

  2%|▋                               | 54/2600 [00:13<08:44,  4.85it/s]
loss1: tensor([1.0000, 1.0000, 1.4553, 1.7201, 1.7345, 1.7498, 1.0097, 1.4463],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.1158, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[215.7464, 309.4453, 215.7464, 379.8945],
        [274.4980, 355.5988, 274.4980, 355.5988],
        [232.9363, 291.5886, 232.9363, 348.8792],
        [148.3028, 213.5653, 148.3028, 213.5653],
        [322.4608, 378.3000, 322.4608, 453.1649],
        [ 73.5374,  77.1337,  73.5374,  95.3470],
        [102.3934,  86.8484, 102.3934,  87.0759],
        [301.9073, 304.0691, 301.9073, 304.0691]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000,   0.0000, 217.4480, 504.2900],
        [ 38.1952, 188.6998, 233.0112, 512.0000],
        [  0.7680, 315.2577, 512.0000, 505.0934],
        [ 87.9520, 204.0344, 251.1760, 357.7540],
        [225.2240, 107.7973, 408.1600, 500.1387],
        [111.0480,  27.6192, 257.3200, 505.1012],
        [  0.8875,   1.1526, 291.2427, 477.4012],
        [146.0240, 305.2096, 249.5600, 439.1809]], device='cuda:0')
loss1: tensor([1.0000, 1.1756, 1.1109, 1.0000, 1.0000, 1.2041, 1.0000, 1.3414],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.8319, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[206.7358, 267.4964, 206.7358, 315.5388],
        [140.4223, 163.3296, 140.4223, 209.2908],
        [137.4579, 151.5400, 137.4579, 177.0855],
        [140.4457, 103.2560, 140.4457, 134.1069],
        [407.7339, 448.9914, 407.7339, 448.9914],
        [112.9571, 162.8759, 112.9571, 162.8759],
        [133.3936, 101.1982, 133.3936, 101.1982],
        [292.0479, 364.8159, 292.0479, 436.9077]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  4.5973, 262.1360,  88.9813, 506.0560],
        [223.8480, 125.3443, 425.6080, 384.0957],
        [ 30.6131,  94.0320, 405.5596, 505.2400],
        [ 58.2880, 154.1704, 434.4000, 438.3702],
        [237.2880,  12.2773, 323.1280, 172.1920],
        [ 98.3040, 264.3520, 314.0640, 492.5867],
        [ 61.5600,  18.3079, 461.7040, 512.0000],
        [207.8560,  21.3515, 347.4160, 431.4199]], device='cuda:0')
loss1: tensor([1.5825, 1.2925, 1.0000, 1.1519, 1.8156, 1.3078, 1.0000, 1.0132],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.1636, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 84.5362,  72.1164,  84.5362,  95.0445],
        [173.9564, 253.6981, 173.9564, 253.6981],
        [392.2780, 580.2633, 392.2780, 677.9755],
        [160.7708, 202.1218, 160.7708, 230.7225],
        [134.0301, 149.8592, 134.0301, 152.2696],
        [ 82.1229,  57.8443,  82.1229,  68.3372],
        [235.9770, 158.4129, 235.9770, 175.3695],
        [290.6118, 429.9766, 290.6118, 429.9766]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 211.3316,  95.4080, 409.9948],
        [273.4320, 340.4620, 442.0480, 452.4785],
        [130.2880, 170.8349, 222.0160, 354.9867],
        [121.2133, 330.9680, 339.8505, 412.8080],
        [411.8880,  23.6380, 475.0480, 253.1108],
        [161.0560,  85.5840, 275.4667, 280.4640],
        [415.4634, 150.1600, 512.0000, 343.7360],
        [280.9360, 307.1100, 362.2240, 473.1497]], device='cuda:0')
loss1: tensor([1.4120, 1.6456, 1.8729, 1.6116, 1.8148, 1.4820, 1.6503, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.4891, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[174.5150, 293.3166, 174.5150, 293.3166],
        [296.9111, 340.8308, 296.9111, 340.8308],
        [139.6300, 129.1745, 139.6300, 155.8767],
        [239.1517, 345.4721, 239.1517, 396.2452],
        [244.0528, 335.8904, 244.0528, 392.3970],
        [187.3446, 232.7785, 187.3446, 263.0470],
        [176.1707, 296.6673, 176.1707, 296.6673],
        [182.9975, 145.1564, 182.9975, 147.9979]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[191.1840, 176.5621, 294.8000, 423.1014],
        [ 25.0778,   2.8809, 168.6528, 298.0932],
        [234.1280, 240.5441, 354.6480, 459.1453],
        [202.8000,  52.8787, 357.7920, 492.0596],
        [178.5600, 299.2208, 360.0000, 470.7740],
        [201.0640, 182.9440, 326.1840, 453.3227],
        [ 19.7734, 179.9402,  83.6608, 403.2925],
        [150.8966, 372.7633, 318.6381, 483.1368]], device='cuda:0')
loss1: tensor([1.1386, 1.5386, 1.6287, 1.0000, 1.0000, 1.0988, 1.5915, 1.6734],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.6696, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[123.5630, 199.5586, 123.5630, 220.6769],
        [209.6592, 309.9194, 209.6592, 369.6583],
        [104.6462,  92.9581, 104.6462, 113.8254],
        [265.1464, 244.0301, 265.1464, 244.0301],
        [284.0059, 301.7954, 284.0059, 337.3235],
        [217.6950, 381.3191, 217.6950, 381.3191],
        [217.6847, 228.2995, 217.6847, 228.2995],
        [217.7087, 322.5844, 217.7087, 369.1513]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 36.7200,  91.9893, 182.8640, 512.0000],
        [142.0595, 188.9621, 203.1923, 492.0252],
        [325.3200,  94.3522, 511.7520, 499.3471],
        [361.4925,  84.7507, 509.7062, 256.8458],
        [280.8800,  17.2381, 476.8240, 376.2961],
        [  0.0000, 162.5570,  68.9360, 356.5654],
        [116.0800,   2.4960, 253.9280, 102.1547],
        [171.8560, 183.4560, 259.2880, 344.2027]], device='cuda:0')
loss1: tensor([1.0000, 1.0957, 1.5436, 1.3940, 1.0000, 1.7192, 1.5586, 1.1344],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4454, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[253.9883, 257.2107, 253.9883, 257.2107],
        [230.2002, 383.7491, 230.2002, 388.4773],
        [262.1720, 361.7585, 262.1720, 389.9212],
        [142.4309, 181.6670, 142.4309, 218.6100],
        [212.1924, 182.2879, 212.1924, 182.2879],
        [337.2736, 452.7723, 337.2736, 495.9321],
        [ 78.9695,  79.4070,  78.9695,  95.2325],
        [136.3625, 187.5898, 136.3625, 187.5898]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.8640,   1.1520, 302.8880, 367.0293],
        [239.8960, 202.4960, 358.9760, 391.1893],
        [309.8897,  30.7098, 484.7753, 150.3744],
        [ 80.6160,  87.3781, 271.5120, 460.4740],
        [262.0000,   3.1573, 348.3520, 235.3280],
        [240.0800, 161.7252, 356.0640, 445.8976],
        [158.0640, 244.0853, 377.9840, 430.7840],
        [  5.9280,  74.7868, 170.3520, 388.8839]], device='cuda:0')
loss1: tensor([1.0000, 1.0753, 1.7383, 1.0000, 1.3658, 1.1497, 1.6092, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.9383, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[273.9323, 345.9518, 273.9323, 345.9518],
        [ 95.7362, 134.8855,  95.7362, 156.5678],
        [155.6534, 130.7573, 155.6534, 146.7460],
        [261.4474, 354.1165, 261.4474, 354.1165],
        [266.3308, 401.0238, 272.2419, 464.4921],
        [315.0058, 405.3159, 315.0058, 427.5746],
        [ 91.3789,  90.5763,  91.3789,  99.1351],
        [ 81.2043,  98.7703,  81.2043, 106.2928]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[256.4506,  71.0222, 464.7731, 451.5358],
        [ 57.8453,  58.3760, 358.2827, 170.7440],
        [376.2880, 350.8214, 497.1040, 506.9516],
        [391.6160, 270.4077, 511.7280, 512.0000],
        [110.1882, 311.7920, 347.1264, 491.5360],
        [217.8240, 126.7170, 304.0960, 486.1242],
        [220.8320, 119.3946, 450.0720, 506.2550],
        [110.0080, 231.5590, 214.6400, 367.2170]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.8532, 1.5201, 0.9912, 1.1123, 1.4052, 1.6037],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4856, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[136.4014, 233.2959, 136.4014, 244.8113],
        [321.6093, 326.9371, 321.6093, 355.9781],
        [266.6287, 403.7103, 266.6287, 403.7103],
        [245.8225, 401.5470, 245.8225, 436.3480],
        [148.4102, 126.9396, 148.4102, 126.9396],
        [121.2930, 158.2369, 121.2930, 170.5160],
        [114.6716,  99.7963, 114.6716,  99.7963],
        [232.2957, 272.4307, 232.2957, 315.1775]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[128.4640, 121.0497, 248.7280, 365.1469],
        [274.2886, 128.3277, 397.9776, 303.4180],
        [ 68.8747, 232.5840, 405.6213, 470.2160],
        [317.3583,  30.8320, 457.2959, 278.5760],
        [ 43.6240,  94.1280, 237.6320, 475.2640],
        [ 20.4160, 112.1004, 213.6080, 511.0408],
        [263.3040, 172.5812, 376.9120, 337.1166],
        [180.8320, 238.5776, 293.2800, 451.9389]], device='cuda:0')
loss1: tensor([1.0000, 1.2309, 1.0000, 1.5957, 1.0000, 1.0000, 1.6996, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.5263, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[146.5280, 168.6908, 146.5280, 168.6908],
        [118.0821, 152.2633, 118.0821, 178.2403],
        [418.6870, 427.6062, 418.6870, 427.6062],
        [ 91.1824,  97.0671,  91.1824, 109.5010],
        [160.7900, 230.1880, 160.7900, 241.0242],
        [172.6805, 208.9867, 172.6805, 212.1069],
        [285.9506, 479.7206, 285.9506, 479.7206],
        [159.7088, 207.4162, 159.7088, 242.0939]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[373.8080, 279.6409, 458.2400, 450.3076],
        [ 27.6173,  89.3884, 339.1283, 375.8763],
        [390.6320, 279.4987, 512.0000, 505.0880],
        [  2.3040,  48.3222, 225.6880, 393.4966],
        [ 89.0480, 102.2082, 317.0320, 441.6270],
        [ 85.2516,  31.0640, 376.2638, 465.9760],
        [178.4755, 150.3840, 471.3177, 493.6320],
        [114.7802,  30.5900, 354.3961, 360.3992]], device='cuda:0')
loss1: tensor([1.8358, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.8358, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 57.8986,  53.6830,  57.8986,  68.3317],
        [173.9444, 245.6193, 173.9444, 250.2071],
        [165.9435, 185.8281, 165.9435, 200.1434],
        [357.7153, 378.6285, 357.7153, 383.3411],
        [187.4345, 250.8997, 187.4345, 250.8997],
        [101.2865, 112.2517, 101.2865, 122.9643],
        [266.1696, 454.1044, 266.1696, 454.1044],
        [284.4747, 298.8148, 284.4747, 298.8148]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 72.4372, 246.9520, 508.7790, 507.5440],
        [349.1890, 262.6342, 481.8572, 410.9135],
        [ 94.1440, 438.2293, 339.4080, 506.4960],
        [160.1840,  23.9838, 483.4240, 504.7725],
        [  0.8640,  94.3467, 480.6480, 418.8054],
        [222.8765, 141.8720, 512.0000, 503.6240],
        [173.4880, 273.8301, 255.6240, 439.5166],
        [393.4000, 202.8373, 512.0000, 431.4133]], device='cuda:0')
loss1: tensor([1.4443, 1.6135, 1.7871, 1.0000, 1.0000, 1.3493, 1.1855, 1.4787],

  2%|▊                               | 64/2600 [00:15<08:33,  4.94it/s]
loss  tensor(10.8585, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[268.3087, 386.5170, 268.3087, 386.5170],
        [122.5617, 184.3939, 122.5617, 212.1116],
        [195.4300, 226.7894, 195.4300, 226.7894],
        [317.8105, 398.8396, 317.8105, 398.8396],
        [229.7665, 439.1389, 229.7665, 439.1389],
        [204.6174, 165.1039, 204.6174, 172.6853],
        [130.0294, 121.2647, 130.0294, 121.2647],
        [159.6657, 185.3889, 159.6657, 203.0065]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[2.5459e+02, 1.7670e+02, 3.4340e+02, 4.3503e+02],
        [4.7130e-01, 1.0673e+02, 1.6460e+02, 2.7309e+02],
        [5.2592e+01, 7.2489e+01, 4.7412e+02, 4.7288e+02],
        [2.9607e+02, 1.7254e+01, 4.8630e+02, 2.9569e+02],
        [1.4302e+02, 1.4232e+02, 2.1587e+02, 3.5450e+02],
        [0.0000e+00, 2.4759e+02, 5.2888e+01, 5.1200e+02],
        [6.2176e+01, 1.9409e+02, 5.0510e+02, 4.1960e+02],
        [4.2464e+01, 3.8430e+02, 5.1140e+02, 5.0477e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.2703, 1.3997, 1.8030, 1.2441, 1.6228],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.3399, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[306.8043, 561.9443, 306.8043, 561.9443],
        [187.2063, 236.8470, 187.2063, 236.8470],
        [235.8215, 292.1044, 235.8215, 292.1044],
        [166.7198, 180.5361, 166.7198, 180.5361],
        [229.2127, 254.4711, 229.2127, 254.4711],
        [106.0085,  98.4446, 106.0085, 101.3752],
        [191.5361, 250.5543, 191.5361, 250.5543],
        [179.2307, 263.9132, 179.2307, 265.4138]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[291.0933, 355.7440, 507.7973, 442.7600],
        [  0.0000, 301.5158,  90.0160, 458.5291],
        [ 16.6640, 167.6053, 173.0000, 251.4133],
        [123.0400, 134.0172, 240.7200, 247.9133],
        [348.0000, 261.4480, 464.8747, 510.8800],
        [ 19.2320, 128.5755, 233.1200, 416.8663],
        [246.2208,  46.8173, 387.7376, 174.5306],
        [288.7440, 132.9600, 409.2240, 278.7627]], device='cuda:0')
loss1: tensor([1.5780, 1.6594, 1.5198, 1.0000, 1.5176, 1.0946, 1.5479, 1.4762],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.3934, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[179.5704, 252.2613, 179.5704, 252.2613],
        [157.6976, 112.1756, 157.6976, 131.5802],
        [145.1150, 169.5079, 145.1150, 169.7804],
        [108.8760, 179.6838, 108.8760, 179.6838],
        [296.9715, 349.3951, 296.9715, 363.3744],
        [292.1507, 460.8803, 292.1507, 460.8803],
        [160.2635, 199.6206, 160.2635, 199.6206],
        [198.2978, 255.0882, 198.2978, 255.0882]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  1.5360,  23.2960, 512.0000, 505.3840],
        [102.6480, 253.2461, 199.8480, 425.0182],
        [106.2240,  96.3207, 427.9520, 482.3352],
        [112.1792, 182.0809, 235.5814, 318.9965],
        [  5.4198, 327.4800, 343.0760, 456.3840],
        [  0.0000,   0.0000, 158.7680, 192.1387],
        [149.2720,  54.8297, 262.6960, 317.8366],
        [242.7290, 162.5909, 328.4787, 413.9798]], device='cuda:0')
loss1: tensor([1.0000, 1.4509, 1.0000, 1.0428, 1.0000, 1.7734, 1.0000, 1.3413],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.6085, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[179.2456, 260.6168, 179.2456, 260.6168],
        [217.8934, 246.6139, 217.8934, 246.6139],
        [153.2626, 256.9544, 153.2626, 274.4443],
        [274.6491, 437.3153, 274.6491, 437.3153],
        [217.2435, 365.1653, 217.2435, 365.1653],
        [222.4737, 212.2164, 222.4737, 212.2164],
        [236.8302, 172.3009, 236.8302, 181.3632],
        [ 89.2148,  89.1153,  89.2148,  89.1153]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 93.0480, 191.5684, 171.2480, 405.3787],
        [176.2172, 115.0566, 509.6322, 505.0982],
        [ 10.6925, 235.4688, 163.8271, 357.6013],
        [147.7939, 179.9489, 284.7027, 438.8528],
        [391.3600,  65.7326, 512.0000, 264.2136],
        [325.3200,  30.7093, 409.8880, 299.9467],
        [345.1733, 190.9920, 512.0000, 512.0000],
        [  1.7226, 379.6880, 192.6938, 506.2480]], device='cuda:0')
loss1: tensor([1.0928, 1.0000, 1.0000, 1.0000, 1.7287, 1.5488, 1.4271, 1.6966],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4939, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[220.7171, 378.2632, 220.7171, 378.2632],
        [293.6147, 360.5287, 293.6147, 360.5287],
        [330.2645, 405.6562, 330.2645, 405.6562],
        [205.5022, 334.0206, 205.5022, 334.0206],
        [ 98.2481,  95.5780,  98.2481,  95.5780],
        [122.1632, 122.8960, 122.1632, 122.8960],
        [135.4643, 106.6887, 135.4643, 116.5650],
        [ 85.8341,  86.2606,  85.8341,  86.4966]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[145.1814,  36.3403, 428.9583, 230.1165],
        [347.5840,  52.0372, 418.7760, 409.6322],
        [347.4739,  18.2170, 512.0000, 153.9789],
        [171.0160, 177.4827, 289.6400, 318.8907],
        [129.7267,  54.3040, 290.3052, 314.9760],
        [144.1040,  28.5760, 353.8000, 244.8747],
        [121.6560,  95.9243, 208.3600, 384.5528],
        [ 39.7760,   3.4488, 295.7360, 505.0917]], device='cuda:0')
loss1: tensor([1.4333, 1.4312, 1.6828, 1.0967, 1.1639, 1.0947, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.9025, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[157.4211, 148.2858, 157.4211, 148.5214],
        [180.2441, 271.9383, 180.2441, 271.9383],
        [222.8443, 319.2443, 222.8443, 319.2443],
        [266.9821, 388.2512, 266.9821, 388.2512],
        [177.8211, 233.3682, 179.5271, 259.5384],
        [ 65.1396,  34.1213,  65.1396,  35.0285],
        [291.5078, 374.1784, 291.5078, 374.1784],
        [177.2986, 195.3947, 177.2986, 195.3947]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[231.4880, 332.3840, 317.5440, 485.6853],
        [ 12.9760, 122.7713, 121.4480, 444.6394],
        [ 74.1501, 190.1280, 317.3081, 321.2960],
        [ 13.8400,  19.0293, 512.0000, 512.0000],
        [  2.0480, 339.9840, 134.8640, 463.7600],
        [  2.2800,  53.7720,  76.9920, 264.0526],
        [103.7669, 464.5600, 400.7269, 512.0000],
        [160.6069, 211.9200, 277.5497, 396.5440]], device='cuda:0')
loss1: tensor([1.7558, 1.3515, 1.0000, 1.0000, 1.5969, 1.0855, 1.6558, 1.0822],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.5276, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[145.0662, 183.9495, 145.0662, 189.6794],
        [419.2871, 387.5815, 419.2871, 392.6801],
        [113.3353, 195.0389, 113.3353, 195.0389],
        [111.2797,  84.4459, 111.2797,  89.7121],
        [250.6053, 452.6995, 250.6053, 452.6995],
        [ 71.9294,  51.9032,  71.9294,  58.1071],
        [190.3826, 255.7445, 190.3826, 255.7445],
        [189.4781, 269.3900, 189.4781, 300.2975]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 46.4960,   0.0000, 212.6640, 173.3440],
        [290.8080, 208.2560, 512.0000, 417.6533],
        [  0.0000, 155.5947, 167.5600, 501.3653],
        [260.0141,  13.7762, 512.0000, 506.2656],
        [  0.0000,  49.2640, 240.7039, 512.0000],
        [  1.3600,  87.6480, 260.7120, 477.3760],
        [ 28.3360, 322.1013, 127.5920, 477.7386],
        [  0.0000, 244.8607,  88.0800, 418.2093]], device='cuda:0')
loss1: tensor([1.0861, 1.0000, 1.0000, 1.3712, 1.0395, 1.0840, 1.5706, 1.5351],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.6865, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[192.7755, 215.1461, 192.7755, 215.1461],
        [219.7482, 449.6269, 219.7482, 449.6269],
        [ 92.9191, 125.9674,  92.9191, 125.9674],
        [310.2697, 402.6064, 310.2697, 402.6064],
        [192.2680, 263.9982, 192.2680, 275.4357],
        [ 83.1897,  95.3314,  83.1897,  99.4084],
        [336.8189, 220.5296, 336.8189, 244.5914],
        [ 66.4185,  53.2702,  66.4185,  64.4738]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 19.3280,  63.4304, 511.9200, 512.0000],
        [ 41.6800, 303.0756, 200.6320, 463.1348],
        [389.0960,  25.2860, 511.9520, 405.7841],
        [271.3809, 166.5672, 490.0258, 296.2077],
        [  0.0000,  51.7159,  64.5920, 312.9235],
        [239.8960,  36.8213, 439.2240, 242.7733],
        [363.1330,  15.7120, 512.0000, 512.0000],
        [  1.8400,  67.2107, 136.0000, 191.4667]], device='cuda:0')
loss1: tensor([1.0000, 1.1074, 1.7068, 1.4508, 1.6641, 1.4401, 1.1502, 1.1009],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.6202, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[184.7503, 324.3769, 184.7503, 324.3769],
        [235.8985, 369.2612, 235.8985, 369.2612],
        [218.3423, 204.3309, 218.3423, 204.3309],
        [131.6201, 219.6127, 131.6201, 219.6127],
        [207.8568, 346.2419, 207.8568, 346.2419],
        [192.2587, 192.3526, 192.2587, 192.3526],
        [141.3362, 181.2537, 141.3362, 181.2537],
        [248.0311, 252.4730, 248.0311, 252.4730]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 195.4202, 163.5430, 512.0000],
        [158.1360, 255.4245, 242.5760, 494.7455],
        [351.0960, 111.0429, 500.3680, 255.2602],
        [ 46.8080,  60.6293, 220.2080, 351.0187],
        [120.3440, 329.5147, 223.1680, 457.8667],
        [144.0800, 174.6221, 259.9520, 507.5426],
        [205.1600,  51.5477, 512.0000, 322.9557],
        [  0.0000, 214.7120, 302.4320, 512.0000]], device='cuda:0')
loss1: tensor([1.1148, 1.0000, 1.4707, 1.0000, 1.0000, 1.0000, 1.1722, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.7577, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[116.1026, 231.2476, 116.1026, 231.2476],
        [154.7837, 292.7978, 154.7837, 292.7978],
        [170.0920, 157.6488, 170.0920, 158.0122],
        [219.7318, 255.8442, 219.7318, 255.8442],
        [398.9841, 353.8669, 398.9841, 353.8669],
        [ 99.4773, 178.0148,  99.4773, 178.0148],
        [223.6842, 339.5276, 223.6842, 339.5276],
        [ 81.2000,  68.2999,  81.2000,  68.2999]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  1.5333,  81.3466, 121.5110, 408.1049],
        [123.3280, 202.9523, 206.4400, 477.4091],
        [ 72.1033, 388.0243, 395.7965, 495.0323],
        [  5.8773, 177.2720, 262.7946, 273.0640],
        [375.5520, 133.2400, 512.0000, 253.1760],
        [200.2000, 243.9147, 321.8720, 396.9387],
        [152.1680,  49.8331, 371.5760, 466.1598],
        [  0.0000,  87.2480, 457.5331, 387.5440]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.6828, 1.0000, 1.4564, 1.6176, 1.0000, 1.0594],
       device='cuda:0', grad_fn=<RsubBackward1>)

  3%|▉                               | 74/2600 [00:18<08:37,  4.88it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[216.9453, 151.1355, 216.9453, 151.1355],
        [176.7800, 206.9404, 176.7800, 206.9404],
        [224.6605, 356.9984, 224.6605, 356.9984],
        [ 43.3922,  43.1364,  43.3922,  47.2382],
        [300.2224, 332.7204, 300.2224, 332.7204],
        [121.7500, 254.5930, 121.7500, 254.5930],
        [168.6085, 297.6784, 168.6085, 297.6784],
        [212.8008, 302.2069, 212.8008, 302.2069]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[138.3765,   1.7306, 418.2152, 164.3213],
        [ 60.1920, 283.0364, 251.7600, 414.2080],
        [105.9360,  28.7655, 443.6960, 430.3078],
        [  6.8320, 157.2675, 236.7280, 339.8082],
        [250.2451, 108.4348, 349.4810, 255.7133],
        [135.4880, 375.4706, 430.0240, 506.4972],
        [  1.4320,  45.2096,  81.7920, 451.0976],
        [332.5236,  38.1440, 423.7461, 277.2560]], device='cuda:0')
loss1: tensor([1.0000, 1.3671, 1.0000, 1.3847, 1.3433, 1.5030, 1.5193, 1.6084],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7259, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[102.3887, 119.5157, 102.3887, 140.0998],
        [124.3506, 235.1430, 124.3506, 235.1430],
        [176.7301, 121.1967, 176.7301, 133.8964],
        [237.2176, 273.6648, 237.2176, 273.6648],
        [256.8964, 376.5869, 256.8964, 376.5869],
        [336.9951, 536.5781, 336.9951, 536.5781],
        [115.1901, 124.4501, 115.1901, 124.4501],
        [119.5254, 117.4874, 119.5254, 117.4874]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[1.0718e+01, 3.4670e+02, 2.3265e+02, 5.0511e+02],
        [4.8320e+01, 5.9829e+01, 2.0278e+02, 2.7614e+02],
        [8.0000e-02, 1.6878e+02, 1.4578e+02, 3.6525e+02],
        [2.0020e+02, 3.1392e+02, 2.7354e+02, 5.0490e+02],
        [1.4838e+02, 1.0435e+02, 4.0316e+02, 5.0475e+02],
        [2.5256e+02, 2.0699e+02, 4.7298e+02, 4.4306e+02],
        [2.9336e+01, 1.3922e+02, 1.8639e+02, 4.1075e+02],
        [4.8200e+01, 9.0596e+01, 2.5861e+02, 4.5599e+02]], device='cuda:0')
loss1: tensor([1.5892, 1.0000, 1.3360, 1.1741, 1.0000, 1.2837, 1.0516, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.4346, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[383.8005, 378.9104, 383.8005, 378.9104],
        [159.8534, 164.1645, 159.8534, 164.1645],
        [195.4086, 255.4995, 195.4086, 255.4995],
        [173.5511, 384.0713, 173.5511, 384.0713],
        [ 82.5935, 115.2322,  82.5935, 115.4200],
        [131.5015, 212.9880, 131.5015, 212.9880],
        [ 98.2397, 276.2715,  98.2397, 276.2715],
        [263.3245, 262.7500, 263.3245, 262.7500]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[3.0573e+02, 2.0285e+02, 4.7346e+02, 4.4453e+02],
        [2.2444e+02, 1.3600e-01, 3.4281e+02, 2.5022e+02],
        [2.9250e+02, 1.9450e+02, 4.5489e+02, 4.3134e+02],
        [4.0592e+01, 3.3596e+02, 4.3346e+02, 4.7979e+02],
        [1.0824e+01, 1.7424e+02, 2.5197e+02, 3.8343e+02],
        [2.9148e+02, 0.0000e+00, 5.0318e+02, 5.0625e+02],
        [1.2960e+00, 3.1669e+02, 1.4497e+02, 4.9963e+02],
        [1.2227e+02, 9.5519e+01, 5.0015e+02, 4.0303e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.3530, 1.3742, 1.0000, 1.2200, 1.4304, 1.1809, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.5586, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[228.8812, 260.6147, 228.8812, 260.6147],
        [178.0503, 112.3378, 178.0503, 130.9412],
        [276.8876, 288.0864, 276.8876, 288.0864],
        [101.9799, 173.7760, 101.9799, 173.7760],
        [102.0409, 300.3709, 102.0409, 300.3709],
        [ 90.9347, 287.2823,  90.9347, 287.2823],
        [319.2119, 343.4030, 319.2119, 343.4030],
        [144.5946, 217.9510, 144.5946, 217.9510]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 66.6160, 178.7923, 512.0000, 277.4752],
        [ 64.7760,   0.8633, 455.7200, 411.1588],
        [290.1440, 241.3373, 450.0240, 380.3443],
        [135.7120,  74.8335, 512.0000, 505.9327],
        [ 47.3813, 281.2960, 189.0133, 438.2000],
        [151.5725, 149.5009, 223.3958, 439.8869],
        [256.8240,   2.1973, 511.1760, 173.9733],
        [ 30.6790, 209.6947, 342.0979, 488.1306]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0766, 1.0823, 1.0000, 1.4578, 1.4966, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.1132, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[249.9209, 230.0995, 249.9209, 230.0995],
        [266.1816, 368.4443, 266.1816, 368.4443],
        [ 77.1781, 117.0034,  77.1781, 117.0034],
        [132.5287, 186.1020, 132.5287, 186.1020],
        [105.4384, 118.4085, 105.4384, 118.4085],
        [168.1725, 179.6247, 168.1725, 179.6247],
        [132.3059, 320.4864, 132.3059, 320.4864],
        [262.9057, 440.7863, 262.9057, 440.7863]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[240.9280, 220.3629, 429.6160, 496.4848],
        [ 20.6643,   4.7476, 252.7539, 258.6863],
        [ 49.3680, 123.1256, 408.4000, 480.1381],
        [154.5203, 104.9349, 321.7318, 425.5121],
        [114.6320,  43.1423, 375.9920, 195.4833],
        [386.0275, 112.9772, 512.0000, 297.8951],
        [  0.0000,   2.0240, 216.8886, 379.9520],
        [431.2883,   1.4131, 512.0000, 166.6150]], device='cuda:0')
loss1: tensor([1.0000, 1.3400, 1.0169, 1.1162, 1.0340, 1.6336, 1.0000, 1.8782],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.0188, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[142.9784, 157.4970, 142.9784, 159.4064],
        [ 79.2369, 142.8848,  79.2369, 142.8848],
        [101.2526, 104.6678, 101.2526, 104.6678],
        [174.8975, 140.2000, 174.8975, 140.2000],
        [ 72.6287,  73.9472,  72.6287,  73.9472],
        [298.4326, 545.3350, 298.4326, 545.3350],
        [141.4812, 218.1528, 141.4812, 218.1528],
        [389.1901, 420.7503, 389.1901, 420.7503]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 47.2240, 101.4064, 160.5520, 432.5437],
        [168.4480, 186.5277, 271.8720, 406.1240],
        [ 49.1360,  73.4146, 411.4960, 506.1981],
        [211.5200,  46.5813, 470.6480, 199.5733],
        [ 54.2080, 175.5200, 312.6240, 410.4320],
        [199.2880,   8.0508, 512.0000, 470.5854],
        [339.4000, 151.9094, 455.1440, 306.9706],
        [220.1760, 274.2018, 364.2720, 497.8511]], device='cuda:0')
loss1: tensor([1.0000, 1.5521, 1.0000, 1.1238, 1.3019, 1.1391, 1.6310, 1.1474],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.8954, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[103.3344,  78.6941, 103.3344,  78.6941],
        [165.9557, 227.4450, 165.9557, 227.4450],
        [250.2153, 133.7017, 250.2153, 151.2531],
        [279.5024, 381.3895, 279.5024, 381.3895],
        [252.0079, 365.8633, 252.0079, 365.8633],
        [171.0403, 330.0411, 171.0403, 330.0411],
        [131.2513, 198.8079, 131.2513, 198.8079],
        [ 92.7495, 116.3360,  92.7495, 117.8870]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[124.2000, 123.6834, 192.5360, 459.5410],
        [ 94.9200, 140.5013, 294.2560, 504.0746],
        [227.5305,  79.0839, 395.8630, 341.6512],
        [335.3760, 164.7929, 512.0000, 387.4844],
        [176.1680, 112.9765, 343.1040, 498.9957],
        [  0.9920, 356.9600, 487.4640, 506.8480],
        [102.4962,  40.9088, 375.8229, 452.3827],
        [  1.5872,  34.5192, 299.2947, 508.5421]], device='cuda:0')
loss1: tensor([1.3244, 1.0000, 1.0000, 1.2403, 1.0000, 1.1523, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.7170, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[166.8511, 345.8114, 166.8511, 345.8114],
        [ 92.5843, 125.1350,  92.5843, 125.1350],
        [190.4026, 112.4775, 190.4026, 123.0616],
        [279.8286, 306.6708, 279.8286, 306.6708],
        [240.9042, 246.8157, 240.9042, 246.8157],
        [ 83.6645, 119.9548,  83.6645, 119.9548],
        [333.9438, 437.8794, 333.9438, 437.8794],
        [117.5640, 294.9147, 117.5640, 294.9147]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[414.2592,  17.0616, 512.0000, 507.2019],
        [ 66.2480, 142.9283, 279.7120, 359.1314],
        [ 95.8240, 147.6347, 368.8640, 489.7328],
        [246.0058,  12.1037, 510.4572, 503.3472],
        [251.2314, 217.5498, 512.0000, 411.9927],
        [  3.0720, 190.9988, 155.0640, 361.2778],
        [203.4930, 257.7280, 406.9861, 503.9440],
        [  0.0000, 132.4089,  46.9919, 435.2084]], device='cuda:0')
loss1: tensor([1.7168, 1.0760, 1.0932, 1.0000, 1.0381, 1.2944, 1.0000, 1.6003],
       device='cuda:0', grad_fn=<RsubBackward1>)

  3%|█                               | 85/2600 [00:20<08:23,  5.00it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[197.1402, 209.7757, 197.1402, 214.1688],
        [118.3017, 254.6787, 118.3017, 278.3207],
        [ 92.0399, 152.4396,  92.0399, 152.4396],
        [144.3176, 204.8039, 144.3176, 204.8039],
        [317.2805, 371.2945, 317.2805, 371.2945],
        [159.6686, 144.1922, 159.6686, 144.1922],
        [102.1541, 125.3397, 102.1541, 125.3397],
        [452.1331, 379.3411, 452.1331, 379.3411]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[227.2960, 162.8208, 408.0720, 462.6226],
        [  1.4677, 222.4896,  96.1621, 423.9872],
        [  0.0000, 182.1857, 247.8960, 478.5461],
        [120.1562, 190.9225, 259.7069, 404.9691],
        [195.0240,  67.6907, 421.9680, 181.6000],
        [140.1120, 163.1680, 320.0000, 458.3787],
        [320.0120, 209.4000, 476.5667, 446.4160],
        [254.5971, 166.6388, 335.2166, 481.8909]], device='cuda:0')
loss1: tensor([1.1430, 1.1895, 1.0912, 1.0000, 1.6248, 1.0604, 1.6913, 1.5919],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.3921, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[202.0475, 292.5588, 202.0475, 292.5588],
        [109.2149, 165.4264, 109.2149, 165.4264],
        [ 83.5332,  79.8318,  83.5332,  79.8318],
        [351.6744, 473.3113, 351.6744, 473.3113],
        [100.2087, 157.6545, 100.2087, 157.6545],
        [145.0540, 184.5813, 145.0540, 184.5813],
        [263.9308, 245.6841, 263.9308, 245.6841],
        [280.7131, 367.3503, 280.7131, 367.3503]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000,   1.6533, 260.6880, 507.0293],
        [ 27.2880,  92.5867, 268.0240, 440.8533],
        [ 19.3760, 341.0857, 119.7760, 506.0343],
        [225.2646, 328.2432, 328.7101, 460.5031],
        [ 46.0200,  11.5040, 273.2600, 361.2800],
        [210.7200, 184.7865, 386.9760, 511.5454],
        [261.1280,   0.7861, 512.0000, 512.0000],
        [216.5920,   0.0000, 346.8960, 165.6853]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.6130, 1.2539, 1.0000, 1.2719, 1.0000, 1.5490],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.6878, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[211.1994, 208.4817, 211.1994, 208.4817],
        [ 68.4661, 113.6096,  68.4661, 125.1368],
        [280.7751, 295.7045, 280.7751, 295.7045],
        [102.8042, 177.1251, 102.8042, 177.1251],
        [244.7936, 510.3629, 244.7936, 510.3629],
        [ 78.8465, 138.6215,  78.8465, 139.0930],
        [333.5948, 176.1530, 333.5948, 176.1530],
        [206.1741, 314.4053, 206.1741, 314.4053]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[335.6880,  96.4800, 431.7680, 256.6080],
        [  0.9523,   2.3003, 311.5213, 505.0991],
        [359.8336, 266.9363, 512.0000, 484.3929],
        [122.5318, 105.9226, 305.4695, 502.8659],
        [377.4618, 225.8880, 510.4015, 512.0000],
        [ 52.7280, 131.8370, 244.5440, 505.2373],
        [215.1360,  32.4960, 490.9653, 203.2080],
        [137.0560, 219.4453, 228.8960, 367.9040]], device='cuda:0')
loss1: tensor([1.5644, 1.0000, 1.3419, 1.0973, 1.4995, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.5031, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 63.9056,  93.9802,  63.9056, 101.9149],
        [357.0446, 528.3159, 357.0446, 528.3159],
        [225.9704, 115.8788, 225.9704, 120.3635],
        [255.1356, 388.5870, 255.1356, 388.5870],
        [ 72.1573,  90.7616,  72.1573, 100.6784],
        [112.0900, 214.4582, 112.0900, 214.4582],
        [236.3089, 253.9194, 236.3089, 253.9194],
        [148.8389, 145.2552, 148.8389, 145.2552]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[340.5735, 222.6240, 512.0000, 434.3360],
        [418.7280, 190.8101, 512.0000, 383.8438],
        [310.1280,  23.0820, 428.3440, 160.0030],
        [ 21.4720,   0.0000, 487.8400, 435.8720],
        [297.4507, 317.1360, 512.0000, 433.2320],
        [300.6486, 151.1120, 512.0000, 505.9360],
        [348.2347, 347.4720, 509.3120, 510.8480],
        [408.4960, 185.2053, 507.3120, 487.6587]], device='cuda:0')
loss1: tensor([1.7620, 1.6557, 1.4159, 1.0000, 1.8346, 1.4715, 1.6248, 1.7565],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.5211, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[130.5974, 297.8805, 130.5974, 297.8805],
        [150.7423, 135.9022, 150.7423, 135.9022],
        [238.6489, 339.1281, 238.6489, 339.1281],
        [188.0444, 175.2461, 188.0444, 175.2461],
        [256.1108, 425.3610, 256.1108, 425.3610],
        [163.0583,  84.2557, 163.0583,  85.9767],
        [217.0082, 176.8143, 217.0082, 193.2311],
        [212.1184, 320.7585, 212.1184, 320.7585]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[145.4080, 175.8862, 268.7920, 314.5102],
        [347.2291, 271.1654, 432.1164, 456.4685],
        [206.4720, 194.3076, 375.3440, 391.4997],
        [155.7988, 137.2480, 391.7795, 437.7440],
        [260.5920,   1.8133, 384.1360, 139.9147],
        [357.2480,  40.2667, 511.7120, 506.2507],
        [435.8240, 171.1183, 512.0000, 365.9421],
        [289.7200,  38.8693, 512.0000, 169.7813]], device='cuda:0')
loss1: tensor([1.1072, 1.8256, 1.0000, 1.0000, 1.6854, 1.5570, 1.7418, 1.6558],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.5726, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[301.7195, 328.6319, 301.7195, 328.6319],
        [313.4097, 398.3098, 313.4097, 398.3098],
        [236.3822, 136.2019, 236.3822, 136.2019],
        [127.6797,  97.8549, 127.6797,  97.8549],
        [101.7156, 120.4046, 101.7156, 120.4046],
        [121.3237, 225.8906, 121.3237, 225.8906],
        [284.4674, 292.5655, 284.4674, 292.5655],
        [222.3217, 413.8455, 222.3217, 413.8455]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 56.6960, 114.7093, 224.2160, 444.5867],
        [350.3440, 180.6400, 492.7280, 354.3680],
        [173.8240,  38.7200, 338.1440, 238.9520],
        [  1.7760,   0.0000, 204.6080, 202.8935],
        [241.6188, 168.9433, 512.0000, 495.7030],
        [ 16.3760,  20.5762, 400.9040, 436.7744],
        [376.1920, 369.1733, 512.0000, 512.0000],
        [ 44.3211, 429.8560, 225.0391, 512.0000]], device='cuda:0')
loss1: tensor([1.3163, 1.3663, 1.0000, 1.0000, 1.4262, 1.0000, 1.6115, 1.1631],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.8834, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[394.6582, 531.6172, 394.6582, 531.6172],
        [ 94.5732, 190.2230,  94.5732, 194.8322],
        [120.2516, 317.1331, 120.2516, 317.1331],
        [214.6162, 176.9308, 214.6162, 176.9308],
        [229.4285, 227.5823, 229.4285, 227.5823],
        [317.9278, 273.4525, 317.9278, 273.4525],
        [ 93.4618,  84.8956,  93.4618,  84.8956],
        [274.4268, 124.8520, 274.4268, 147.7034]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[170.9760, 187.1138, 380.4400, 337.3325],
        [  0.0000, 151.8850, 141.6868, 297.3114],
        [112.3200, 254.0335, 204.0880, 511.7722],
        [  0.0000, 130.2293, 132.3280, 283.5947],
        [153.7680, 163.9040, 249.9840, 406.7307],
        [167.1840,  68.8415, 296.3680, 409.0296],
        [ 29.3360, 109.5893, 198.4720, 440.9493],
        [231.2640, 110.4533, 396.0800, 385.4400]], device='cuda:0')
loss1: tensor([1.5917, 1.0000, 1.0000, 1.3834, 1.0000, 1.1430, 1.0694, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.1875, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[109.7783, 113.7560, 109.7783, 115.8125],
        [324.7250, 276.1042, 324.7250, 276.1042],
        [147.7637, 184.4496, 147.7637, 184.4496],
        [253.8368, 393.2610, 253.8368, 393.2610],
        [385.7483, 365.8503, 385.7483, 365.8503],
        [126.9112, 119.8123, 126.9112, 119.8123],
        [137.9101, 298.6155, 137.9101, 298.6155],
        [195.8531, 188.0508, 195.8531, 188.9047]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000,   9.1129, 342.4240, 512.0000],
        [372.0880, 173.7306, 510.3840, 333.6674],
        [149.5840,  52.9636, 279.9280, 512.0000],
        [114.8720,  48.3209, 432.8720, 453.3257],
        [200.6240,  34.6677, 328.1360, 380.0045],
        [159.1040,  88.3829, 341.1920, 486.3041],
        [ 11.9309, 160.8640, 262.4798, 358.0560],
        [263.7005,  64.4374, 445.2557, 510.8527]], device='cuda:0')
loss1: tensor([1.0000, 1.2551, 1.0138, 1.0000, 1.3112, 1.1502, 1.0000, 1.2720],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.0024, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[209.8067, 229.7272, 209.8067, 229.7272],
        [253.3588, 371.4982, 253.3588, 371.4982],
        [251.2493, 270.0154, 251.2493, 270.0154],
        [254.2049, 361.2462, 254.2049, 361.2462],
        [301.9414, 412.7977, 301.9414, 412.7977],
        [125.5905,  85.4949, 125.5905,  85.4949],
        [281.0223, 180.5393, 281.0223, 180.5393],
        [108.5078, 157.8041, 108.5078, 157.8041]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[2.6944e+02, 2.6542e+02, 5.1048e+02, 3.4136e+02],
        [1.4592e+02, 2.7042e+02, 2.6573e+02, 5.0567e+02],
        [2.4722e+02, 1.2430e+02, 4.1990e+02, 5.0833e+02],
        [1.6251e+02, 3.5778e+02, 3.0787e+02, 5.1153e+02],
        [1.3903e+02, 1.6221e+02, 3.4345e+02, 3.8179e+02],
        [3.3525e+02, 1.7622e+02, 4.2735e+02, 3.5014e+02],
        [2.7073e+02, 4.1600e-01, 4.0304e+02, 1.2882e+02],
        [3.4688e+01, 4.1319e+02, 3.0505e+02, 5.0363e+02]], device='cuda:0')
loss1: tensor([1.4547, 1.0000, 1.0000, 1.0000, 1.1237, 1.7994, 1.2872, 1.7385],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4035, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[366.3846, 306.1657, 366.3846, 306.1657],
        [202.2618, 164.2142, 202.2618, 164.2142],
        [118.1169,  93.2938, 118.1169,  93.2938],
        [106.4539, 240.5747, 106.4539, 272.3195],
        [305.9202, 343.3765, 305.9202, 343.3765],
        [178.0620, 258.8225, 178.0620, 258.8225],
        [226.9551, 259.8963, 226.9551, 259.8963],
        [307.8608, 379.5433, 307.8608, 379.5433]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[364.3040, 234.0551, 501.9440, 331.1360],
        [218.1696, 306.2320, 376.4699, 512.0000],
        [188.3337, 116.0320, 327.5256, 243.8080],
        [ 44.7280,  97.4400, 234.8218, 506.8080],
        [  0.0000, 121.8027, 149.6560, 367.3813],
        [108.6669, 129.3992, 260.8845, 378.0190],
        [  0.6320, 211.1783, 107.3120, 378.7787],
        [ 72.8783, 226.9440, 398.2101, 418.9600]], device='cuda:0')
loss1: tensor([1.0000, 1.4624, 1.4357, 1.0000, 1.5108, 1.0000, 1.5286, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)

  4%|█▏                              | 96/2600 [00:22<07:03,  5.92it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[179.5906, 165.8591, 179.5906, 165.8591],
        [107.5835, 267.9311, 107.5835, 267.9537],
        [232.2882, 218.7949, 232.2882, 218.7949],
        [369.5856, 248.6119, 369.5856, 249.6437],
        [446.1753, 350.5111, 446.1753, 350.5111],
        [207.7495, 263.5843, 207.7495, 265.0751],
        [ 82.1550, 130.7618,  82.1550, 143.0469],
        [218.9198, 328.6320, 218.9198, 328.6320]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[207.1040,  94.3467, 491.0000, 350.9227],
        [  0.0000, 153.0240, 211.4160, 345.1733],
        [ 18.1333, 231.7200, 191.5307, 315.0480],
        [215.7600, 392.4907, 480.1680, 512.0000],
        [  2.2400, 185.9381, 144.5200, 286.8770],
        [127.5399, 311.6089, 365.9211, 377.2151],
        [  0.0000, 248.6685, 129.5760, 504.6685],
        [ 32.3440, 273.4761, 493.2640, 473.6740]], device='cuda:0')
loss1: tensor([1.0884, 1.0000, 1.2990, 1.5463, 1.8034, 1.4226, 1.3153, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.4751, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[463.5974, 456.7095, 463.5974, 456.7095],
        [114.6461, 223.6322, 114.6461, 232.9089],
        [175.6169, 363.8865, 175.6169, 363.8865],
        [152.8660, 116.7935, 152.8660, 116.7935],
        [237.1062, 114.1181, 237.1062, 118.7521],
        [288.5015, 392.5249, 288.5015, 392.5249],
        [180.2792, 180.0826, 180.2792, 180.0826],
        [212.1675, 212.4089, 212.1675, 212.4089]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[370.7680, 288.4347, 445.2320, 492.0836],
        [149.1840, 302.5960, 249.2480, 469.4312],
        [ 77.8400, 233.5147, 266.3760, 354.5920],
        [148.4640,  61.6923, 354.7360, 209.3014],
        [173.5697, 107.6873, 291.4384, 222.2348],
        [ 24.7040, 145.7747, 480.8480, 380.4898],
        [  1.5360, 187.6160, 512.0000, 502.8720],
        [218.1546,   6.5440, 364.9316, 169.0560]], device='cuda:0')
loss1: tensor([1.1978, 1.4954, 1.0713, 1.0000, 1.0000, 1.0488, 1.0233, 1.2415],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.0782, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[111.6176, 204.5621, 111.6176, 204.5621],
        [240.7997, 326.7048, 240.7997, 326.7048],
        [139.8728, 183.6128, 139.8728, 183.6128],
        [160.7383, 120.6161, 160.7383, 120.6161],
        [228.0179, 376.5708, 228.0179, 376.5708],
        [616.0743, 338.0585, 616.0743, 338.0585],
        [141.8424, 205.7569, 141.8424, 206.1006],
        [179.6355, 273.3322, 179.6355, 273.3322]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[1.0240e+02, 0.0000e+00, 1.7590e+02, 2.2242e+02],
        [3.4198e+02, 2.0588e+02, 4.5611e+02, 4.6716e+02],
        [1.0567e+02, 0.0000e+00, 2.2335e+02, 4.5713e+02],
        [1.9739e+02, 0.0000e+00, 2.9123e+02, 2.1746e+02],
        [2.6696e+01, 6.8267e-01, 1.6617e+02, 1.3042e+02],
        [3.7044e+02, 5.9830e+01, 4.8178e+02, 2.2781e+02],
        [1.3893e+02, 3.5437e+02, 5.1085e+02, 5.0625e+02],
        [1.3749e+01, 1.1200e-01, 5.1200e+02, 5.0294e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.4699, 1.0000, 1.2809, 1.7609, 1.7263, 1.4946, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7326, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[375.8389, 258.9511, 375.8389, 258.9511],
        [168.1334, 210.7752, 168.1334, 210.7752],
        [239.0222, 273.8690, 239.0222, 273.8690],
        [161.1996, 145.6299, 161.1996, 145.6299],
        [125.0874,  98.6156, 125.0874,  98.6156],
        [423.9248, 560.1573, 423.9248, 560.1573],
        [118.0588, 100.8299, 118.0588, 100.8299],
        [109.3618, 208.5701, 109.3618, 221.9960]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[211.7013,   0.0000, 512.0000, 362.0720],
        [  4.3315,  40.9382, 205.5168, 506.8145],
        [261.9280, 213.3013, 414.5200, 386.8800],
        [  3.9004,  19.3920, 454.7260, 482.2640],
        [251.9920, 178.2746, 394.1680, 372.0894],
        [ 45.9360, 108.6933, 183.7280, 486.2507],
        [ 33.8560,   0.5756, 512.0000, 506.8081],
        [431.4600,  81.6880, 512.0000, 371.6320]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.1305, 1.0000, 1.6255, 1.6951, 1.0000, 1.8000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.2512, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[407.6028, 372.5695, 407.6028, 372.5695],
        [187.2174, 225.2199, 187.2174, 225.2199],
        [352.8115, 427.0417, 352.8115, 427.0417],
        [173.5149, 274.6215, 173.5149, 274.6215],
        [212.1058, 213.1335, 212.1058, 213.1335],
        [293.8944, 178.5253, 293.8944, 178.5253],
        [ 80.4746, 100.5886,  80.4746, 102.7652],
        [137.8661, 190.5486, 137.8661, 190.5486]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[250.3578, 233.5616, 461.1482, 299.1488],
        [213.3360,  62.3040, 477.2720, 414.2293],
        [272.8480, 157.8560, 403.7200, 324.0107],
        [308.7053, 175.1177, 449.5667, 349.9077],
        [131.0240, 127.7227, 247.1360, 394.1013],
        [  0.0000,  58.8082, 158.0880, 341.3293],
        [  8.8265, 168.7859, 180.0010, 488.6323],
        [206.4998, 198.6960, 278.7430, 505.5270]], device='cuda:0')
loss1: tensor([1.5282, 1.0900, 1.3828, 1.4897, 1.0000, 1.4621, 1.1757, 1.5005],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.6290, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[322.1295, 481.8801, 322.1295, 481.8801],
        [423.7370, 321.0116, 423.7370, 321.0116],
        [129.7139, 106.9827, 129.7139, 106.9827],
        [162.8756, 178.8887, 162.8756, 178.8887],
        [ 98.3429,  40.5904,  98.3429,  53.5040],
        [187.8938, 166.9001, 187.8938, 166.9001],
        [111.6279, 194.6055, 111.6279, 202.4004],
        [314.5081, 391.8699, 314.5081, 391.8699]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  9.2960,  10.6935, 284.3200, 434.8539],
        [346.3760, 132.0316, 427.7760, 446.8505],
        [101.8640,  34.4371, 382.9600, 391.4582],
        [  0.8080,  36.1391, 288.4240, 389.1200],
        [303.0221, 126.9350, 510.2592, 500.7770],
        [439.1147, 200.8640, 511.6240, 390.0240],
        [  1.5280, 137.8914, 511.2000, 504.1037],
        [134.0240, 167.6259, 398.2400, 424.2028]], device='cuda:0')
loss1: tensor([1.2086, 1.0000, 1.0000, 1.0000, 1.5913, 1.8101, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.6100, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[151.8765, 132.6656, 151.8765, 132.6656],
        [227.8274, 199.8228, 227.8274, 199.8228],
        [144.8050, 197.5636, 144.8050, 197.5636],
        [465.6033, 469.5820, 465.6033, 469.5820],
        [415.3217, 399.3296, 415.3217, 399.3296],
        [164.5668, 179.8967, 164.5668, 179.8967],
        [153.9380, 175.7240, 153.9380, 175.7240],
        [127.2745, 179.8568, 127.2745, 187.3864]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 93.1974,  25.1231, 390.0403, 412.8627],
        [ 70.5707, 277.2880, 217.8347, 368.1760],
        [ 31.9280, 228.9600, 461.6640, 285.3440],
        [204.2163, 167.1849, 360.6221, 406.3431],
        [272.8400, 200.2088, 456.5280, 504.1277],
        [261.1920, 299.2427, 390.9200, 505.6533],
        [ 85.1093, 304.5440, 466.3360, 405.6080],
        [191.8080, 221.2907, 279.4880, 381.4613]], device='cuda:0')
loss1: tensor([1.0000, 1.4944, 1.3577, 1.5268, 1.0000, 1.6368, 1.5604, 1.5424],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.1184, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[345.5804, 428.5387, 345.5804, 428.5387],
        [233.4274, 242.5078, 233.4274, 242.5078],
        [197.0545, 160.8626, 197.0545, 160.8626],
        [173.3574, 170.6324, 173.3574, 170.6324],
        [382.2644, 332.3127, 382.2644, 332.3127],
        [173.8606, 219.0975, 173.8606, 219.0975],
        [246.3029, 211.3454, 246.3029, 211.3454],
        [136.0769, 216.9840, 136.0769, 216.9840]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 20.9652,  11.5869, 321.1043, 166.0654],
        [252.3280,  25.1433, 415.4240, 505.9305],
        [200.8240, 224.2560, 336.7040, 337.8320],
        [136.9440, 146.1547, 226.1600, 420.7147],
        [252.2560, 294.0373, 332.8000, 505.5253],
        [ 55.9525, 124.7920, 288.8745, 472.5040],
        [170.6480, 120.1511, 302.4560, 321.2631],
        [401.1840, 183.2640, 512.0000, 366.5280]], device='cuda:0')
loss1: tensor([1.6574, 1.1039, 1.3755, 1.0000, 1.3805, 1.0000, 1.0000, 1.7052],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.2225, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[247.6407, 188.8069, 247.6407, 188.8069],
        [350.7614, 371.2703, 350.7614, 371.2703],
        [ 70.4579, 138.0355,  70.4579, 144.1120],
        [222.8811, 368.3349, 222.8811, 368.3349],
        [329.3941, 288.8535, 329.3941, 290.1527],
        [ 61.9584, 107.7672,  61.9584, 118.4114],
        [262.0305, 310.7481, 262.0305, 310.7481],
        [301.3216, 189.1705, 301.3216, 189.1705]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[212.5120,  85.7387, 375.6800, 506.2080],
        [163.8480, 247.5685, 324.1840, 390.0609],
        [142.2182, 363.6000, 261.0840, 476.6240],
        [ 38.9200, 138.0151, 129.9760, 421.2968],
        [242.0000, 359.3387, 512.0000, 506.0053],
        [ 46.5596, 156.2880, 275.9164, 504.9040],
        [ 76.0320, 179.2719, 284.6400, 469.8289],
        [353.4480, 173.9733, 511.1760, 489.9733]], device='cuda:0')
loss1: tensor([1.0000, 1.1422, 1.7919, 1.5050, 1.3246, 1.1222, 1.0000, 1.2484],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.1342, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[232.4576, 210.9907, 232.4576, 210.9907],
        [123.3943, 111.1815, 123.3943, 111.1815],
        [157.9333, 219.6643, 157.9333, 219.6643],
        [163.4825, 287.2039, 163.4825, 287.2039],
        [326.4440, 247.1429, 326.4440, 261.3925],
        [200.1238, 326.1612, 200.1238, 330.1949],
        [212.2817, 249.4417, 212.2817, 249.4417],
        [464.0953, 350.1038, 464.0953, 350.1038]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 98.4800, 247.7227, 512.0000, 494.9013],
        [191.7653,  86.2960, 512.0000, 438.3680],
        [144.9548, 271.4640, 304.7779, 428.9760],
        [  0.0000,   3.1804, 217.2000, 503.6152],
        [284.9840, 204.3413, 473.5440, 468.3734],
        [191.0080, 268.7439, 388.2880, 502.7705],
        [ 75.1282, 120.0080, 175.8354, 274.2240],
        [303.0080,  89.4022, 477.5440, 269.8852]], device='cuda:0')
loss1: tensor([1.1294, 1.1759, 1.2475, 1.0000, 1.0000, 1.0000, 1.2657, 1.3077],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.1262, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 99.8757, 180.7944,  99.8757, 182.5731],
        [193.5146, 135.5150, 193.5146, 135.5150],
        [354.6084, 329.6389, 354.6084, 329.6389],
        [220.2894, 201.4618, 220.2894, 201.4618],
        [256.5371, 313.7665, 256.5371, 313.7665],
        [422.5241, 216.8188, 422.5241, 235.7793],
        [294.2936, 460.6744, 294.2936, 460.6744],
        [ 82.6676, 169.5907,  82.6676, 176.9014]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[169.2160, 242.7653, 330.0560, 483.2362],
        [264.2160, 119.6590, 458.7360, 487.8423],
        [311.5680, 123.9631, 387.1520, 359.8066],
        [275.2717, 149.7298, 404.0089, 250.8800],
        [ 31.5440, 111.3518, 108.7040, 337.5124],
        [337.1044, 127.6988, 453.0974, 246.9647],
        [188.5910, 296.8480, 330.6645, 397.8160],
        [369.0320,  37.9723, 495.8640, 426.8634]], device='cuda:0')
loss1: tensor([1.4444, 1.2666, 1.0000, 1.2993, 1.6571, 1.0000, 1.3837, 1.6930],
       device='cuda:0', grad_fn=<RsubBackward1>)

  4%|█▎                             | 108/2600 [00:24<07:36,  5.46it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[155.3450, 117.5163, 155.3450, 117.5163],
        [ 99.7677, 124.6432,  99.7677, 124.6432],
        [213.3103, 107.2902, 213.3103, 123.8457],
        [256.9903, 344.3002, 256.9903, 344.3002],
        [285.1075, 217.6973, 285.1075, 217.6973],
        [113.4150, 158.6100, 113.4150, 158.6100],
        [534.7523, 523.8699, 534.7523, 523.8699],
        [136.7316, 258.5573, 136.7316, 293.0196]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[326.9280, 182.2613, 477.8720, 288.6933],
        [334.2400, 302.1547, 512.0000, 508.6827],
        [282.1520,  98.4853, 395.3200, 344.0213],
        [173.3734, 369.2271, 512.0000, 506.4021],
        [  0.0000,   2.0207, 173.3632, 504.7774],
        [102.8403,  90.5439, 167.8541, 361.3604],
        [  4.3280,   0.5760, 374.4880, 484.8960],
        [ 94.6400, 294.8307, 302.3920, 512.0000]], device='cuda:0')
loss1: tensor([1.7090, 1.7681, 1.3782, 1.1538, 1.3919, 1.0000, 1.3541, 1.1431],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.8983, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[269.0677, 180.2656, 269.0677, 188.4126],
        [287.4374, 422.6562, 287.4374, 422.6562],
        [249.1379, 166.5871, 249.1379, 166.5871],
        [120.7533, 278.5918, 120.7533, 278.5918],
        [285.7888, 269.3425, 285.7888, 269.3425],
        [319.7499, 251.2611, 319.7499, 251.2611],
        [217.0583, 298.8210, 217.0583, 298.8210],
        [145.3558, 149.9650, 145.3558, 149.9650]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[0.0000e+00, 0.0000e+00, 1.2919e+02, 1.2858e+02],
        [4.5728e+01, 1.7256e+00, 4.4173e+02, 5.0566e+02],
        [3.5941e+02, 1.4567e+02, 5.1200e+02, 4.8993e+02],
        [4.7963e-02, 3.2466e+02, 2.1811e+02, 3.9998e+02],
        [3.4155e+02, 1.8396e+02, 4.9859e+02, 4.0307e+02],
        [1.6370e+02, 1.0682e+02, 3.2479e+02, 4.2957e+02],
        [9.4056e+01, 2.3286e+02, 2.4275e+02, 4.5679e+02],
        [2.3588e+02, 8.6415e+00, 3.4463e+02, 1.9675e+02]], device='cuda:0')
loss1: tensor([1.6723, 1.0000, 1.4195, 1.3796, 1.2620, 1.0000, 1.0000, 1.4543],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.1877, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[363.3551, 263.4865, 363.3551, 263.4865],
        [293.8762, 365.1429, 293.8762, 365.1429],
        [198.7597, 276.5726, 198.7597, 276.5726],
        [188.2432, 120.8745, 188.2432, 121.6522],
        [103.2869, 198.6863, 103.2869, 214.5547],
        [245.5176, 318.2745, 245.5176, 318.2745],
        [136.2036, 112.4842, 136.2036, 112.4842],
        [307.2278, 328.9102, 307.2278, 328.9102]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  1.7200,   2.4000, 492.2400, 512.0000],
        [200.2880, 215.8056, 391.7360, 470.1548],
        [ 44.8240, 236.0729, 468.3120, 424.1547],
        [ 90.5067,  93.4800, 421.8773, 261.4640],
        [176.0400, 309.3977, 290.0000, 453.4823],
        [201.1008,   0.0000, 387.8272, 351.1296],
        [156.8293, 118.7723, 371.3171, 270.9919],
        [175.9373,  29.7663, 265.9388, 185.7171]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.6549, 1.0000, 1.1239, 1.6426],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.4214, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[291.9696, 222.4906, 291.9696, 222.4906],
        [172.1353, 253.4955, 172.1353, 253.4955],
        [185.3166, 319.2349, 185.3166, 319.2349],
        [147.8970, 307.6209, 147.8970, 307.6209],
        [211.6287, 247.4359, 211.6287, 247.4359],
        [366.7924, 235.9833, 366.7924, 237.7789],
        [287.7343, 348.7176, 287.7343, 348.7176],
        [245.3717, 176.4949, 245.3717, 176.4949]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[2.2441e+02, 3.7171e-01, 5.1200e+02, 5.0553e+02],
        [4.9872e+01, 3.0063e+02, 2.8676e+02, 4.2787e+02],
        [3.7760e+01, 5.2960e+01, 1.9638e+02, 3.0170e+02],
        [1.0376e+01, 5.5309e+01, 1.0118e+02, 4.2809e+02],
        [1.0518e+02, 2.5324e+02, 4.1786e+02, 4.7481e+02],
        [0.0000e+00, 1.6454e+02, 1.3434e+02, 5.1200e+02],
        [1.3353e+02, 2.3747e+02, 3.5248e+02, 4.4979e+02],
        [1.5557e+02, 2.1749e+02, 4.6440e+02, 3.2315e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.2703, 1.0659, 1.3397, 1.0255, 1.6338, 1.0000, 1.2796],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.6147, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[317.1409, 132.1807, 317.1409, 152.7468],
        [236.5102, 257.1830, 236.5102, 257.1830],
        [337.6496, 420.6282, 337.6496, 420.6282],
        [225.0790, 345.0200, 225.0790, 345.0200],
        [141.7790, 116.0345, 141.7790, 116.0345],
        [256.4122, 355.1449, 256.4122, 355.1449],
        [ 90.8188,  97.0800,  90.8188,  97.0800],
        [225.4277, 202.0972, 225.4277, 202.0972]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[357.0720,  82.4533, 442.8480, 293.8987],
        [  0.0000,  88.8506, 130.1680, 424.6483],
        [190.4160, 227.3067, 387.9680, 326.7520],
        [  0.0000, 310.9227, 253.5360, 476.7147],
        [ 41.3280, 300.7680, 509.7040, 506.2614],
        [307.6400,  11.9963, 512.0000, 146.6704],
        [  0.0000, 191.9679, 491.6560, 503.7202],
        [191.8501, 156.2560, 331.8527, 484.9040]], device='cuda:0')
loss1: tensor([1.3177, 1.4496, 1.4856, 1.0000, 1.4734, 1.6862, 1.2333, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.6458, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[215.5170, 177.2240, 215.5170, 177.2240],
        [356.2897, 188.1349, 356.2897, 188.1349],
        [371.1255, 368.2136, 371.1255, 368.2136],
        [272.5034, 356.5362, 272.5034, 356.5362],
        [113.8155, 193.0279, 113.8155, 200.1103],
        [266.9154, 298.6867, 266.9154, 298.6867],
        [101.6287, 242.4674, 101.6287, 242.4674],
        [184.1912, 224.6246, 184.1912, 224.6246]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 91.1253,   3.6480, 512.0000, 160.5680],
        [ 87.5360, 139.8400, 334.4480, 369.9626],
        [306.1200, 179.6916, 393.1600, 511.4125],
        [ 73.8044,  20.3600, 466.8748, 502.4400],
        [  0.0000, 252.7707,  99.6476, 431.0588],
        [ 69.2160, 172.0533, 177.9920, 401.6853],
        [ 75.8720, 366.5280, 512.0000, 511.6720],
        [  5.1680, 116.0853, 135.1760, 505.2480]], device='cuda:0')
loss1: tensor([1.0960, 1.0813, 1.0000, 1.0000, 1.3442, 1.4498, 1.4608, 1.2738],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.7059, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[362.8808, 197.0115, 362.8808, 197.0115],
        [183.8447, 286.7166, 183.8447, 286.7166],
        [305.5035, 449.6009, 305.5035, 462.9072],
        [233.2573, 293.1604, 233.2573, 293.1604],
        [ 94.3154, 101.1847,  94.3154, 101.1847],
        [159.5848, 134.0713, 159.5848, 134.0713],
        [214.5256, 375.4485, 214.5256, 375.4485],
        [244.0021, 120.4580, 244.0021, 135.9179]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[302.7354,  42.2400, 465.4285, 191.1808],
        [ 76.1680,  42.0871, 300.8240, 489.5176],
        [236.2880, 339.2960, 400.8640, 441.0240],
        [218.5690, 229.3760, 475.4063, 419.9120],
        [  0.7680,   6.8988, 352.2880, 407.3044],
        [ 44.5645, 104.8285, 286.3513, 323.3179],
        [ 50.8465,  80.5360, 273.5055, 500.4960],
        [  0.0000, 146.8334, 132.6640, 511.0745]], device='cuda:0')
loss1: tensor([1.0377, 1.0000, 1.1770, 1.0000, 1.0000, 1.0000, 1.0000, 1.4930],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.7077, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[141.7407, 196.6057, 141.7407, 196.6057],
        [286.7077, 381.5118, 286.7077, 381.5118],
        [ 57.7007,  46.6529,  57.7007,  52.9202],
        [212.3451, 263.1608, 212.3451, 263.1608],
        [380.3452, 268.7330, 380.3452, 268.7330],
        [270.2543, 198.4472, 270.2543, 203.6967],
        [245.3061, 240.2889, 245.3061, 240.2889],
        [209.6088, 367.3593, 209.6088, 372.5924]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[221.8640, 226.7957, 379.6000, 484.0966],
        [  0.0000, 214.0053, 460.8000, 505.0987],
        [205.2096, 138.1960, 306.2345, 512.0000],
        [ 57.5351,  45.2710, 173.1789, 234.9978],
        [198.6199,  23.0240, 512.0000, 334.7760],
        [ 58.7360,  55.7671, 215.8560, 512.0000],
        [ 61.3653,  59.8320, 441.8133, 512.0000],
        [125.9120, 382.3893, 328.4480, 512.0000]], device='cuda:0')
loss1: tensor([1.4065, 1.0000, 1.6735, 1.3495, 1.0000, 1.2572, 1.0000, 1.1039],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.7906, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[209.5968, 164.9281, 209.5968, 164.9281],
        [119.2629, 100.9144, 119.2629, 100.9144],
        [213.4895, 160.7797, 213.4895, 160.7797],
        [410.0127, 366.6798, 410.0127, 366.6798],
        [277.7162, 230.2599, 277.7162, 230.2599],
        [130.6392, 213.0032, 130.6392, 213.0032],
        [113.1155, 267.2965, 113.1155, 273.6660],
        [282.8586, 362.1075, 282.8586, 362.1075]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[182.0800, 157.6320, 317.5520, 379.6907],
        [117.9040,  69.1968, 203.2960, 317.0048],
        [226.3450,  88.2085, 302.0390, 275.7881],
        [172.5840, 194.4427, 437.5040, 406.1440],
        [190.0635,   9.4400, 403.7126, 101.7760],
        [ 65.0960, 266.5765, 230.5200, 487.4817],
        [  1.6080, 164.7360, 158.5680, 505.5253],
        [123.2877,  62.5040, 213.1335, 288.0320]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.1452, 1.0000, 1.5818, 1.1952, 1.0000, 1.5762],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.4984, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 60.9795,  89.9485,  60.9795,  97.7963],
        [122.2492,  99.4012, 122.2492,  99.4012],
        [225.5366, 324.7587, 225.5366, 324.7587],
        [183.3034, 399.1044, 183.3034, 410.9815],
        [298.7591, 283.6682, 298.7591, 283.6682],
        [533.6618, 465.7671, 533.6618, 465.7671],
        [153.4179, 125.5418, 153.4179, 125.5418],
        [142.9161, 175.3137, 142.9161, 175.3137]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[344.7587, 147.0240, 512.0000, 506.8080],
        [138.0640,   3.1040, 291.6640, 145.7707],
        [ 88.4531, 392.6046, 289.1981, 502.8145],
        [101.3280, 214.0807, 339.2960, 505.1773],
        [403.6000, 215.0629, 511.7680, 454.9143],
        [242.2579,  70.1829, 408.2381, 364.7314],
        [142.7840,  60.9844, 326.2480, 162.2333],
        [113.2710,  76.6566, 335.4962, 505.1802]], device='cuda:0')
loss1: tensor([1.6800, 1.0933, 1.3810, 1.0000, 1.4922, 1.5759, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.2224, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[341.8503, 353.5798, 341.8503, 353.5798],
        [ 83.0274, 140.2344,  83.0274, 143.7279],
        [275.6541, 322.6116, 275.6541, 322.6116],
        [251.0712, 504.1306, 251.0712, 504.1306],
        [136.9991, 249.6042, 136.9991, 257.1050],
        [378.6441, 153.9007, 378.6441, 153.9007],
        [115.4532,  47.4427, 115.4532,  58.6362],
        [ 78.7441,  58.0070,  78.7441,  58.0070]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[181.9280, 190.9988, 346.9760, 371.6257],
        [  0.7200,  25.3177, 279.7520, 512.0000],
        [202.2721, 157.6240, 343.0400, 316.8160],
        [  0.0000, 118.8386, 120.4122, 504.4088],
        [ 15.5504, 353.0400, 236.1913, 419.1040],
        [246.9680, 106.0931, 406.2240, 387.4653],
        [370.0080,  37.5896, 512.0000, 469.2260],
        [336.0320, 355.7858, 502.8560, 512.0000]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0351, 1.5204, 1.6102, 1.0000, 1.6419, 1.8647],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.6724, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[314.0530, 410.6239, 314.0530, 410.6239],
        [262.7432, 177.8641, 262.7432, 177.8641],
        [298.8955, 229.2170, 298.8955, 229.2170],
        [ 76.7637, 151.9181,  76.7637, 151.9181],
        [267.8456, 355.6053, 267.8456, 355.6053],
        [183.2411, 152.3664, 183.2411, 152.3664],
        [278.2918, 247.9418, 278.2918, 247.9418],
        [116.4576, 237.8925, 116.4576, 261.6329]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 77.0640, 309.2384, 206.4960, 422.7897],
        [ 92.8080, 189.8371, 170.0320, 471.7349],
        [ 87.3280, 227.8062, 412.1680, 333.6684],
        [400.6960,  93.9093, 511.0960, 237.8773],
        [371.6160, 121.8008, 511.9840, 330.0541],
        [ 90.2880, 297.8854, 222.1840, 448.1683],
        [213.4393,  25.1200, 378.0850, 164.3360],
        [ 28.9760, 278.4225, 164.2960, 390.5589]], device='cuda:0')
loss1: tensor([1.4538, 1.5641, 1.0000, 1.7458, 1.4879, 1.4919, 1.3752, 1.2655],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.3843, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[225.8812, 309.4829, 225.8812, 309.4829],
        [185.4255,  72.7414, 185.4255,  76.1050],
        [122.8183,  64.9591, 122.8183,  64.9591],
        [281.8030, 422.1115, 281.8030, 422.1115],
        [ 90.2161, 269.5532,  90.2161, 269.5532],
        [136.8519, 196.8124, 136.8519, 196.8124],
        [278.2840, 201.5381, 278.2840, 201.5381],
        [369.9858, 365.8932, 369.9858, 365.8932]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[116.4960, 172.5867, 221.7680, 418.8054],
        [358.4000,  95.1718, 512.0000, 443.3318],
        [178.9867, 124.8560, 293.2000, 321.0480],
        [  5.3040, 248.9749, 153.8080, 466.0589],
        [  0.0000, 151.7333, 196.1920, 457.3867],
        [  0.6720,  14.9619, 221.9520, 378.5369],
        [  0.0000,  75.9947, 295.4080, 504.7767],
        [303.1840, 252.1280, 379.0480, 431.0613]], device='cuda:0')
loss1: tensor([1.0376, 1.5581, 1.4864, 1.4629, 1.0000, 1.0000, 1.0000, 1.0000],

  5%|█▍                             | 118/2600 [00:26<08:15,  5.01it/s]
loss  tensor(9.5451, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[385.9810, 340.3096, 385.9810, 340.3096],
        [339.6562, 357.3400, 339.6562, 357.3400],
        [270.5289, 363.5616, 270.5289, 363.5616],
        [154.4382, 166.8951, 154.4382, 166.8951],
        [207.4337, 120.9597, 207.4337, 120.9597],
        [126.4818, 180.1064, 126.4818, 180.1064],
        [ 99.0845, 220.2627,  99.0845, 220.2627],
        [ 67.6733,  82.1585,  67.6733,  82.1585]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[8.9108e+01, 1.2680e+02, 3.4838e+02, 2.9964e+02],
        [1.8726e+02, 1.8834e+02, 5.1200e+02, 5.0014e+02],
        [3.9694e+02, 1.0711e-01, 5.0217e+02, 1.4902e+02],
        [1.1538e+02, 1.5741e+02, 1.9200e+02, 4.5933e+02],
        [2.3056e+01, 3.1241e+02, 1.6936e+02, 4.1237e+02],
        [3.0830e+02, 1.3346e+02, 5.1200e+02, 5.0625e+02],
        [3.6896e+01, 2.1710e+02, 1.3786e+02, 3.5415e+02],
        [2.4312e+02, 1.5409e+02, 5.1200e+02, 5.1200e+02]], device='cuda:0')
loss1: tensor([1.2930, 1.0000, 1.8139, 1.0000, 1.7278, 1.4716, 1.0000, 1.4961],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.8025, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[318.7107, 373.4041, 318.7107, 373.4041],
        [ 71.1369,  95.3599,  71.1369, 100.4355],
        [225.3362, 192.2667, 225.3362, 192.2667],
        [396.9649, 376.8586, 396.9649, 376.8586],
        [109.0305,  96.6946, 109.0305,  96.6946],
        [111.8973, 125.5269, 111.8973, 125.5269],
        [261.4973, 262.3460, 261.4973, 262.3460],
        [129.3440, 356.0886, 129.3440, 356.0886]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[220.9440, 333.9088, 510.5040, 457.2290],
        [163.3485, 242.4218, 306.6539, 393.8202],
        [105.0829, 167.5566, 207.5136, 438.8549],
        [213.8000, 217.6899, 284.9040, 471.9633],
        [276.7484, 312.2080, 437.6044, 405.1360],
        [348.7216,  61.5793, 453.5081, 218.5694],
        [172.6669,  32.0186, 508.0371, 501.4513],
        [ 62.1998, 201.3520, 339.6033, 425.7040]], device='cuda:0')
loss1: tensor([1.0000, 1.6913, 1.1482, 1.6118, 1.8525, 1.6933, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.9971, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[313.7982, 305.3735, 313.7982, 305.3735],
        [116.5601, 334.7080, 116.5601, 334.7080],
        [230.0683, 215.3542, 230.0683, 215.3542],
        [124.1534, 296.1071, 124.1534, 313.5300],
        [266.5864, 157.2567, 266.5864, 157.2567],
        [244.9650, 308.0358, 244.9650, 308.0358],
        [ 64.3750, 124.3475,  64.3750, 124.3475],
        [297.0973, 196.4395, 297.0973, 196.4395]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 32.2400,  85.9369, 377.6800, 408.1012],
        [  1.8080, 224.3733, 202.3920, 421.9520],
        [166.4560, 240.6187, 392.2400, 423.0080],
        [  0.0000, 202.5707, 354.6640, 505.1733],
        [  0.0000,   7.8848, 249.4191,  85.7088],
        [  1.6480, 169.2053,  80.7520, 499.9147],
        [  0.0000,   1.1520, 184.6640, 329.0560],
        [ 98.9867,  74.4858, 291.8673, 344.1459]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.1217, 1.0000, 1.5125, 1.6749, 1.0000, 1.0264],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.3355, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[127.9573, 195.1470, 127.9573, 195.1470],
        [152.8239, 150.9419, 152.8239, 150.9419],
        [189.7358, 409.7613, 189.7358, 409.7613],
        [237.1926, 216.2980, 237.1926, 216.2980],
        [ 69.3599,  38.4507,  69.3599,  40.9363],
        [349.9449, 297.9981, 349.9449, 297.9981],
        [114.5823, 153.5271, 114.5823, 153.5271],
        [252.7805, 263.9876, 252.7805, 263.9876]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[235.9147, 302.8240, 447.3920, 512.0000],
        [ 19.5593,  27.7200, 417.5495, 512.0000],
        [  0.0000, 245.3065,  72.7040, 512.0000],
        [163.0880, 199.6018, 276.8240, 427.3181],
        [274.8720, 232.9420, 461.0320, 356.4095],
        [418.9920, 310.0058, 512.0000, 452.6703],
        [ 42.9840, 142.9523, 462.8880, 435.2000],
        [101.2662,  38.5680, 232.3454, 512.0000]], device='cuda:0')
loss1: tensor([1.5629, 1.0000, 1.6168, 1.0000, 1.8154, 1.4706, 1.0000, 1.1349],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.6007, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 81.3794, 127.0456,  81.3794, 127.0456],
        [357.4031, 246.8580, 357.4031, 246.8580],
        [158.7817, 307.0785, 158.7817, 307.0785],
        [179.6040, 251.7451, 179.6040, 251.7451],
        [211.3022, 373.8227, 211.3022, 373.8227],
        [194.2846, 449.5499, 194.2846, 449.5499],
        [148.5906, 107.1981, 148.5906, 107.1981],
        [236.8400, 146.6931, 236.8400, 146.6931]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 46.4880, 187.5914, 208.8000, 370.7574],
        [  2.1040, 336.9222, 424.8800, 391.0017],
        [176.7520, 125.3120, 312.8800, 352.0960],
        [ 25.0430, 235.2320, 512.0000, 506.3680],
        [351.3412, 316.0576, 464.6912, 451.9321],
        [175.4640, 389.7209, 303.2160, 501.2072],
        [365.8160,   0.9813, 512.0000, 344.1173],
        [222.6320,  33.6533, 498.7680, 261.4613]], device='cuda:0')
loss1: tensor([1.2484, 1.6248, 1.1166, 1.0000, 1.5527, 1.0000, 1.5977, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.1403, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[270.4712, 570.9909, 270.4712, 570.9909],
        [177.0620, 101.2603, 177.0620, 101.2603],
        [ 77.7293,  57.2275,  77.7293,  57.2275],
        [148.7756, 126.6042, 148.7756, 126.6042],
        [339.8227, 173.3639, 339.8227, 176.9128],
        [197.3927, 291.3590, 197.3927, 291.3590],
        [140.4404, 307.4332, 140.4404, 307.4332],
        [114.7755, 164.7099, 114.7755, 164.7099]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 41.0720, 335.7154, 158.9680, 505.2416],
        [148.0560, 257.5787, 268.4080, 367.3707],
        [238.2320, 162.0764, 349.1520, 352.5974],
        [226.0581, 129.6640, 481.2022, 276.9360],
        [302.7600, 100.2279, 428.8000, 353.5187],
        [ 84.5619,  57.5215, 311.5110, 506.2519],
        [139.7920, 156.4800, 330.4960, 399.2427],
        [ 36.8213,  10.4320, 463.2960, 463.7520]], device='cuda:0')
loss1: tensor([1.6297, 1.5874, 1.7364, 1.2481, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.2016, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[270.4323, 471.6320, 270.4323, 471.6320],
        [100.6974,  94.1636, 100.6974,  94.1636],
        [ 96.4465, 168.0820,  96.4465, 168.0820],
        [ 97.2229,  94.1348,  97.2229,  94.1348],
        [267.3008, 248.8017, 267.3008, 248.8017],
        [116.0586, 236.3505, 116.0586, 236.3505],
        [286.1702, 324.1300, 286.1702, 324.1300],
        [224.5292, 198.1579, 224.5292, 198.1579]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[150.2880,   1.7237, 495.6480, 391.4949],
        [327.1360, 187.3820, 510.1840, 366.1302],
        [200.0400, 189.6918, 338.5200, 404.1802],
        [198.5600,  27.0880, 465.8347, 239.9200],
        [220.5760,  50.6476, 383.9440, 497.6810],
        [175.8080, 203.5798, 346.2400, 410.2101],
        [322.8960,  18.4074, 470.7280, 507.4005],
        [  2.5912,  52.0652, 380.3492, 209.6948]], device='cuda:0')
loss1: tensor([1.1705, 1.7062, 1.4803, 1.2749, 1.0000, 1.2596, 1.1990, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.0905, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[119.8332, 166.2528, 119.8332, 166.2528],
        [405.9631, 542.9772, 405.9631, 542.9772],
        [203.8264, 165.8054, 203.8264, 165.8054],
        [ 72.7836,  62.9095,  72.7836,  62.9095],
        [135.3471, 160.3710, 135.3471, 160.3710],
        [171.1733, 438.8470, 171.1733, 438.8470],
        [382.2374, 190.0102, 382.2374, 190.0102],
        [100.8492, 254.2337, 100.8492, 274.8403]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[234.5200, 267.4990, 357.5280, 455.8479],
        [110.9600, 297.8614, 275.4720, 480.5589],
        [  0.0000,   1.1511, 511.6320, 398.3528],
        [428.3280, 153.3639, 512.0000, 512.0000],
        [190.2720, 235.8187, 325.1920, 442.2293],
        [ 90.4246, 260.9050, 378.8908, 503.1219],
        [126.2800,  25.1345, 374.1920, 505.9372],
        [332.9760, 181.6213, 441.0800, 318.8480]], device='cuda:0')
loss1: tensor([1.6634, 1.5843, 1.0000, 1.8479, 1.4796, 1.0000, 1.0314, 1.6823],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.2889, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[214.0067, 284.8035, 214.0067, 284.8035],
        [ 96.7828, 143.9960,  96.7828, 143.9960],
        [183.1441, 293.0552, 183.1441, 293.0552],
        [122.9220, 201.2505, 122.9220, 201.2505],
        [112.3688, 234.7038, 112.3688, 234.7038],
        [414.9893, 267.2095, 414.9893, 269.4548],
        [261.3176, 324.8129, 261.3176, 324.8129],
        [ 60.8037,  89.6142,  60.8037,  90.7518]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[  0.0000,   2.0267, 110.9520, 192.7253],
        [403.8960,  41.5116, 500.7440, 360.0547],
        [ 82.4720, 344.8853, 188.9920, 502.9440],
        [214.0080, 157.6320, 361.5680, 281.8880],
        [ 32.2662,  28.6289, 203.8579, 397.4842],
        [ 24.0560, 221.1733, 367.6800, 415.8933],
        [199.5551, 169.8611, 359.9402, 318.0442],
        [ 41.3150,  96.7885, 366.0458, 279.9104]], device='cuda:0')
loss1: tensor([1.6504, 1.7603, 1.2469, 1.3817, 1.0000, 1.1210, 1.0437, 1.0377],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.2416, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[123.4236, 106.3340, 123.4236, 106.8074],
        [265.5041, 216.3592, 265.5041, 216.3592],
        [213.9576, 343.3042, 213.9576, 343.3042],
        [318.3291, 293.8622, 318.3291, 293.8622],
        [151.2950, 199.6710, 151.2950, 199.6710],
        [ 84.3954, 275.9067,  84.3954, 299.8500],
        [ 98.7873, 229.5175,  98.7873, 229.5175],
        [202.1795, 158.0482, 202.1795, 158.0482]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 90.8530,  96.0720, 472.7787, 450.2640],
        [182.5280, 118.3760, 335.2080, 366.3440],
        [ 32.5360, 145.1974, 133.5680, 506.1182],
        [365.7040, 322.8591, 437.2080, 512.0000],
        [198.4720,  77.0880, 415.0640, 292.2453],
        [ 16.1600, 172.4013, 202.3440, 407.6455],
        [ 84.7565, 173.5475, 236.1037, 506.8117],
        [ 27.9120,  31.2853, 301.0800, 203.8720]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.4431, 1.4785, 1.1789, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)

  5%|█▍                             | 125/2600 [00:27<08:34,  4.81it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[122.5879, 172.4106, 122.5879, 172.4106],
        [162.8545,  70.4496, 162.8545,  70.4496],
        [224.4936, 163.9181, 224.4936, 163.9181],
        [298.1976, 508.3905, 298.1976, 508.3905],
        [259.5367, 242.2448, 259.5367, 242.2448],
        [112.5729,  66.5231, 112.5729,  66.5231],
        [141.5736, 338.4394, 141.5736, 376.4428],
        [ 83.4994, 163.2033,  83.4994, 177.2434]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[201.5062, 164.6080, 291.1006, 314.7120],
        [224.5840, 287.3779, 493.3520, 506.4972],
        [190.2490, 226.7819, 430.4691, 399.7833],
        [ 11.1120, 373.4115, 181.1360, 512.0000],
        [ 37.4989,  40.8769, 506.1734, 512.0000],
        [321.0080, 159.9253, 467.7040, 340.5653],
        [ 84.8240, 363.5200, 218.0080, 502.5706],
        [125.0623,  44.2480, 509.7098, 503.1520]], device='cuda:0')
loss1: tensor([1.4683, 1.5913, 1.2665, 1.4078, 1.0000, 1.7277, 1.1528, 1.0975],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7120, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[261.4496, 423.3809, 261.4496, 423.3809],
        [238.2831, 246.8195, 238.2831, 246.8195],
        [ 62.4690,  60.8875,  62.4690,  63.3941],
        [ 89.9157, 166.7888,  89.9157, 168.6749],
        [329.8466, 494.4290, 329.8466, 494.4290],
        [307.4789, 280.3065, 307.4789, 280.3065],
        [ 76.1873,  47.3932,  76.1873,  49.2432],
        [ 72.8856,  47.4136,  72.8856,  47.4136]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[335.0560, 236.2652, 404.2320, 438.4691],
        [192.9044,  79.3907, 370.3109, 295.6902],
        [ 80.2898, 179.8800, 175.9638, 464.9200],
        [ 87.3173,  55.7200, 301.8027, 390.6400],
        [ 90.9200, 107.0020, 450.0240, 501.6395],
        [105.7213,   0.9119, 231.4541, 115.4593],
        [ 96.0080, 137.0405, 270.1920, 390.4528],
        [282.6320, 201.9087, 467.1280, 340.8234]], device='cuda:0')
loss1: tensor([1.5155, 1.0000, 1.4053, 1.0000, 1.0000, 1.7445, 1.3368, 1.7784],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7805, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[251.5000, 406.4549, 251.5000, 406.4549],
        [250.8660, 436.6630, 250.8660, 436.6630],
        [181.1148, 301.6374, 181.1148, 301.6374],
        [141.3883, 179.9449, 141.3883, 179.9449],
        [ 84.1704,  68.4306,  84.1704,  68.4306],
        [141.1651,  80.7642, 141.1651,  80.7642],
        [152.6427, 134.9156, 152.6427, 134.9156],
        [308.1779, 264.8293, 308.1779, 264.8293]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[186.7440, 310.0267, 354.1120, 404.1920],
        [  0.0000, 380.8320, 106.2989, 506.2480],
        [201.4720, 158.5600, 359.0320, 329.6000],
        [186.3920, 129.8240, 479.7840, 512.0000],
        [269.6080, 103.5031, 512.0000, 401.8900],
        [219.1770, 105.8543, 512.0000, 512.0000],
        [  0.0000, 230.6871, 209.5840, 476.3514],
        [237.7813, 188.2960, 342.2080, 335.5680]], device='cuda:0')
loss1: tensor([1.0235, 1.5763, 1.1144, 1.1330, 1.4930, 1.2563, 1.2805, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.8770, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[265.0986, 148.3651, 265.0986, 148.3651],
        [108.2998, 398.1431, 108.2998, 399.2570],
        [203.4097, 180.8222, 203.4097, 180.8222],
        [169.6272, 149.5828, 169.6272, 149.5828],
        [187.2398, 332.5109, 187.2398, 332.5109],
        [ 80.0857, 128.0693,  80.0857, 134.2128],
        [376.8069, 468.1420, 376.8069, 468.1420],
        [103.8169,  66.3177, 103.8169,  66.3177]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[214.3887, 199.8160, 499.2618, 410.0400],
        [  5.2640, 254.2700, 511.9920, 508.5488],
        [102.5520, 302.6795, 202.4480, 473.0185],
        [  0.0000, 101.9040, 170.0053, 187.3280],
        [ 25.7120, 141.2693, 296.9120, 460.8533],
        [ 22.6400, 153.2480, 456.2720, 359.9040],
        [158.7760, 111.2533, 511.7120, 504.7467],
        [ 33.9600, 172.2970, 211.0480, 399.4082]], device='cuda:0')
loss1: tensor([1.1966, 1.0000, 1.4226, 1.0000, 1.0000, 1.1086, 1.0000, 1.3182],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.0460, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[274.0708, 391.1080, 274.0708, 391.1080],
        [150.3164, 261.4754, 150.3164, 261.4754],
        [ 89.3166, 127.3138,  89.3166, 127.3138],
        [142.9539,  80.5686, 142.9539,  80.5686],
        [255.6214, 423.3332, 255.6214, 423.3332],
        [179.0275, 269.4252, 179.0275, 269.4252],
        [117.2214, 245.8461, 117.2214, 245.8461],
        [326.4568, 139.2367, 326.4568, 139.2367]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[202.0800, 258.9440, 366.1653, 422.0400],
        [  0.0000,  19.0578, 189.8480, 278.4995],
        [371.5360, 186.4663, 489.7520, 497.1196],
        [139.6720, 147.9499, 379.9040, 442.4162],
        [ 85.7120, 187.7013, 191.8160, 403.7014],
        [266.3680, 139.0314, 512.0000, 439.3248],
        [  0.0000, 182.5920, 416.8640, 512.0000],
        [230.3317,  55.9923, 429.9435, 223.6314]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.7520, 1.1862, 1.4276, 1.2623, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.6281, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[207.4177,  71.4217, 207.4177,  71.4217],
        [431.2443, 555.1945, 431.2443, 555.1945],
        [103.9951, 251.3411, 103.9951, 251.3411],
        [237.7670, 164.4527, 237.7670, 164.4527],
        [141.6504, 170.0565, 141.6504, 170.0565],
        [113.1016, 119.2878, 113.1016, 119.2878],
        [ 59.0073,  81.9356,  59.0073,  81.9356],
        [172.1342, 446.9777, 172.1342, 446.9777]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[339.9885, 143.6331, 512.0000, 507.2077],
        [332.3085,  48.8653, 431.0118, 393.4072],
        [131.5760,  50.5645, 273.2800, 252.8345],
        [256.1813, 192.1840, 485.5894, 346.7440],
        [  0.7760,   6.9055, 316.0400, 506.2415],
        [182.4720, 214.9549, 383.3200, 297.5438],
        [249.6719, 193.7101, 458.2457, 444.8973],
        [ 86.2246,  54.0800, 362.1411, 373.9360]], device='cuda:0')
loss1: tensor([1.5288, 1.3211, 1.1629, 1.2151, 1.0000, 1.6556, 1.6385, 1.1859],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(10.7080, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[193.6599, 442.6272, 193.6599, 453.2290],
        [260.8253, 360.4543, 260.8253, 360.4543],
        [162.6487,  86.2940, 162.6487,  86.2940],
        [164.9802, 170.8739, 164.9802, 170.8739],
        [174.9502, 246.4002, 174.9502, 246.4002],
        [237.1560, 326.3596, 237.1560, 326.3596],
        [146.2045, 161.3892, 146.2045, 161.3892],
        [202.2501, 194.4274, 202.2501, 194.4274]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 14.9168, 393.4960, 501.7506, 505.0960],
        [ 84.2158, 379.3203, 467.8149, 487.1168],
        [377.9600,   5.7493, 512.0000, 171.4347],
        [118.6880,  38.6347, 245.3920, 337.6747],
        [128.8560, 248.6613, 493.1040, 506.3787],
        [  0.0000,   0.0000, 207.0195, 353.8160],
        [391.6267, 322.1680, 511.3067, 510.3920],
        [  0.0000,   2.3211, 362.2298, 510.8395]], device='cuda:0')
loss1: tensor([1.0000, 1.1489, 1.6163, 1.0000, 1.0087, 1.1271, 1.8232, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.7242, device='cuda:0', grad_fn=<SumBackward0>)
  5%|█▌                             | 128/2600 [00:29<09:35,  4.29it/s]
Traceback (most recent call last):
  File "distil_model.py", line 575, in <module>
    outputs = bxfinder(similarity, bert_emb)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "distil_model.py", line 107, in forward
    bert_comp_emb = self.bert_compressor(bert_emb)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\nn\modules\container.py", line 217, in forward
    input = module(input)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\nn\modules\activation.py", line 777, in forward
    return F.leaky_relu(input, self.negative_slope, self.inplace)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\nn\functional.py", line 1630, in leaky_relu
    result = torch._C._nn.leaky_relu_(input, negative_slope)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\site-packages\torch\fx\traceback.py", line 41, in format_stack
    return traceback.format_list(traceback.extract_stack()[:-1])
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\traceback.py", line 211, in extract_stack
    stack = StackSummary.extract(walk_stack(f), limit=limit)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\traceback.py", line 362, in extract
    linecache.checkcache(filename)
  File "C:\Users\debryu\miniconda3\envs\pytorch\lib\linecache.py", line 74, in checkcache
    stat = os.stat(fullname)
KeyboardInterrupt
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 81.1322,  70.6796,  81.1322,  70.6796],
        [182.3012, 367.6588, 182.3012, 367.6588],
        [278.7747, 123.3169, 278.7747, 123.3169],
        [251.8081, 321.3875, 251.8081, 321.3875],
        [ 99.7719, 261.1716,  99.7719, 287.2119],
        [ 80.3914, 119.2347,  80.3914, 119.2347],
        [199.2887, 357.4184, 199.2887, 357.4184],
        [258.5954, 306.7865, 258.5954, 306.7865]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[258.6560,   1.4827, 387.3173, 127.4880],
        [ 99.7120, 199.1200, 274.6027, 502.8720],
        [215.1799,  43.8160, 450.5483, 505.0800],
        [270.3520,   1.0880, 510.5680, 498.1653],
        [ 20.2892, 214.6480, 224.2942, 378.5280],
        [ 94.4160, 139.2232, 346.9760, 472.8866],
        [  2.3120,  21.5088, 135.4240, 504.7507],
        [ 99.0240, 226.6000, 512.0000, 445.4500]], device='cuda:0')
loss1: tensor([1.5798, 1.0000, 1.0000, 1.0717, 1.0000, 1.1062, 1.3242, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.0818, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[221.3899,  92.8104, 221.3899,  92.8104],
        [113.6751, 101.1139, 113.6751, 101.1139],
        [190.3797, 374.3743, 190.3797, 374.3743],
        [192.8876, 354.2468, 192.8876, 354.2468],
        [166.3736, 201.8325, 166.3736, 201.8325],
        [220.8303, 476.6872, 220.8303, 476.6872],
        [220.8276, 259.0029, 220.8276, 259.0029],
        [249.3650, 165.0052, 249.3650, 165.0052]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[183.6640,  73.6372, 412.1040, 356.6697],
        [ 47.7867,  31.3760, 209.8842, 122.5760],
        [240.2720, 352.0689, 395.3360, 451.0156],
        [297.7040, 227.8827, 511.7120, 486.7627],
        [275.4773, 155.6880, 416.1600, 383.4160],
        [ 77.3520,   1.1538, 420.4480, 505.1012],
        [134.0160,  57.3840, 382.5680, 403.2960],
        [390.0400, 352.0747, 510.8480, 506.2507]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.2434, 1.3288, 1.4368, 1.0000, 1.0000, 1.7913],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(9.8002, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[198.8660, 245.3500, 198.8660, 245.3500],
        [165.8711, 156.4254, 165.8711, 156.4254],
        [139.2781, 145.8328, 139.2781, 145.8328],
        [108.5984, 326.0165, 108.5984, 357.7137],
        [280.5703, 345.5037, 280.5703, 345.5037],
        [109.1853, 232.6231, 109.1853, 232.6231],
        [249.2077, 430.3913, 249.2077, 430.3913],
        [335.0067, 192.3065, 335.0067, 192.3065]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 53.0480,  85.3360, 157.9840, 382.8480],
        [265.7760,   8.3413, 368.4640, 191.2853],
        [  0.7794,   0.0000, 221.6468, 141.3920],
        [120.0373, 129.9046, 320.2675, 487.0963],
        [206.1840, 100.1029, 397.8640, 455.6229],
        [ 13.2000, 191.2428,  98.7680, 510.9543],
        [ 16.1520, 134.9348, 280.0240, 505.9305],
        [321.5760, 158.4747, 470.0720, 337.5467]], device='cuda:0')
loss1: tensor([1.2804, 1.4931, 1.0305, 1.0540, 1.0000, 1.1085, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.9665, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])