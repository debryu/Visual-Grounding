
  0%|                                         | 0/2600 [00:00<?, ?it/s]
1
similarity shape  torch.Size([8, 1, 16, 16])

  0%|                                 | 6/2600 [00:05<18:09,  2.38it/s]
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 6.4404,  0.0000,  6.4404,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.3107],
        [ 0.0000,  8.8770,  1.5168,  8.8770],
        [ 0.0000,  0.0000,  0.0000,  2.3009],
        [ 0.0000,  0.0000, 10.7496, 12.9169],
        [ 0.0000,  0.0000,  0.9317,  0.0000],
        [ 0.0000, 10.9907,  0.0000, 10.9907],
        [ 0.0000,  0.0000,  0.0000, 10.7342]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 45.4640, 321.2441, 176.1360, 511.4976],
        [ 18.9840, 128.8640, 403.8480, 333.6640],
        [  0.0000, 294.6218, 512.0000, 502.8751],
        [217.5200, 173.2886, 444.2320, 505.0574],
        [135.4800,   0.0000, 511.7120, 509.6960],
        [202.5574, 272.9626, 327.9770, 382.4110],
        [  0.0000, 225.2800,  94.8480, 483.0906],
        [ 16.0563, 200.1259, 334.1107, 512.0000]], device='cuda:0')
loss1: tensor([1.7136, 1.4151, 1.5784, 1.6648, 1.2642, 1.8906, 1.4539, 1.4201],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.4007, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 4471.6860, 10393.7441,  5624.3613, 11210.3672],
        [ 7364.5269, 12944.6943,  9023.2012, 14520.3105],
        [ 7962.6821, 18375.4785,  9973.5059, 19857.1719],
        [13447.9941, 30761.4629, 16812.1270, 33273.8672],
        [ 8681.4932, 14083.8037, 10509.0527, 15888.9648],
        [ 7712.6333, 12476.2109,  9351.5469, 14095.8906],
        [ 2054.9717,  4858.1782,  2595.7383,  5244.6587],
        [11278.3613, 19262.7168, 13794.4316, 21692.2656]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[313.1680,  20.1795, 453.6320, 321.1538],
        [320.0560, 173.5455, 415.1600, 504.5029],
        [ 29.0880, 111.3520, 352.5120, 492.4861],
        [ 79.3300,   0.0000, 512.0000, 463.4880],
        [ 15.5360,   3.4560, 179.4880, 141.5147],
        [  0.0000, 146.1253, 509.9440, 287.6378],
        [111.1600, 302.1401, 245.7280, 463.6605],
        [341.7191, 106.8134, 512.0000, 278.2413]], device='cuda:0')
loss1: tensor([1.9835, 1.9788, 1.9842, 1.9845, 1.9801, 1.9791, 1.9812, 1.9788],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(15.8502, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[ 18695.5801,  20279.4219,  55021.5469,  72406.9062],
        [  3291.2429,   3701.6536,   9650.6660,  12841.5527],
        [ 22422.2773,  21782.3730,  63576.1758,  79164.1094],
        [  4381.1440,   5052.3120,  12742.9609,  17136.8223],
        [ 32471.5547,  31610.9668,  92520.9141, 115312.1250],
        [ 19713.4941,  21309.9785,  57944.4531,  76137.0781],
        [ 21080.4883,  22951.6699,  62150.5938,  81939.1719],
        [ 14898.2070,  14155.3193,  41850.0938,  51660.4023]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[369.3280, 109.3013, 432.3200, 423.4026],
        [407.9760, 222.8596, 512.0000, 379.9557],
        [300.8480,  98.5959, 429.3440, 503.5903],
        [  0.7360, 120.8296, 124.4160, 396.6861],
        [351.9600, 278.2400, 512.0000, 387.5428],
        [  0.0000, 248.3057, 129.4720, 356.7124],
        [ 56.0880,  18.4107, 475.4720, 434.9120],
        [301.6080,  19.5433, 511.6720, 450.3897]], device='cuda:0')
loss1: tensor([1.5208, 1.5015, 1.5280, 1.5338, 1.5259, 1.5233, 1.5237, 1.5288],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.1858, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000,  42379.4180,  54027.7773],
        [     0.0000,      0.0000,  57312.0078,  72666.2578],
        [     0.0000,      0.0000,  93927.1484, 117271.1484],
        [     0.0000,      0.0000,  82520.4453, 104811.9141],
        [     0.0000,      0.0000,  14070.1875,  17925.6270],
        [     0.0000,      0.0000, 140005.2500, 177943.6094],
        [     0.0000,      0.0000, 121847.2031, 151731.9844],
        [     0.0000,      0.0000,  83195.3594, 103841.7031]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[266.0640,  89.4366, 502.1920, 505.8269],
        [413.8773, 110.0720, 511.6160, 447.9680],
        [296.3760,  60.8213, 420.9360, 491.4880],
        [  1.5200,  56.3441, 249.4880, 428.5982],
        [  1.7267,   3.2560, 334.5506, 507.2080],
        [  1.4720,   2.4821, 120.4800, 299.7658],
        [351.0272, 142.3565, 477.7369, 248.0230],
        [  0.0000, 165.0391, 313.4720, 274.6694]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9993, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(7.9993, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000, 186688.5781, 237181.6875],
        [     0.0000,      0.0000, 141294.2812, 179226.2188],
        [     0.0000,      0.0000,  60482.2031,  75351.3359],
        [     0.0000,      0.0000, 103716.8281, 129777.7656],
        [     0.0000,      0.0000, 117579.3125, 146490.0312],
        [     0.0000,      0.0000, 222318.2969, 276370.5938],
        [     0.0000,      0.0000, 192841.8438, 244525.0156],
        [     0.0000,      0.0000, 107116.1562, 133150.4375]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 75.2160, 187.5627, 146.8960, 382.7947],
        [  1.8960,  74.5920, 456.0560, 504.4160],
        [107.5200, 206.0053, 214.1360, 424.0533],
        [  2.1514, 303.2000, 140.5717, 457.0480],
        [288.3040,   0.0000, 365.1200, 188.4693],
        [152.6880,   0.0000, 265.4240, 131.6800],
        [289.3520, 214.4299, 507.0560, 402.9488],
        [369.7360, 199.1780, 493.6450, 344.6714]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000, 163968.2031, 207055.4844],
        [     0.0000,      0.0000, 270135.9375, 334023.3125],
        [     0.0000,      0.0000,  37621.6875,  47351.9531],
        [     0.0000,      0.0000, 250650.6250, 317440.0625],
        [     0.0000,      0.0000, 184748.5156, 233561.3594],
        [     0.0000,      0.0000,  86842.6562, 107763.7109],
        [     0.0000,      0.0000,  51965.7852,  66409.7891],
        [     0.0000,      0.0000, 451563.9375, 559619.8125]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[295.3728, 207.8136, 409.8048, 362.2285],
        [ 91.4160, 315.6174, 382.4960, 505.5131],
        [201.4320, 303.2107, 296.8560, 500.1067],
        [123.7973, 243.5280, 334.2614, 450.4560],
        [199.3360, 158.7733, 346.8960, 401.5467],
        [228.3920, 201.9103, 327.1680, 413.2691],
        [ 38.6560, 158.1760, 175.2480, 295.6266],
        [258.6960, 142.6646, 372.3040, 261.1800]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)

  1%|▏                               | 20/2600 [00:07<06:24,  6.71it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000,  24418.8945,  30815.5176],
        [     0.0000,      0.0000,  74660.6797,  91966.1094],
        [     0.0000,      0.0000,  17051.6035,  21439.0527],
        [     0.0000,      0.0000, 434031.7500, 534187.4375],
        [     0.0000,      0.0000, 507957.5938, 639744.7500],
        [     0.0000,      0.0000, 461381.2500, 567023.6875],
        [     0.0000,      0.0000, 178240.6719, 223671.0469],
        [     0.0000,      0.0000,  63305.3164,  80593.2109]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[104.6400, 102.4000, 226.2160, 406.1428],
        [  2.5920,   2.3040, 392.6320, 505.0987],
        [117.2564, 313.2880, 264.6572, 504.1840],
        [ 93.7200, 347.3806, 198.5040, 512.0000],
        [ 78.9602,  25.3120, 512.0000, 501.6480],
        [394.8400, 105.0619, 496.8720, 440.1881],
        [212.1143, 187.3520, 379.3836, 465.7840],
        [  0.0000,  79.7973, 166.6560, 512.0000]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(7.9998, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000, 430217.2188, 539226.8750],
        [     0.0000,      0.0000, 620347.2500, 764417.4375],
        [     0.0000,      0.0000, 433953.7812, 547215.6875],
        [     0.0000,      0.0000, 451352.2812, 553995.5625],
        [     0.0000,      0.0000,  98465.3047, 123199.6250],
        [     0.0000,      0.0000,  76288.9531,  93969.1719],
        [     0.0000,      0.0000, 291366.9062, 369525.3438],
        [     0.0000,      0.0000, 194730.3594, 240215.9688]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[2.3444e+02, 6.2277e+01, 5.1078e+02, 5.1137e+02],
        [2.8526e+02, 4.4340e-01, 4.6210e+02, 1.9617e+02],
        [4.2968e+01, 1.2851e+02, 4.8552e+02, 4.3802e+02],
        [7.6000e+01, 1.2196e+02, 1.5660e+02, 3.0835e+02],
        [2.1698e+02, 2.0860e+02, 3.4348e+02, 3.6286e+02],
        [1.7147e+00, 7.5768e+01, 3.0972e+02, 5.0511e+02],
        [1.0463e+02, 2.0238e+02, 2.8082e+02, 5.1200e+02],
        [0.0000e+00, 6.4000e-01, 3.0642e+02, 5.1188e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000, 254363.7656, 321406.7188],
        [     0.0000,      0.0000, 738315.0625, 911384.1250],
        [     0.0000,      0.0000,  38907.8398,  49067.3320],
        [     0.0000,      0.0000, 434153.9062, 549669.3125],
        [     0.0000,      0.0000, 214255.2656, 264320.6875],
        [     0.0000,      0.0000, 624876.3125, 787495.5000],
        [     0.0000,      0.0000, 501321.5938, 617277.8750],
        [     0.0000,      0.0000, 245664.2031, 300592.1562]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 29.9440, 210.6282, 271.9840, 417.7300],
        [  0.0000, 352.0720, 191.8678, 493.5920],
        [246.0808, 263.9280, 484.3547, 383.6640],
        [108.9760, 377.6533, 253.4080, 506.8160],
        [ 70.9734,  55.9650, 284.9075, 465.4831],
        [111.8026, 177.8080, 368.0179, 400.4720],
        [  0.0000,   1.9545, 493.5920, 410.4034],
        [ 78.1005, 146.9781, 174.8480, 316.5662]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  141487.3906,  179620.6406],
        [      0.0000,       0.0000,  568585.4375,  720802.8125],
        [      0.0000,       0.0000,  251813.4844,  318352.4375],
        [      0.0000,       0.0000,  849305.6250, 1046997.9375],
        [      0.0000,       0.0000,  845481.3750, 1039988.9375],
        [      0.0000,       0.0000,  521723.5938,  660462.3125],
        [      0.0000,       0.0000,   30038.3652,   37452.5078],
        [      0.0000,       0.0000,  203969.5938,  248989.8438]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  9.9760, 216.3110, 166.5760, 378.5323],
        [  6.2240,  84.7934, 429.6880, 472.5299],
        [ 44.5680, 273.1466, 261.7120, 512.0000],
        [ 16.1046, 415.3558, 438.3624, 493.5948],
        [395.2160,  87.5200, 512.0000, 382.0587],
        [348.0404, 239.9280, 512.0000, 389.8560],
        [263.2000, 283.1059, 348.8000, 505.9765],
        [185.8400,  89.8578, 512.0000, 336.0375]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  151224.8438,  194734.5781],
        [      0.0000,       0.0000,  764760.8125,  942661.7500],
        [      0.0000,       0.0000, 1045059.1250, 1289143.0000],
        [      0.0000,       0.0000,  535395.6875,  662169.9375],
        [      0.0000,       0.0000,  585593.0625,  740804.4375],
        [      0.0000,       0.0000,  588465.8125,  744951.0000],
        [      0.0000,       0.0000,  237178.5625,  301909.4375],
        [      0.0000,       0.0000,  288122.0000,  365804.7500]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[170.2827, 123.4560, 342.1120, 245.3600],
        [285.5280, 142.4823, 373.6720, 466.2126],
        [  0.0000, 146.1790,  39.9760, 512.0000],
        [  0.0000,  23.6432, 328.2560, 506.8135],
        [118.9990,  94.0358, 435.5891, 158.1819],
        [121.7280,  89.2583, 240.5840, 294.3580],
        [  0.0000, 170.2821, 512.0000, 507.3968],
        [366.2400,  56.3753, 480.2720, 505.0996]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  599392.2500,  760028.9375],
        [      0.0000,       0.0000,  635117.3125,  783770.0000],
        [      0.0000,       0.0000, 1011376.4375, 1254756.6250],
        [      0.0000,       0.0000,  373715.1250,  475741.2812],
        [      0.0000,       0.0000,   39544.3945,   51247.1914],
        [      0.0000,       0.0000,  882470.5625, 1089298.7500],
        [      0.0000,       0.0000,  750515.9375,  952713.1250],
        [      0.0000,       0.0000,  288118.2500,  367628.1250]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[219.6720, 131.4560, 374.4880, 509.6960],
        [ 19.7653,   0.0000, 159.8827, 269.4720],
        [  0.0000, 294.2243,  96.4434, 512.0000],
        [  0.0000,  82.4480,  63.4352, 373.0480],
        [ 28.6277,  89.8240, 277.0708, 367.1680],
        [264.0720, 117.3044, 350.0160, 306.7084],
        [164.7158, 108.1520, 431.1579, 436.0640],
        [ 28.2010,  69.3862, 252.9587, 403.3468]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  446134.0312,  569204.7500],
        [      0.0000,       0.0000,   95955.4062,  123208.2578],
        [      0.0000,       0.0000, 1799548.3750, 2227187.5000],
        [      0.0000,       0.0000,  783667.6875,  997888.0625],
        [      0.0000,       0.0000,  139525.5156,  176196.8281],
        [      0.0000,       0.0000,  108118.0625,  142714.7188],
        [      0.0000,       0.0000,  178341.7031,  231759.0000],
        [      0.0000,       0.0000,  404606.3125,  505074.4062]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[217.7331,  65.4541, 443.3818, 330.4243],
        [107.8640, 173.7387, 349.4800, 503.9467],
        [113.7040,  69.0354, 181.9360, 338.2673],
        [  6.5638, 314.4363, 216.4736, 502.1013],
        [233.2672, 232.4150, 511.4675, 505.0963],
        [  0.0000, 214.2126, 212.9280, 512.0000],
        [ 65.2321, 167.5440, 357.0602, 282.3440],
        [110.8400, 368.2667, 265.2480, 512.0000]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  807250.8125, 1034317.8125],
        [      0.0000,       0.0000,  227993.5781,  296669.0938],
        [      0.0000,       0.0000,  734876.0000,  915361.8750],
        [      0.0000,       0.0000, 1359590.6250, 1687598.6250],
        [      0.0000,       0.0000, 1002236.0000, 1283096.5000],
        [      0.0000,       0.0000,  392255.4375,  500308.9688],
        [      0.0000,       0.0000,  280330.9688,  349335.9062],
        [      0.0000,       0.0000,  163940.8438,  203949.5625]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 74.7840, 188.6960, 512.0000, 512.0000],
        [ 59.3306, 292.2632, 309.8419, 510.0203],
        [162.7840, 275.2320, 443.9760, 370.4533],
        [382.2880,  83.9944, 512.0000, 424.5523],
        [189.3600,  13.8494, 261.6880, 485.1969],
        [100.2727,  66.3040, 244.3778, 245.6000],
        [  0.7360, 265.3767, 167.1200, 479.4454],
        [ 73.0000, 192.6080, 207.1680, 355.2427]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  932229.1875, 1166033.0000],
        [      0.0000,       0.0000,  115201.7500,  148397.3750],
        [      0.0000,       0.0000,  407385.3438,  511559.6875],
        [      0.0000,       0.0000, 1274997.7500, 1589390.7500],
        [      0.0000,       0.0000,  189257.2031,  244308.6406],
        [      0.0000,       0.0000, 1104972.2500, 1414488.3750],
        [      0.0000,       0.0000,   89880.8828,  114294.9531],
        [      0.0000,       0.0000,  983703.3125, 1260670.1250]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.5120, 156.8451, 217.0880, 432.6761],
        [ 58.8616,  19.5610, 324.2391, 506.2455],
        [135.3840,  88.7760, 244.2000, 217.3200],
        [  0.0000, 189.8477, 118.9840, 306.0489],
        [  0.0000, 256.0000, 226.8880, 486.2794],
        [229.9813, 188.8160, 351.2344, 433.1840],
        [  1.8560, 112.3129, 429.8320, 512.0000],
        [127.9440, 185.2400, 358.9760, 433.7600]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1460099.3750, 1824784.2500],
        [      0.0000,       0.0000,  524095.0625,  658086.6250],
        [      0.0000,       0.0000,  391713.5312,  492905.7500],
        [      0.0000,       0.0000,  781326.3750,  980298.2500],
        [      0.0000,       0.0000,  946336.3125, 1212694.5000],
        [      0.0000,       0.0000,  945903.9375, 1223903.2500],
        [      0.0000,       0.0000,  697658.9375,  903317.5000],
        [      0.0000,       0.0000,   88576.9297,  114672.1875]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 25.8400,  41.1413, 210.6800, 509.9520],
        [ 73.0960,   1.1484, 181.5840, 459.0774],
        [212.6400, 139.2232, 432.1840, 503.9423],
        [187.8733, 176.1157, 292.7513, 512.0000],
        [267.1360, 204.9307, 394.7287, 361.3958],
        [166.9360,  28.9574, 316.0960, 260.6284],
        [254.2080, 391.5032, 425.4720, 503.3590],
        [  0.0000, 350.3309, 166.0109, 512.0000]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1701034.1250, 2134804.5000],
        [      0.0000,       0.0000,  942565.3750, 1177000.0000],
        [      0.0000,       0.0000,  492702.6875,  636563.3750],
        [      0.0000,       0.0000, 1218597.2500, 1578096.2500],
        [      0.0000,       0.0000,  174841.2188,  226887.0469],
        [      0.0000,       0.0000,  587473.0625,  762744.5000],
        [      0.0000,       0.0000,   77345.7344,  102146.9375],
        [      0.0000,       0.0000,  388986.7500,  510249.6250]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[3.3902e+02, 2.5658e+02, 4.9643e+02, 4.4339e+02],
        [3.6242e+02, 5.1680e+01, 5.1200e+02, 4.3537e+02],
        [2.0552e+01, 2.4111e+02, 4.9205e+02, 4.6151e+02],
        [8.6400e-01, 1.0217e+02, 1.7047e+02, 4.9248e+02],
        [1.0027e+00, 1.7698e+02, 4.9046e+02, 5.1200e+02],
        [1.3510e+02, 1.2656e+02, 4.3526e+02, 3.4172e+02],
        [4.1296e+01, 2.7517e+02, 1.1946e+02, 4.8978e+02],
        [2.2091e+01, 1.6800e-01, 2.8672e+02, 3.1794e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1858842.7500, 2343314.2500],
        [      0.0000,       0.0000,  174303.4375,  230957.8125],
        [      0.0000,       0.0000,  331356.9062,  434781.9375],
        [      0.0000,       0.0000, 1059004.7500, 1326463.6250],
        [      0.0000,       0.0000,  420866.5000,  534208.3125],
        [      0.0000,       0.0000,  550029.6875,  715725.6250],
        [      0.0000,       0.0000,  230160.1875,  302358.0312],
        [      0.0000,       0.0000, 1264528.8750, 1640857.2500]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[384.0000, 242.7733, 511.7120, 497.0453],
        [166.3440,  61.8667, 317.1840, 504.5333],
        [113.5253,  33.3680, 323.6907, 465.9760],
        [  0.0000,   2.3760, 454.0907, 390.1200],
        [212.6400,  70.3479, 389.4400, 512.0000],
        [ 57.6819, 117.0910, 512.0000, 506.2656],
        [ 88.8480, 207.7257, 179.9920, 371.8895],
        [160.5837,   8.9975, 386.3245, 305.8483]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  591498.1250,  754947.5000],
        [      0.0000,       0.0000,  982525.5000, 1241831.3750],
        [      0.0000,       0.0000,  258955.9844,  346593.2812],
        [      0.0000,       0.0000, 1847678.0000, 2321269.0000],
        [      0.0000,       0.0000,  219602.3906,  288670.9688],
        [      0.0000,       0.0000,  411756.4375,  538233.8125],
        [      0.0000,       0.0000, 1487494.5000, 1935029.2500],
        [      0.0000,       0.0000,  261289.2812,  343802.8438]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 19.9460,  51.8668, 278.2771, 418.9132],
        [132.0640, 156.5444, 303.4960, 281.0233],
        [  0.0000,   5.1923, 203.6960, 506.8077],
        [257.4800,   2.5901, 443.1440, 243.0615],
        [ 93.7600,   3.9929, 511.1040, 511.7722],
        [ 70.1440, 222.5120, 460.5440, 306.5520],
        [179.4458, 118.7840, 445.3010, 340.0160],
        [ 61.9280,  92.8287, 247.7200, 505.6624]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  599205.9375,  790238.0625],
        [      0.0000,       0.0000,  871107.5625, 1136587.6250],
        [      0.0000,       0.0000, 1680530.0000, 2125244.0000],
        [      0.0000,       0.0000,  671202.1250,  883470.5000],
        [      0.0000,       0.0000,  671124.1875,  881474.7500],
        [      0.0000,       0.0000,  190022.7344,  254376.0625],
        [      0.0000,       0.0000,  635592.3125,  806850.4375],
        [      0.0000,       0.0000, 1645688.8750, 2081548.1250]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[279.1936, 174.2165, 345.3440, 451.4065],
        [167.8960,  30.9333, 504.5360, 355.8187],
        [155.2800, 112.9989, 279.5120, 290.6318],
        [130.9600,  68.8436, 243.5360, 390.9949],
        [106.7280,   9.8014, 503.8080, 506.8086],
        [  3.3075, 125.4707, 217.9174, 473.6512],
        [269.4320,  73.2635, 460.2800, 336.4949],
        [  0.7680,   1.2321, 293.1520, 187.6217]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  964503.6875, 1238273.8750],
        [      0.0000,       0.0000,  510083.5000,  650701.7500],
        [      0.0000,       0.0000, 1586983.6250, 2007670.3750],
        [      0.0000,       0.0000,   35732.9336,   49397.7773],
        [      0.0000,       0.0000,   69033.6562,   95979.9062],
        [      0.0000,       0.0000,  136330.6719,  183195.4844],
        [      0.0000,       0.0000,  481500.5625,  631384.6875],
        [      0.0000,       0.0000, 1862109.1250, 2444784.0000]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  7.8080, 368.6760, 134.8800, 484.1338],
        [191.5699,   1.1469, 333.0867, 335.9676],
        [  1.0000,   3.9893, 111.7120, 192.8320],
        [246.0320, 216.7705, 512.0000, 505.3524],
        [422.6662, 302.0502, 495.7082, 492.4428],
        [  1.7220,   2.3040, 512.0000, 503.9411],
        [ 13.3400,  53.5200, 482.1700, 480.9120],
        [ 32.2133,  13.8080, 493.9733, 505.0960]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)

  1%|▍                               | 34/2600 [00:09<06:25,  6.66it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  474388.6875,  631408.0000],
        [      0.0000,       0.0000,  854061.4375, 1127953.1250],
        [      0.0000,       0.0000,  780811.2500, 1031716.8125],
        [      0.0000,       0.0000, 1077225.8750, 1426506.5000],
        [      0.0000,       0.0000,  189629.7031,  248562.7344],
        [      0.0000,       0.0000,  858869.6250, 1113200.1250],
        [      0.0000,       0.0000, 1830729.8750, 2318608.7500],
        [      0.0000,       0.0000, 1211967.0000, 1553285.5000]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 39.3360,  71.1429, 458.1120, 456.5870],
        [215.4640, 165.6772, 361.2400, 495.8971],
        [  0.0000, 178.1653,  88.2160, 366.1227],
        [159.0613, 189.1360, 391.0400, 421.6160],
        [278.2240, 180.6370, 512.0000, 506.2521],
        [  0.0000, 253.5200, 415.7653, 512.0000],
        [200.9600,   0.0000, 501.6427, 261.1760],
        [271.3600, 338.6388, 408.4080, 480.9151]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1021062.6875, 1322511.5000],
        [      0.0000,       0.0000,  638961.8750,  819917.8125],
        [      0.0000,       0.0000,  277477.9062,  375722.5938],
        [      0.0000,       0.0000,  904926.8125, 1166441.2500],
        [      0.0000,       0.0000, 1540298.2500, 2045416.0000],
        [      0.0000,       0.0000,  705528.1250,  911642.5000],
        [      0.0000,       0.0000,  669951.7500,  859093.6250],
        [      0.0000,       0.0000, 1299820.1250, 1728688.5000]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[284.9920, 227.8822, 420.2240, 406.2268],
        [159.7440,  54.7825, 286.4640, 165.4698],
        [193.1280, 161.0766, 511.6800, 506.2460],
        [249.8048,  58.9646, 512.0000, 512.0000],
        [128.5734, 131.2222, 509.1431, 512.0000],
        [202.7600, 146.1253, 294.9920, 334.8166],
        [388.1040,  35.5093, 512.0000, 224.8000],
        [228.2640,  19.0325, 350.8800, 246.2026]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1056837.3750, 1368603.1250],
        [      0.0000,       0.0000,  141842.4688,  199487.3594],
        [      0.0000,       0.0000,  939582.6250, 1254685.0000],
        [      0.0000,       0.0000, 1767284.8750, 2271449.7500],
        [      0.0000,       0.0000,  312772.5938,  422557.7500],
        [      0.0000,       0.0000,  449204.6562,  608695.2500],
        [      0.0000,       0.0000, 1278327.0000, 1708106.8750],
        [      0.0000,       0.0000, 1320853.3750, 1700209.8750]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[220.9440, 333.9088, 510.5040, 457.2290],
        [163.3485, 242.4218, 306.6539, 393.8202],
        [105.0829, 167.5566, 207.5136, 438.8549],
        [213.8000, 217.6899, 284.9040, 471.9633],
        [276.7484, 312.2080, 437.6044, 405.1360],
        [348.7216,  61.5793, 453.5081, 218.5694],
        [172.6669,  32.0186, 508.0371, 501.4513],
        [ 62.1998, 201.3520, 339.6033, 425.7040]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1433323.1250, 1846178.1250],
        [      0.0000,       0.0000,  563108.1250,  764311.2500],
        [      0.0000,       0.0000,  392305.3750,  518048.1562],
        [      0.0000,       0.0000,  138373.0938,  195684.2969],
        [      0.0000,       0.0000, 1028463.2500, 1331408.0000],
        [      0.0000,       0.0000, 1189365.2500, 1539300.8750],
        [      0.0000,       0.0000, 1684212.5000, 2264712.5000],
        [      0.0000,       0.0000,  733310.1250,  989148.3125]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[304.0400,  98.7583, 430.4000, 326.5623],
        [242.8006, 285.3820, 512.0000, 466.7665],
        [290.6320, 123.7785, 512.0000, 302.2892],
        [297.2160, 192.7280, 452.0107, 406.3520],
        [162.6522, 113.9092, 334.6227, 447.5697],
        [  0.0000, 323.1162, 162.6400, 506.0528],
        [145.8640, 131.8684, 252.6240, 306.2044],
        [187.4453, 187.7680, 263.4026, 374.5200]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1439732.2500, 1941719.1250],
        [      0.0000,       0.0000,  136040.8125,  183176.3906],
        [      0.0000,       0.0000,  348380.1562,  448711.9062],
        [      0.0000,       0.0000,  915279.1875, 1186413.8750],
        [      0.0000,       0.0000, 1357476.6250, 1846712.6250],
        [      0.0000,       0.0000,  600742.1875,  806172.6250],
        [      0.0000,       0.0000,   72517.5625,  106984.0781],
        [      0.0000,       0.0000, 1760386.0000, 2275015.2500]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.8480,   8.0533, 216.3120, 511.5200],
        [208.7040, 203.5349, 387.2560, 505.6627],
        [285.6288,  11.0240, 450.7998, 144.1840],
        [321.7280,   0.5760, 510.2720, 106.6667],
        [  1.4827,  72.8960, 204.9600, 341.0000],
        [ 83.7187, 286.1427, 225.7652, 446.1093],
        [253.9688, 377.2960, 474.5615, 512.0000],
        [284.2624,  86.4393, 380.0064, 228.7343]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  870622.1875, 1181297.8750],
        [      0.0000,       0.0000,  286419.7500,  388561.8438],
        [      0.0000,       0.0000,  618317.0000,  858773.8750],
        [      0.0000,       0.0000, 1024609.0625, 1328672.0000],
        [      0.0000,       0.0000,  521432.5938,  708456.8125],
        [      0.0000,       0.0000, 2349841.0000, 3047996.7500],
        [      0.0000,       0.0000, 1140680.5000, 1567138.5000],
        [      0.0000,       0.0000,  135052.5000,  185702.8281]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[248.4224,  94.9527, 512.0000, 378.7869],
        [204.2240, 142.1457, 392.3440, 338.0076],
        [ 36.2400, 119.6587, 207.1040, 279.5840],
        [207.7280,  21.1290, 423.0240, 138.1559],
        [204.5120, 227.6124, 352.0720, 399.0471],
        [  0.0000,  47.1759, 130.0162, 207.1007],
        [141.3141,  47.1920, 511.4184, 511.4880],
        [409.1600, 175.7547, 508.1680, 370.4107]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,  607216.8125,  830650.3750],
        [      0.0000,       0.0000, 2114777.5000, 2752917.0000],
        [      0.0000,       0.0000,  747345.2500,  976919.7500],
        [      0.0000,       0.0000,  186688.6094,  264880.3125],
        [      0.0000,       0.0000,  838295.2500, 1118074.0000],
        [      0.0000,       0.0000,    5966.8477,   18441.4219],
        [      0.0000,       0.0000, 1174195.0000, 1600066.8750],
        [      0.0000,       0.0000, 1290175.5000, 1760387.5000]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.0000,  99.0080, 512.0000, 512.0000],
        [326.0800, 249.3748, 444.8080, 399.9644],
        [ 45.8240,   4.4745, 111.5680, 222.4945],
        [ 33.9280, 159.1996, 287.6240, 505.9327],
        [ 59.2640, 152.5227, 244.6880, 502.1547],
        [  0.0000, 212.9968,  97.1120, 466.8334],
        [  0.0000, 144.7760,  63.8694, 503.7520],
        [258.4800,   1.3341, 512.0000, 224.7512]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(7.9998, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,   87235.7422,  144835.2188],
        [      0.0000,       0.0000,  661955.0625, 1012020.7500],
        [      0.0000,       0.0000,  597880.4375,  883380.2500],
        [      0.0000,       0.0000,  897920.5625, 1242529.3750],
        [      0.0000,       0.0000,  902338.9375, 1355386.0000],
        [      0.0000,       0.0000,  238294.0938,  341852.5312],
        [      0.0000,       0.0000,  146704.5625,  229356.6250],
        [      0.0000,       0.0000, 2329268.2500, 3213478.5000]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[1.6938e+02, 2.5609e+02, 3.1781e+02, 4.1101e+02],
        [7.6104e+01, 1.9892e+02, 2.6465e+02, 3.4998e+02],
        [1.9682e+02, 3.1410e+02, 4.9780e+02, 5.0510e+02],
        [6.3712e+01, 7.1944e-02, 2.7635e+02, 5.0403e+02],
        [1.8751e+02, 1.2426e+02, 2.6298e+02, 4.7978e+02],
        [2.9811e+02, 2.3590e+02, 4.5556e+02, 4.1071e+02],
        [7.8696e+01, 1.4152e+02, 4.2099e+02, 4.3491e+02],
        [1.3461e+00, 3.5416e+01, 4.1133e+02, 5.1144e+02]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1535226.8750, 2272107.2500],
        [      0.0000,       0.0000, 1227142.2500, 2018391.0000],
        [      0.0000,       0.0000,   47297.2148,   84157.1016],
        [      0.0000,       0.0000, 1069310.5000, 1570248.8750],
        [      0.0000,       0.0000,  391043.7188,  609074.8125],
        [      0.0000,       0.0000,   65521.9375,  158616.7969],
        [      0.0000,       0.0000,  345652.9062,  586385.2500],
        [      0.0000,       0.0000,  341925.8438,  590051.0625]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[355.6480, 389.6000, 512.0000, 502.9973],
        [125.8080,  61.5573, 472.8080, 504.4800],
        [  2.9717, 172.8800, 511.8568, 341.7760],
        [190.5440, 177.3227, 512.0000, 231.2000],
        [285.3396, 284.1851, 486.6844, 457.9221],
        [143.5440,  42.0051, 334.2640, 510.3442],
        [ 41.3280, 108.0427, 159.2800, 504.0960],
        [125.0720, 219.4081, 278.9520, 388.7381]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 2042116.2500, 3268946.7500],
        [      0.0000,       0.0000,   62157.5469,  147802.4375],
        [      0.0000,       0.0000,  503962.9688,  817501.1250],
        [      0.0000,       0.0000,  230319.6719,  451108.7188],
        [      0.0000,       0.0000,  537423.6250, 1007246.1875],
        [      0.0000,       0.0000,  383606.3125,  725369.3750],
        [      0.0000,       0.0000,   53635.0508,  149970.7656],
        [      0.0000,       0.0000,  186020.1875,  375697.0000]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[198.9920, 125.9208, 301.9200, 435.1760],
        [160.0320, 185.6629, 260.0480, 505.0814],
        [119.8960,  95.3920, 340.6960, 375.5520],
        [ 35.8894,   4.9664, 512.0000, 243.3126],
        [  1.7280,   1.1520, 512.0000, 503.9467],
        [185.4149, 186.5011, 512.0000, 512.0000],
        [377.9760, 151.3817, 512.0000, 333.5794],
        [ 55.7680, 100.2297, 251.7440, 458.9774]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.0000, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000, 1205380.7500, 2127587.5000],
        [      0.0000,       0.0000,       0.0000,   43467.6406],
        [      0.0000,       0.0000,    7803.7954,  116374.9609],
        [      0.0000,       0.0000,  426281.2500,  972469.3125],
        [      0.0000,       0.0000,  571779.6875, 1295733.7500],
        [      0.0000,       0.0000,  263591.5312,  490708.3125],
        [      0.0000,       0.0000,  183359.3906,  521055.4062],
        [      0.0000,       0.0000,  897975.5000, 1596700.1250]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  1.7280, 135.7653, 125.1200, 361.2800],
        [ 71.2560, 171.9020, 405.0400, 439.1783],
        [ 31.7600, 186.1867, 186.5920, 421.9520],
        [250.6080, 161.7707, 469.7920, 512.0000],
        [238.4960, 163.7013, 347.8400, 512.0000],
        [226.2640, 175.9026, 324.9120, 488.0907],
        [  0.7280, 240.0362, 124.7360, 396.3894],
        [167.3281, 166.5920, 308.3835, 271.4240]], device='cuda:0')
loss1: tensor([1.0000, 1.9949, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.9949, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[      0.0000,       0.0000,   56899.6836,  184474.5938],
        [      0.0000,       0.0000,   62212.4180,  739241.0000],
        [      0.0000,       0.0000,  254644.5156,  691515.4375],
        [      0.0000,       0.0000,  648843.4375, 1580673.7500],
        [      0.0000,       0.0000,  329492.9375,  865271.2500],
        [      0.0000,       0.0000,       0.0000,   30144.8984],
        [      0.0000,       0.0000,   59663.7266,  433334.9688],
        [      0.0000,       0.0000,   18328.2305,  480579.2188]],
       device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[361.7760,  66.7840, 476.5840, 206.1333],
        [119.4800, 125.0743, 295.6480, 378.7721],
        [339.9920, 348.6933, 512.0000, 468.3520],
        [242.8480, 301.6004, 416.9440, 506.6282],
        [  0.0000,   0.0000, 101.6000, 401.7920],
        [ 58.8021, 218.5360, 420.4635, 465.3920],
        [340.7040, 197.7493, 508.0800, 423.8301],
        [200.7920,  82.0762, 306.8960, 262.7305]], device='cuda:0')
loss1: tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.9930, 1.0000, 1.0000],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(8.9929, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[     0.0000,      0.0000,      0.0000, 635364.3125],
        [     0.0000,      0.0000,      0.0000,      0.0000],
        [     0.0000,      0.0000,      0.0000,      0.0000],
        [     0.0000,      0.0000,      0.0000,  14855.2246],
        [     0.0000,      0.0000,      0.0000,      0.0000],
        [ 10584.3359,  19331.9004,  10584.3359,  19331.9004],
        [     0.0000,      0.0000,  13968.3984, 400496.6875],
        [     0.0000,      0.0000,      0.0000,  71214.1719]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[306.1360, 243.2420, 512.0000, 512.0000],
        [272.0000,  49.4742, 436.0000, 494.7416],
        [ 77.0880,  44.7890, 230.1547, 345.2800],
        [242.7760,   2.2956, 423.5120, 506.2430],
        [192.1840, 272.5465, 336.0000, 428.7225],
        [179.9600, 270.4960, 406.1760, 470.8587],
        [376.0690,  49.2591, 503.9017, 226.3341],
        [117.1760, 115.0613, 382.6000, 376.5653]], device='cuda:0')
loss1: tensor([1.9998, 1.6615, 1.4212, 1.9855, 1.8441, 1.9998, 1.0000, 1.9975],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.9093, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000, 12324.6680,     0.0000, 12324.6680],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[309.9040,  38.7413, 418.6240, 187.8827],
        [  2.3007,  12.6578, 512.0000, 234.7169],
        [115.9573, 200.4960, 254.7307, 307.2160],
        [114.7680,  72.5653, 446.9920, 499.4240],
        [  7.6800,  99.7554, 200.4480, 505.6653],
        [279.2720,   1.3333, 481.7440, 307.2000],
        [ 71.0160, 272.2397, 242.6400, 474.7052],
        [415.5650, 252.7540, 505.8593, 420.4424]], device='cuda:0')
loss1: tensor([1.7938, 1.0582, 1.8108, 1.3647, 1.2280, 1.9896, 1.6983, 1.9288],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.8723, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[    0.0000,     0.0000,     0.0000,     0.0000],
        [16923.3496, 20898.9961, 16923.3496, 20898.9961],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[115.9408, 117.4320, 303.9428, 487.9120],
        [131.1040, 207.6524, 268.4800, 512.0000],
        [176.4960, 156.1060, 352.0960, 318.0275],
        [257.1120, 250.6886, 323.3440, 465.8721],
        [  0.8640, 143.8187, 133.7520, 410.7520],
        [ 93.7280, 160.6025, 490.3200, 326.6248],
        [342.1120, 239.1292, 512.0000, 331.1813],
        [149.5120, 292.6080, 450.1040, 468.4373]], device='cuda:0')
loss1: tensor([1.5303, 1.9999, 1.7461, 1.9054, 1.3543, 1.5889, 1.9078, 1.7493],
       device='cuda:0', grad_fn=<RsubBackward1>)

  2%|▌                               | 45/2600 [00:11<08:14,  5.17it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [16217.5361,  7274.5293, 16217.5361,  7274.5293],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[ 11.2000,  76.3193, 190.8000, 448.9014],
        [197.3440, 185.4400, 338.7760, 374.0160],
        [ 92.2880, 380.5827, 210.5040, 495.5968],
        [ 36.3040, 330.2121, 461.2720, 467.1247],
        [ 33.4000, 111.4123, 174.0880, 486.5000],
        [142.4000,  61.0900, 346.5120, 332.4760],
        [  1.9280, 327.1499, 286.8800, 507.5667],
        [ 10.6595, 122.4482, 101.3469, 381.3228]], device='cuda:0')
loss1: tensor([1.2187, 1.7895, 1.8697, 1.9995, 1.3769, 1.5192, 1.6469, 1.3925],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.8130, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [    0.0000,     0.0000,     0.0000,     0.0000],
        [24468.3242, 14976.9854, 24468.3242, 14976.9854]], device='cuda:0',
       grad_fn=<CopySlices>)
boxB tensor([[281.7280, 113.9110, 410.6880, 456.7711],
        [  0.7680,  35.6725, 110.0320, 493.5895],
        [153.6000, 281.5317, 285.6243, 503.5895],
        [  0.6480, 359.7757, 318.6560, 502.4408],
        [111.6320, 166.6987, 429.7360, 395.3707],
        [121.7590,  70.0486, 217.4076, 337.9786],
        [252.5520,  66.7279, 433.7200, 477.4790],
        [192.9200,  51.8500, 289.7840, 294.6224]], device='cuda:0')
loss1: tensor([1.7643, 1.0787, 1.7962, 1.7166, 1.5719, 1.6512, 1.6407, 1.9999],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.2196, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[252.7280,  51.5846, 503.1600, 512.0000],
        [178.2827, 216.5040, 367.4453, 422.9520],
        [280.1920, 315.2577, 358.4880, 503.9423],
        [100.0550,   0.8192, 407.0195, 309.5620],
        [ 45.2400, 130.6870, 282.4080, 506.3854],
        [  0.0000, 102.0523, 283.1280, 506.8081],
        [161.3883, 297.4320, 493.7778, 402.1440],
        [ 72.1840, 149.6178, 196.0640, 283.4347]], device='cuda:0')
loss1: tensor([1.5524, 1.7487, 1.9182, 1.2478, 1.3769, 1.2014, 1.8247, 1.7017],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.5719, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 10.7440, 194.4401, 247.9440, 294.5379],
        [ 69.5440, 390.7028, 493.6800, 505.2373],
        [155.5360, 202.5038, 385.9440, 386.5956],
        [  9.7360, 115.2962, 293.0000, 504.9570],
        [  5.1801,   4.6000, 262.7425, 347.4720],
        [124.7334, 284.2351, 272.9165, 479.8600],
        [258.7680, 265.2267, 336.2560, 499.3200],
        [234.7110, 209.2100, 304.6093, 423.2124]], device='cuda:0')
loss1: tensor([1.6749, 1.8052, 1.7157, 1.2540, 1.0327, 1.7787, 1.8920, 1.8840],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.0371, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[198.0400,  48.2560, 405.6720, 512.0000],
        [265.7760, 176.0320, 474.6080, 512.0000],
        [396.1840, 135.5627, 512.0000, 390.2293],
        [  0.8294, 306.0395, 115.2819, 505.0914],
        [220.1840,  94.3447, 349.1680, 285.3420],
        [294.0080,  97.7956, 470.5600, 506.2445],
        [107.5200, 216.8478, 287.1600, 359.2250],
        [266.9333,  14.9600, 435.6800, 140.3680]], device='cuda:0')
loss1: tensor([1.5364, 1.7113, 1.8524, 1.6087, 1.7527, 1.6973, 1.7521, 1.6540],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.5648, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 67.1920, 196.5369, 194.4320, 375.0258],
        [222.6381,  41.4242, 464.2509, 506.2520],
        [ 22.4320, 132.3093, 113.0400, 445.2693],
        [264.5920, 140.9920, 488.8080, 454.8373],
        [ 42.7827, 110.8365, 273.6230, 391.5348],
        [119.3760,  31.8293, 266.6080, 507.4880],
        [336.0000,  94.3835, 453.9760, 215.9775],
        [ 72.7600, 314.6822, 436.5760, 507.5395]], device='cuda:0')
loss1: tensor([1.6885, 1.5221, 1.4366, 1.6835, 1.3952, 1.4824, 1.8537, 1.6833],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.7454, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  1.7226,  65.5840, 111.8265, 441.8160],
        [116.4720, 325.7680, 389.7680, 464.1440],
        [ 15.8240,  22.1448, 376.2560, 101.5414],
        [261.3040, 193.2951, 448.4960, 503.9405],
        [119.0800, 329.0560, 271.8240, 503.9467],
        [  0.0000, 170.0880, 144.5333, 363.8160],
        [192.1600,  90.8889, 299.0880, 451.0233],
        [  8.5440,  83.9271, 131.7600, 345.0111]], device='cuda:0')
loss1: tensor([1.1616, 1.7910, 1.2510, 1.7427, 1.8050, 1.4675, 1.7145, 1.2923],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.2256, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.8400,  25.9406, 255.2480, 445.6927],
        [239.8560, 122.8080, 403.6000, 431.8560],
        [229.3680,   2.4000, 512.0000, 498.3680],
        [ 70.1600,  65.5914, 162.3680, 441.2056],
        [ 55.1040,  76.9173, 440.8240, 478.7093],
        [355.9200, 394.4960, 512.0000, 506.8053],
        [ 36.9445,  71.1270, 285.2026, 418.1914],
        [  8.6323, 257.7203, 125.9827, 391.1953]], device='cuda:0')
loss1: tensor([1.0613, 1.7097, 1.4506, 1.5165, 1.2656, 1.9324, 1.2776, 1.6822],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.8959, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[381.5488, 289.2549, 472.7969, 495.4437],
        [ 84.3006, 222.0560, 290.7634, 478.6320],
        [130.6880, 196.6160, 282.9120, 505.6560],
        [142.1539, 314.3280, 437.0564, 437.5360],
        [233.4880,  89.7173, 310.3120, 285.1200],
        [298.8960, 301.0958, 512.0000, 498.9958],
        [142.6667, 120.0800, 281.0880, 464.8240],
        [ 25.2800, 375.9040, 321.2160, 471.4987]], device='cuda:0')
loss1: tensor([1.9197, 1.6194, 1.6712, 1.8100, 1.8303, 1.8349, 1.6348, 1.8132],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(14.1334, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[150.0080, 209.6429, 204.8960, 465.7152],
        [ 32.8960, 256.6355, 430.1600, 489.2418],
        [ 41.4080, 146.3696, 190.3120, 357.9803],
        [197.1920, 359.8557, 370.6080, 445.5906],
        [384.5120, 130.5707, 512.0000, 253.5467],
        [  0.6480,   1.1520, 459.7680, 443.1218],
        [  4.3307,   0.0000, 111.1787, 163.9520],
        [174.7440,  64.4267, 511.2800, 506.2542]], device='cuda:0')
loss1: tensor([1.8527, 1.5609, 1.5375, 1.9100, 1.8792, 1.0040, 1.0390, 1.4255],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.2088, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[198.2976, 101.6764, 286.9555, 449.6862],
        [189.9120,  50.1440, 256.6800, 450.7733],
        [222.5124, 318.5360, 512.0000, 500.6560],
        [ 62.3633,  11.2720, 251.1798, 480.5040],
        [179.4960, 116.2061, 333.4640, 433.7579],
        [202.8032,  63.9154, 373.9853, 200.0183],
        [ 13.0000, 182.6667, 228.0000, 474.6667],
        [297.0400, 304.8881, 495.4800, 488.0219]], device='cuda:0')
loss1: tensor([1.7609, 1.7688, 1.7943, 1.2659, 1.6620, 1.6885, 1.4199, 1.8497],

  2%|▋                               | 55/2600 [00:13<08:21,  5.07it/s]
loss  tensor(13.2101, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.7680, 131.1609, 229.7520, 469.4295],
        [  0.0000,  66.3450, 138.1308, 361.3082],
        [371.0560, 186.3893, 487.5520, 410.7520],
        [172.9049,  31.1398, 444.8245, 374.0057],
        [123.7280, 276.6843, 288.7840, 424.9192],
        [ 37.6640, 381.6294, 174.0000, 487.4875],
        [308.8747,  36.3440, 465.5467, 291.6480],
        [413.5920, 323.5627, 512.0000, 512.0000]], device='cuda:0')
loss1: tensor([1.2818, 1.1836, 1.8695, 1.4396, 1.8006, 1.8299, 1.7054, 1.9293],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.0397, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 87.4480, 199.3885, 152.2960, 446.8612],
        [ 21.6781,  10.3541, 361.2774, 249.6734],
        [313.1360, 114.2613, 395.5360, 292.2560],
        [ 40.5188, 297.2000, 182.3192, 392.6240],
        [218.4320, 347.4705, 484.4480, 505.0925],
        [343.6240,   3.5520, 512.0000, 433.0773],
        [211.7760, 119.3271, 509.3520, 507.6696],
        [164.7760, 265.7364, 512.0000, 460.8000]], device='cuda:0')
loss1: tensor([1.7642, 1.0990, 1.8731, 1.8110, 1.8286, 1.6738, 1.5531, 1.7129],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.3158, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[101.2531,   5.7549, 512.0000, 498.1965],
        [135.1840, 154.9789, 351.8160, 435.7086],
        [302.4480,  26.4633, 413.7600, 294.5379],
        [381.2480,  85.0136, 512.0000, 193.1091],
        [370.9440,   5.4889, 512.0000, 311.7621],
        [ 56.0230, 109.1075, 187.8221, 442.7799],
        [174.3155,  80.3517, 296.6528, 243.3768],
        [ 32.9280, 171.4304, 446.7120, 402.8032]], device='cuda:0')
loss1: tensor([1.2070, 1.6033, 1.7551, 1.8571, 1.7294, 1.4712, 1.7238, 1.4679],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.8147, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[111.0880, 230.5387, 232.2160, 466.4854],
        [283.3258, 390.5600, 452.3434, 496.0080],
        [143.0613, 323.2560, 284.6187, 428.9680],
        [ 45.2250, 220.1840, 282.0717, 325.6960],
        [387.3067, 259.9040, 469.6427, 452.5360],
        [174.0320, 157.1877, 365.8400, 395.6602],
        [260.4466, 196.6240, 445.4293, 375.7120],
        [213.1558,  82.8263, 330.7315, 228.4344]], device='cuda:0')
loss1: tensor([1.7362, 1.9206, 1.8774, 1.7280, 1.9254, 1.6840, 1.8020, 1.7734],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(14.4470, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[135.1782, 213.5245, 263.4650, 378.8391],
        [  0.0000, 267.2112, 139.1200, 463.4835],
        [  8.6079,  24.0960, 218.1829, 349.0800],
        [178.8235, 110.6480, 509.5812, 504.9360],
        [213.6080,  30.0080, 383.1760, 251.3200],
        [ 85.6131, 238.7120, 195.8070, 377.7040],
        [196.0240, 291.5395, 308.7520, 410.0206],
        [182.8720, 200.7153, 382.8240, 420.8754]], device='cuda:0')
loss1: tensor([1.7875, 1.5765, 1.1058, 1.4932, 1.6103, 1.7929, 1.8945, 1.7268],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.9875, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[121.0160, 131.8400, 409.1440, 512.0000],
        [ 96.9440, 209.8667, 202.2400, 417.3227],
        [322.5600, 231.4036, 491.5200, 385.6582],
        [168.6800, 241.7858, 355.6880, 329.9862],
        [246.7680, 184.8427, 449.2560, 337.2053],
        [141.5440,  33.3643, 301.4320, 384.2845],
        [ 43.1440,  71.3387, 443.5440, 467.1253],
        [ 75.2320, 240.5333, 253.3120, 512.0000]], device='cuda:0')
loss1: tensor([1.4771, 1.7412, 1.8625, 1.8595, 1.7963, 1.5156, 1.2351, 1.6273],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.1146, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[124.8419, 177.2160, 370.1592, 479.3280],
        [  0.7680, 258.8777, 512.0000, 506.2445],
        [179.6608,  37.1780, 307.5994, 340.1319],
        [263.5484, 340.5840, 384.3708, 466.0480],
        [100.9600, 317.3653, 211.4160, 479.5947],
        [203.1920,  92.1360, 312.8880, 375.7265],
        [ 47.4880,   0.6835, 507.8080, 512.0000],
        [342.1013,  27.6160, 500.1067, 157.6240]], device='cuda:0')
loss1: tensor([1.5823, 1.5121, 1.6295, 1.9154, 1.8233, 1.7354, 1.0947, 1.7394],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.0321, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[106.6160, 300.2027, 266.9760, 503.6160],
        [ 40.6400, 262.0240, 256.2400, 382.0640],
        [  0.0000, 196.2720, 510.1732, 489.6000],
        [  0.7600,  75.9426, 355.9680, 456.7789],
        [ 99.5868, 324.9102, 255.1842, 468.1583],
        [ 16.4000, 237.9530, 215.6000, 484.5953],
        [306.7093, 127.2160, 430.9973, 262.5120],
        [ 37.1840,   0.8643, 395.5280, 418.0896]], device='cuda:0')
loss1: tensor([1.7574, 1.7356, 1.4009, 1.1680, 1.8134, 1.5297, 1.8514, 1.0959],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.3524, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[308.5107, 107.1377, 426.3117, 445.3854],
        [159.8560,  21.8611, 475.4720, 495.8877],
        [258.3440,  84.7551, 492.7760, 504.4995],
        [348.9520, 252.9184, 472.3120, 511.1727],
        [252.1680, 233.3497, 417.2240, 465.6082],
        [ 67.8800, 215.1520, 165.6800, 444.1200],
        [ 86.2620,  31.1383, 214.3289, 176.9328],
        [371.1200, 118.8392, 512.0000, 257.8945]], device='cuda:0')
loss1: tensor([1.7901, 1.3655, 1.6042, 1.8680, 1.8027, 1.6957, 1.5076, 1.8516],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.4854, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[270.1465, 281.7120, 499.7143, 380.6800],
        [235.6880,  98.2729, 512.0000, 503.5065],
        [320.2560, 292.4740, 417.0480, 436.0374],
        [ 71.7840,   5.1840, 192.0000, 373.0453],
        [306.5360, 102.0506, 416.0640, 512.0000],
        [  1.6160, 232.5125, 461.0960, 351.7762],
        [381.9520, 138.1653, 459.7040, 391.4133],
        [332.0000,   0.0000, 453.3760, 335.8672]], device='cuda:0')
loss1: tensor([1.8806, 1.5657, 1.9236, 1.3826, 1.7892, 1.6622, 1.8906, 1.7323],
       device='cuda:0', grad_fn=<RsubBackward1>)

  3%|▊                               | 66/2600 [00:16<08:17,  5.10it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[105.4576,  14.8400, 511.9041, 453.9600],
        [ 80.6000, 146.1178, 178.8640, 505.0934],
        [287.3760, 214.9865, 361.5120, 396.9938],
        [ 39.8131,  51.7135, 227.3280, 447.7357],
        [ 98.6688, 242.0037, 263.9979, 376.6630],
        [  2.4781, 302.9128, 169.2877, 468.0772],
        [379.0320,  56.1934, 426.8560, 347.2735],
        [311.3600, 236.7390, 375.8640, 453.2335]], device='cuda:0')
loss1: tensor([1.2320, 1.6096, 1.9060, 1.2704, 1.7761, 1.6523, 1.9061, 1.9180],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.2704, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.0000,  16.7149, 512.0000, 505.6570],
        [ 38.3573, 107.0000, 289.9413, 501.6480],
        [138.0352,  63.0170, 295.5674, 364.5850],
        [  0.8640,   2.5920, 284.7680, 276.4267],
        [292.4160, 276.9680, 512.0000, 376.2720],
        [  0.8240, 353.6533, 371.5840, 507.0293],
        [  0.0000,   3.4400, 481.0080, 512.0000],
        [115.6320, 154.1760, 297.7040, 503.9467]], device='cuda:0')
loss1: tensor([1.0331, 1.3174, 1.5591, 1.0124, 1.8868, 1.6982, 1.0067, 1.5755],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.0892, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[145.0800, 172.7360, 448.2400, 382.2613],
        [211.4960, 225.7184, 394.3600, 505.3896],
        [ 74.8720, 263.2403, 402.9760, 361.9780],
        [189.7840, 145.4224, 298.0960, 356.1218],
        [100.2640,  58.5143, 249.3200, 485.4048],
        [110.5680, 332.4988, 355.0560, 473.8470],
        [ 16.5523,  57.4976, 249.8420, 166.2669],
        [110.2720, 225.0882, 441.8400, 504.7816]], device='cuda:0')
loss1: tensor([1.6293, 1.7434, 1.7779, 1.7850, 1.4742, 1.7946, 1.3892, 1.5842],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.1778, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  1.1520, 199.0480, 128.8640, 330.2080],
        [198.0240, 169.8987, 447.7120, 305.3653],
        [  2.6720, 122.6522, 427.2240, 500.9686],
        [137.6640,  36.7520, 414.3467, 240.3680],
        [ 77.8240, 120.8043, 380.4800, 457.9260],
        [  0.0000,  81.3333, 230.4000, 503.5947],
        [217.4613,  71.1396, 404.7147, 507.2071],
        [142.3440, 279.5834, 426.0960, 354.3789]], device='cuda:0')
loss1: tensor([1.6063, 1.7526, 1.2496, 1.4343, 1.4144, 1.1615, 1.6022, 1.8594],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.0804, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[107.9028, 225.7600, 239.7906, 465.1520],
        [ 80.0800, 159.9677, 232.8960, 359.9381],
        [ 29.7040, 201.3707, 210.5600, 337.2725],
        [323.9200, 104.3454, 480.4800, 424.2081],
        [164.2480, 215.8434, 266.8000, 465.4763],
        [  2.2480, 114.0909,  98.7120, 405.8949],
        [237.3013, 344.8400, 381.0880, 482.8880],
        [139.8187,   0.9840, 512.0000, 437.0480]], device='cuda:0')
loss1: tensor([1.7169, 1.6355, 1.6539, 1.7543, 1.7939, 1.2975, 1.8921, 1.2747],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.0188, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 229.3976, 118.6816, 512.0000],
        [  0.0000,   5.1840, 108.9760, 158.5600],
        [  0.7680, 239.3121, 129.2640, 462.5226],
        [ 27.9040, 260.9067, 161.1440, 363.8613],
        [378.2160, 288.4800, 512.0000, 509.9520],
        [ 70.4640, 254.8489, 376.8320, 437.3823],
        [  2.0220, 128.4000, 512.0000, 260.9200],
        [143.8880, 121.9589, 225.4480, 414.2056]], device='cuda:0')
loss1: tensor([1.4480, 1.0327, 1.5203, 1.7660, 1.8865, 1.6607, 1.4941, 1.7448],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.5531, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[209.6320, 297.1998, 331.2640, 511.6762],
        [ 66.9557,   1.3600, 427.4780, 350.7120],
        [  0.0000,   0.0000, 160.0000, 386.8800],
        [ 51.1120, 177.1627, 322.8560, 493.4827],
        [ 10.2880, 295.0894, 210.8400, 391.9857],
        [255.4240,  52.9280, 512.0000, 308.3520],
        [  1.5360,  96.2880, 115.3173, 498.7360],
        [242.9600,   2.3360, 342.5440, 407.3813]], device='cuda:0')
loss1: tensor([1.8461, 1.1599, 1.0000, 1.4605, 1.7649, 1.5849, 1.2038, 1.7109],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(11.7310, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[129.0560, 118.0160, 190.6560, 350.6027],
        [203.4240, 191.1547, 332.3040, 324.6703],
        [ 19.6769, 103.3705, 205.9545, 504.4204],
        [355.0880, 180.7040, 512.0000, 378.2827],
        [ 23.2378, 121.7440, 274.2378, 386.8000],
        [231.2000, 145.7694, 472.0000, 489.1106],
        [214.5360, 212.3662, 278.2480, 434.2756],
        [ 46.8354,  39.7840, 225.1721, 150.3520]], device='cuda:0')
loss1: tensor([1.7857, 1.8405, 1.2809, 1.8399, 1.3728, 1.6419, 1.8830, 1.4176],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.0622, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[147.1795, 385.2488, 341.1558, 507.2078],
        [ 52.1760, 133.0462, 124.3120, 372.7862],
        [ 63.8255, 368.4320, 408.4363, 417.8560],
        [ 34.5440, 179.4878, 155.0640, 421.1110],
        [318.9453,  10.8407, 429.1789, 155.4022],
        [229.6560,  88.5893, 421.2880, 423.4107],
        [307.7040, 295.9382, 439.5120, 445.7770],
        [314.1440, 109.6663, 424.6480, 398.7845]], device='cuda:0')
loss1: tensor([1.8633, 1.6268, 1.9002, 1.5540, 1.7611, 1.6403, 1.8992, 1.8113],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(14.0563, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[117.8960,  96.1409, 463.0080, 408.1132],
        [ 91.2960, 238.3680, 437.7600, 462.5840],
        [ 70.3139, 311.6080, 238.4632, 428.3200],
        [297.3120,  79.5949, 494.7520, 507.7956],
        [271.1520, 281.3440, 398.8960, 453.6000],
        [283.5280, 223.5200, 381.5200, 426.1120],
        [285.2160, 111.7778, 375.5520, 338.6438],
        [275.3049,  74.7520, 400.9068, 254.9840]], device='cuda:0')
loss1: tensor([1.4302, 1.6164, 1.8079, 1.6635, 1.8784, 1.8779, 1.8389, 1.7786],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.8916, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.0000, 156.4800, 255.2206, 505.0960],
        [ 53.6343, 181.0432, 186.2383, 456.6528],
        [427.3941,  93.1520, 512.0000, 270.5760],
        [199.2400, 253.7956, 283.0320, 435.8685],
        [273.9280, 132.6524, 425.3760, 238.0620],
        [121.9920,  61.1882, 440.0800, 460.6681],
        [151.5680, 139.5350, 432.3840, 311.3488],
        [269.0640,  61.9200, 512.0000, 384.6720]], device='cuda:0')
loss1: tensor([1.3098, 1.5703, 1.8916, 1.8763, 1.8424, 1.3732, 1.6416, 1.6019],
       device='cuda:0', grad_fn=<RsubBackward1>)

  3%|▉                               | 76/2600 [00:17<08:08,  5.16it/s]
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[2.3066e+02, 2.4592e+02, 3.5846e+02, 4.0122e+02],
        [3.2547e+02, 1.1620e+02, 4.0088e+02, 3.7393e+02],
        [2.5502e+02, 1.3432e+02, 4.0582e+02, 5.0966e+02],
        [1.3867e-01, 1.6768e+02, 1.0070e+02, 5.0003e+02],
        [1.2415e+02, 1.9249e+02, 1.9510e+02, 3.8359e+02],
        [0.0000e+00, 3.5786e+01, 5.0186e+02, 5.1111e+02],
        [1.9705e+02, 2.2357e+02, 2.9614e+02, 4.5342e+02],
        [1.4246e+02, 3.2561e+02, 5.1200e+02, 5.0510e+02]], device='cuda:0')
loss1: tensor([1.8620, 1.8704, 1.7263, 1.3363, 1.8188, 1.0700, 1.8304, 1.7435],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.2577, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 65.9644,  82.8400, 251.5911, 431.4667],
        [ 24.6000, 106.7424, 110.5200, 269.3592],
        [ 74.6320, 346.3177, 250.0640, 422.2564],
        [215.4073, 217.4566, 384.3788, 439.5110],
        [320.2640, 130.1134, 427.3120, 259.0067],
        [165.1360,  19.8174, 333.4160, 494.9896],
        [  0.0000,   0.0000, 512.0000, 505.9733],
        [ 94.8720, 244.5547, 266.5440, 434.9013]], device='cuda:0')
loss1: tensor([1.4038, 1.5307, 1.8738, 1.7779, 1.8753, 1.5155, 1.0000, 1.7181],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.6952, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.0000,  39.5691, 152.1440, 254.4652],
        [ 81.6240, 112.0321, 250.6400, 326.4760],
        [316.5552, 123.1120, 416.4070, 308.5840],
        [ 15.1962,  51.2205, 242.5242, 450.7751],
        [  2.4883, 389.0658, 216.7910, 505.5391],
        [355.5328, 252.1907, 512.0000, 366.0902],
        [  0.0000,   3.5440, 321.5703, 323.1200],
        [ 46.0682, 279.2695, 150.4574, 464.6047]], device='cuda:0')
loss1: tensor([1.1555, 1.5571, 1.8559, 1.1692, 1.7723, 1.9049, 1.0110, 1.7232],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.1490, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[274.6000, 310.6502, 498.9120, 510.9495],
        [112.9920,   3.4459, 465.5120, 512.0000],
        [195.7888, 138.8640, 467.7993, 502.4400],
        [386.5920,  27.6160, 512.0000, 180.6400],
        [ 62.3440, 117.6960, 244.8560, 512.0000],
        [201.0624,  11.3186, 473.7433, 495.6979],
        [261.5280, 357.8484, 453.2640, 506.4963],
        [277.1120, 142.1422, 368.7840, 429.6348]], device='cuda:0')
loss1: tensor([1.8237, 1.2478, 1.5792, 1.7925, 1.4260, 1.4376, 1.8759, 1.8337],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(13.0163, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  0.7680,  68.8449, 192.3600, 504.9062],
        [297.7040,  21.8560, 512.0000, 510.8480],
        [185.4960, 144.1813, 403.9360, 455.0827],
        [ 93.4320, 397.3292, 222.3200, 506.1292],
        [ 18.4107, 243.9200, 196.3627, 363.5760],
        [ 75.0880, 171.5462, 370.1760, 493.4630],
        [ 22.3120,  64.5024, 376.2560, 505.1693],
        [120.8064, 117.0091, 509.6960, 418.4491]], device='cuda:0')
loss1: tensor([1.1398, 1.5994, 1.6306, 1.8754, 1.7017, 1.4800, 1.1794, 1.4504],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.0566, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 21.3586,  27.1147, 182.5931, 236.3462],
        [152.7840, 115.0293, 227.0800, 343.5093],
        [  0.0000, 230.1120, 507.1215, 501.6480],
        [ 31.3520,  17.4400, 173.9920, 511.9253],
        [265.5232, 136.0964, 348.4058, 338.3518],
        [300.6827, 201.3520, 417.2693, 419.9520],
        [178.4640, 147.4294, 307.0160, 512.0000],
        [ 85.6960, 321.2747, 243.9840, 510.8315]], device='cuda:0')
loss1: tensor([1.2183, 1.7824, 1.4587, 1.2081, 1.8578, 1.8546, 1.7019, 1.7593],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.8410, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[  5.4694,  57.8000, 244.2421, 239.3600],
        [363.0560,  19.6026, 457.4720, 264.0766],
        [ 64.4461, 269.6240, 235.1906, 390.6560],
        [  0.0000,   0.0000, 512.0000, 512.0000],
        [342.2187,  31.5120, 510.6667, 168.4880],
        [172.8330, 106.6640, 319.7542, 404.1840],
        [219.5733, 319.1600, 386.9333, 405.7280],
        [192.4320, 272.6827, 509.9840, 503.9467]], device='cuda:0')
loss1: tensor([1.2585, 1.8089, 1.7751, 1.0000, 1.7318, 1.6618, 1.9077, 1.7143],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.8581, device='cuda:0', grad_fn=<SumBackward0>)
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[333.1680, 180.6355, 403.9520, 510.8516],
        [387.7840, 206.0240, 494.4400, 403.6640],
        [ 52.7280, 355.6373, 459.6080, 505.5253],
        [152.3520,  36.4267, 327.8720, 241.9413],
        [262.0160,   3.5520, 512.0000, 326.5493],
        [  4.1946, 116.2160, 236.3132, 427.2000],
        [ 75.9501, 259.4595, 240.5479, 347.1145],
        [202.7840, 284.4800, 461.6640, 408.7360]], device='cuda:0')
loss1: tensor([1.8867, 1.8944, 1.7375, 1.5453, 1.5171, 1.2850, 1.8272, 1.8295],
       device='cuda:0', grad_fn=<RsubBackward1>)
  3%|▉                               | 76/2600 [00:18<10:02,  4.19it/s]
Traceback (most recent call last):
  File "distil_model.py", line 570, in <module>
    train_loss += loss.item()*images.size(0)
KeyboardInterrupt
similarity shape  torch.Size([8, 1, 16, 16])
bert emb shape  torch.Size([8, 768])
nn tensor shape torch.Size([8, 1024])
bert tensor shape torch.Size([8, 4])
boxA tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]], device='cuda:0', grad_fn=<CopySlices>)
boxB tensor([[ 38.5520, 321.7404, 136.9840, 512.0000],
        [288.2160,   9.2053, 512.0000, 135.7653],
        [131.9360,  13.4560, 441.8133, 480.5840],
        [  0.0000, 393.3440, 221.6000, 512.0000],
        [245.0720, 292.0533, 386.5920, 435.8720],
        [  9.3121,  11.5098, 247.6158, 471.7261],
        [220.0400, 167.7849, 278.5120, 504.5059],
        [175.1760, 176.8320, 512.0000, 478.2827]], device='cuda:0')
loss1: tensor([1.7330, 1.5926, 1.3183, 1.7682, 1.8792, 1.0611, 1.8599, 1.5854],
       device='cuda:0', grad_fn=<RsubBackward1>)
loss  tensor(12.7976, device='cuda:0', grad_fn=<SumBackward0>)